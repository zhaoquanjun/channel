"use strict";var channelApp=angular.module("channelApp",["ngAnimate","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ui.bootstrap","ui.router","treeControl","angularFileUpload","ngLocale","formly","formlyBootstrap","fixed.table.header","angular-echarts","ngMaterial"]);channelApp.config(["$stateProvider","$urlRouterProvider","$httpProvider","userProvider",function(a,b,c,d){function e(a){return a.indexOf("api/orders/companyname?name=")>=0}function f(a){return a.indexOf("api/promotion/count")>=0}a.state("login",{url:"/login",templateUrl:"views/login.html",controller:"LoginCtrl"}).state("main",{url:"/main",templateUrl:"views/main.html",controller:"MainCtrl"}).state("main.noticelists",{url:"/noticelists",templateUrl:"views/noticelists.html",controller:"NoticeList"}).state("main.doclist",{url:"/doclist",templateUrl:"views/doclist.html",controller:"Doclist"}).state("main.noticeDetail",{url:"/noticeDetail/:id",templateUrl:"views/noticeDetail.html",controller:"NoticeDetail"}).state("main.employee",{url:"/employee",templateUrl:"views/employee.html",controller:"EmployeeCtrl"}).state("main.finance",{url:"/finance",templateUrl:"views/finance.html",controller:"FinanceCtrl"}).state("main.addOrder",{url:"/addOrder2/:orderId/:isView",templateUrl:"views/addOrder2.html",controller:""}).state("main.balance",{url:"/balance",templateUrl:"views/balance.html",controller:"BalanceCtrl"}).state("main.orderList",{url:"/orderList",templateUrl:"views/orderList.html",controller:"OrderListCtrl"}).state("main.orderSearch",{url:"/orderSearch",templateUrl:"views/orderSearch.html",controller:"OrderSearchCtrl"}).state("main.users",{url:"/user",templateUrl:"views/users.html",controller:"UserCtrl"}).state("main.users.usersList",{url:"/userList",templateUrl:"views/usersList.html",controller:"UserListCtrl"}).state("main.users.addUser",{url:"/addUser?deparment",templateUrl:"views/addUser.html",controller:"AddUserCtrl"}).state("main.users.updateUser",{url:"/updateUser?user",templateUrl:"views/updateUser.html",controller:"UpdateUserCtrl"}).state("main.achieve",{url:"/achieve",templateUrl:"views/achieve.html",controller:"AchieveCtrl"}).state("main.recharge",{url:"/recharge",templateUrl:"views/recharge.html",controller:"RechargeCtrl"}).state("main.review",{url:"/review",templateUrl:"views/review.html",controller:"ReviewCtrl"}).state("main.agent",{url:"/agent/:type",templateUrl:"views/agentList.html",controller:"AgentListCtrl"}).state("main.agentAuth",{url:"/agentAuth/:type",templateUrl:"views/agentList.html",controller:"AgentListCtrl"}).state("main.agapply",{url:"/agapply",templateUrl:"views/agent.html",controller:"agentCtrl"}).state("main.invoice",{url:"/invoice",templateUrl:"views/invoice.html",controller:"InvoiceCtrl"}).state("main.invoiceReview",{url:"/invoiceReview",templateUrl:"views/invoiceReview.html",controller:"InvoiceReviewCtrl"}).state("main.invoiceSearch",{url:"/invoiceSearch",templateUrl:"views/invoiceSearch.html",controller:"InvoiceSearchCtrl"}).state("main.address",{url:"/address",templateUrl:"views/addressList.html",controller:"AddressListCtrl"}).state("main.customers",{url:"/customers",templateUrl:"views/customers.html",controller:"CustomerList"}).state("main.pubcus",{url:"/pubcus",templateUrl:"views/customer_pub.html",controller:"CustomerPubList"}).state("main.custotal",{url:"/custotal",templateUrl:"views/customer_total.html",controller:"CustomerTotal"}).state("main.gift",{url:"/custsetting",templateUrl:"views/customer_setting.html",controller:"CustomerSetting"}).state("main.custotaltoc",{url:"/custotaltoc",templateUrl:"views/customer_totaltoc.html",controller:"CustomerTotalToC"}).state("main.signed",{url:"/signed",templateUrl:"views/customer_signed.html",controller:"CustomerSigned"}).state("main.cusReview",{url:"/cusReview",templateUrl:"views/review.html",controller:"ReviewCusCtrl"}).state("main.tobReview",{url:"/tobReview",templateUrl:"views/review.html",controller:"ReviewTobCtrl"}).state("main.orderstob",{url:"/orderstob",templateUrl:"views/orderList.html",controller:"OrdersTob"}).state("main.dateremind",{url:"/dateremind",templateUrl:"views/dateremind.html",controller:"DateRemind"}).state("main.conchange",{url:"/conchange",templateUrl:"views/conchange.html",controller:"ConChange"}).state("main.newcus",{url:"/newcus",templateUrl:"views/newcus.html",controller:"NewCustomer"}).state("main.statis_paytype",{url:"/statis_paytype",templateUrl:"views/statis_paytype.html",controller:"StatisPaytype"}).state("main.fd_settings",{url:"/fd_settings",templateUrl:"views/fd_settings.html",controller:"FD_settings"}).state("main.fd_list",{url:"/fd_list",templateUrl:"views/fd_aglist.html",controller:"FD_AgentList"}).state("main.users_fq",{url:"/users_fq",templateUrl:"views/users_fq.html",controller:"Users_fq"}).state("main.order_outworker",{url:"/orders/outworker",templateUrl:"views/order_outworker.html",controller:"Order_outworker"}).state("main.outwork_dict",{url:"/user/outwork_dict",templateUrl:"views/outwork_dict.html",controller:"Outwork_dict"}).state("main.statis_proportion_c",{url:"/statis_proportion_c",templateUrl:"views/statis_proportion_c.html",controller:"StatisProportionC"}).state("main.go_task_config",{url:"/orders/go_task_config",templateUrl:"views/go_task_config.html",controller:"Gotaskconfig"}).state("main.recharge_apply",{url:"/orders/recharge_apply",templateUrl:"views/recharge_apply.html",controller:"RechargeApply"}).state("main.operateAccount",{url:"/operateAccount",templateUrl:"views/operateAccount.html",controller:"OperateAccount"}).state("main.waitSetAccount",{url:"/waitSetAccount",templateUrl:"views/waitSetAccount.html",controller:"WaitSetAccount"}).state("main.receipt",{url:"/receipt",templateUrl:"views/receipt.html",controller:"Receipt"}).state("main.makeAccount",{url:"/makeAccount",templateUrl:"views/makeAccount.html",controller:"MakeAccount"}).state("main.statis_orders",{url:"/statis_orders",templateUrl:"views/statisOrders.html",controller:"StatisOrders"}).state("main.statis_achieve",{url:"/statis_achieve",templateUrl:"views/statisAchieve.html",controller:"StatisAchieve"}).state("main.statis_newCustomers",{url:"/statis_newCustomers",templateUrl:"views/statisNewCustomers.html",controller:"StatisNewCustomers"}).state("main.statis_renew",{url:"/statis_renew",templateUrl:"views/statisRenew.html",controller:"StatisRenew"}).state("main.statis_ytOdersTozsOders",{url:"/statis_ytOdersTozsOders",templateUrl:"views/statisYtOdersTozsOders.html",controller:"StatisYtOdersTozsOders"}).state("main.statis_ZeroTonoZero",{url:"/statis_ZeroTonoZero",templateUrl:"views/statisZeroTonoZero.html",controller:"StatisZeroTonoZero"}).state("main.statis_companyType1To2",{url:"/statis_companyType",templateUrl:"views/statisCompanyType.html",controller:"StatisCompanyType"}).state("main.statis_outwork",{url:"/statis_outwork",templateUrl:"views/statisOutwork.html",controller:"StatisOutworks"}),b.when("/main/user","/login").otherwise("/login"),c.defaults.transformResponse.push(function(a,b,c){return angular.isString(a)?a:401==c?void(location.href="#login"):a}),c.interceptors.push(["$q","$rootScope",function(a,b){var c=0;return{request:function(a){return e(a.url)?a:(c++,b.isLoading=!0,a)},response:function(a){return e(a.config.url)?a:(c--,0===c&&(b.isLoading=!1),angular.isObject(a.data)&&!a.data.status&&(f(a.config.url)||alert(a.data.message)),a)},responseError:function(d){return c--,c<=0&&(b.isLoading=!1),c=0,a.reject(d)}}}])}]).run(["$rootScope","$state","$locale",function(a,b,c){a.$on("$stateChangeStart",function(a,c){"main.users"===c.name&&(a.preventDefault(),b.go("main.users.usersList"))})}]).factory("showDetails",["$uibModal",function(a){return function(b,c){return c=c||"消息",a.open({templateUrl:"views/details.html",controller:["$scope","$sce","$uibModalInstance",function(a,d,e){a.message=d.trustAsHtml(b),a.title=c,a.cancel=function(){e.dismiss("cancel")}}],backdrop:!1,windowClass:"toast-modal"}).result}}]),Date.prototype.toISOString=function(){var a=this.getMonth()+1;return a=a<10?"0"+a:a,[this.getFullYear(),a,this.getDate()].join("-")},Date.prototype.toString=function(){var a=this.getMonth()+1;return a=a<10?"0"+a:a,[this.getFullYear(),a,this.getDate()].join("-")},angular.module("channelApp").provider("user",function(){var a={get:function(){var a=sessionStorage.getItem("user");return a||(location.href="#/login"),JSON.parse(a)},set:function(){sessionStorage.setItem("user",JSON.stringify(obj))}};this.$get=[function(){return sessionStorage.getItem("user")||(location.href="#/login"),a}],this.set=function(a){sessionStorage.setItem("user",JSON.stringify(a))}}),angular.module("channelApp").factory("UpdatePswdService",["$http","$q",function(a,b){function c(c){var d=b.defer();return a({url:"/api/account/pwd/reset",method:"PUT",data:c}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}return{update:c}}]),angular.module("channelApp").factory("promisesHandle",["$http",function(a){return function(a,b){$.when(a).done(function(a){console.log(a),b&&b(a)})}}]),angular.module("ngLocale",[],["$provide",function(a){var b={ZERO:"zero",ONE:"one",TWO:"two",FEW:"few",MANY:"many",OTHER:"other"};a.value("$locale",{DATETIME_FORMATS:{AMPMS:["上午","下午"],DAY:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ERANAMES:["公元前","公元"],ERAS:["公元前","公元"],FIRSTDAYOFWEEK:6,MONTH:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],SHORTDAY:["周日","周一","周二","周三","周四","周五","周六"],SHORTMONTH:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],STANDALONEMONTH:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],WEEKENDRANGE:[5,6],fullDate:"y年M月d日EEEE",longDate:"y年M月d日",medium:"y年M月d日 ah:mm:ss",mediumDate:"y年M月d日",mediumTime:"ah:mm:ss",short:"y/M/d ah:mm",shortDate:"y/M/d",shortTime:"ah:mm"},NUMBER_FORMATS:{CURRENCY_SYM:"¥",DECIMAL_SEP:".",GROUP_SEP:",",PATTERNS:[{gSize:3,lgSize:3,maxFrac:3,minFrac:0,minInt:1,negPre:"-",negSuf:"",posPre:"",posSuf:""},{gSize:3,lgSize:3,maxFrac:2,minFrac:2,minInt:1,negPre:"-¤",negSuf:"",posPre:"¤",posSuf:""}]},id:"zh-cn",localeID:"zh_CN",pluralCat:function(a,c){return b.OTHER}})}]),angular.module("channelApp").controller("MainCtrl",["$scope","$http","$state","$stateParams","$uibModal","user","$timeout",function(a,b,c,d,e,f,g){function h(a,b){return a.Rank>b.Rank}function i(){function b(a,c){var d=[];return $.each(a,function(a,e){if(!e)return!0;if(e.url===c){if(!e.hash)return d.push(e),!1;if(e.hash==location.hash)return d.push(e),!1}else if(e.children){var f=b(e.children,c);if(f&&f.length)return d.push(e),d=d.concat(f),!1}}),d}var d=c.current.name,e=b(a.navTreeModel,d);0!==e.length&&(a.selectedNavTree=e.pop(),a.expandedNodes=e)}function j(){b.get("/api/agent/alert").success(function(b){+b.data<1e3?a.showBalanceWarning=!0:a.showBalanceWarning=!1}),g(j,3e5)}function k(){var c=angular.extend({offset:0,limit:4,title:"",type:1},c);b.get("/api/notice/getnoticelist?"+jQuery.param(c)).success(function(b){a.noticelists=b.data,console.log(a.noticelists)})}function l(){var c=angular.extend({offset:0,limit:8,filename:"",type:0},c);b.get("/api/doc/getdoclist?"+jQuery.param(c)).success(function(b){a.doclists=b.data,console.log(a.doclists)})}a.user=f.get(),a.noticelists=[],a.doclists=[],a.curHeight=document.body.clientHeight-60+"px",a.rightcurHeight=(document.body.clientHeight-60)/2-10+"px",console.log(a.curHeight,a.rightcurHeight);var m=angular.fromJson(a.user.FunctionList);m=_.sortBy(m,"Rank"),m.forEach(function(a){a.children=a.children.sort(h)}),a.navTreeModel=m,a.navTreeOptions={nodeChildren:"children",dirSelectable:!1},a.routerChange=function(b){if(a.selectedNavTree=b,b.url){var d=b.params||{};c.go(b.url.trim(),d,{inherit:!1})}},a.updatePswd=function(){e.open({templateUrl:"views/updatePswd.html",controller:"UpdatePswdCtrl"}).result.then(function(a){},function(){console.info("Modal dismissed at: "+new Date)})},a.logout=function(){b.delete("/api/security/logout").then(function(){sessionStorage.clear(),location.href="#/login"})},i(),0==a.user.IsCenter&&j(),a.goMainHtml=function(){console.log(c,"$state"),c.go("main")},k(),l(),a.goMoreNotice=function(){c.go("main.noticelists")},a.noticeDetail=function(a){console.log(a,"id"),c.go("main.noticeDetail",{id:a})},a.download=function(a){var b="api/doc/downloadfile?id="+a;window.open(b)},a.goMorefile=function(){c.go("main.doclist")}}]),angular.module("channelApp").controller("LoginCtrl",["$scope","$location","$http",function(a,b,c){a.login=function(){var b=a.userName,d=a.password;if(!b||!d)return void alert("请输入用户名和密码!");c.post("/api/security/login",{UserName:b,PassWord:d}).success(function(a){if(!1!==a.status){if(a.data.IsCenter)return sessionStorage.setItem("userInfo",JSON.stringify(a.data)),void(location.href="/admin.html");sessionStorage.setItem("user",JSON.stringify(a.data)),location.href="#/main"}}).error(function(){})}}]),angular.module("channelApp").controller("EmployeeCtrl",function(){}),angular.module("channelApp").controller("FinanceCtrl",["$scope","FinanceService","$uibModal","user",function(a,b,c,d){a.user=d.get(),function(){b.getAgent().then(function(b){a.agentModel=[{ChannelId:"",ChannelName:"全部"}].concat(b.data),a.selectedAgent=a.agentModel[0]})}(),a.typeModel=[{name:"支付",type:1},{name:"充值",type:2}],a.selectedType=a.typeModel[0],a.financeParams={offset:0,limit:0,channelId:"",type:1},a.financeModel=[],a.getFinanceDetail=function(){a.financeParams=angular.extend(a.financeParams,{offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage,channelId:a.selectedAgent.ChannelId,type:a.selectedType.type}),b.getFinanceDetail(a.financeParams).then(function(b){a.financeModel=b.data,a.paginator.total=b.Count})},a.paginator={total:0,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.pageChanged=function(){a.getFinanceDetail()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.msgAlert=function(){c.open({templateUrl:"views/summit_modal.html",size:"md",controller:"SummitModal",resolve:{error:function(){return"该订单已退单"},sign:function(){return!0}}}).result.then(function(a){},function(){})}}]),angular.module("channelApp").factory("FinanceService",["$http","$q","PyCapital",function(a,b,c){function d(){var d=b.defer();return a({url:"/api/agent/dict"}).success(function(a,b,e,f){a.data=_.map(a.data,function(a){return a.py=c.getCaptial(a.ChannelName),a}),d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function e(c){var d=b.defer();return a({url:"/api/finance/detail",method:"GET",params:c}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}return{getAgent:d,getFinanceDetail:e}}]),angular.module("channelApp").controller("AddOrderCtrl",["$scope","$http","$filter","$state","$stateParams","FileUploader","user",function(a,b,c,d,e,f,g){function h(){var b=_.find(u,{Id:+a.postData.PayType});if(b){if(!a.postData.IsPromotion)return b.Price;if(a.promotion&&a.postData.IsPromotion){if(1==a.promotion.PromotionType)return b.Price;if(2==a.promotion.PromotionType){var c=a.promotion.PromotionDetailsEntityList;a.price="";for(var d=0;d<c.length;d++){if(console.log(b.Price,"Price"),console.log(b.ServiceMonths,"val.ServiceMonths"),1==b.IsZero&&0==c[d].ServiceMonths)var e=b.Price/6;else 1!=b.IsZero&&c[d].ServiceMonths==b.ServiceMonths&&(e=b.Price/b.ServiceMonths);if(e){a.price=b.Price-e*c[d].PromotionMonths,(a.price+"").indexOf(".")>-1&&(a.price=a.price.toFixed(2));break}}return a.price}}}return""}function i(){a.hasBalance=!0,b.get("api/agent/balance").success(function(b){a.balance=b.data})}function j(){b.get("/api/code/industry").success(function(b){a.industries=b.data}),b.get("/api/citybychannel").success(function(c){a.cities=c.data,a.postData.CityCode||(a.postData.CityCode=a.cities[0].CityCode),a.setprice(!0),a.isReadOnly?b.get("api/cityprice?cityCode="+a.postData.CityCode+"&ischeck=1").success(function(b){u=b.data,a.payTypes=b.data}):b.get("api/cityprice?cityCode="+a.postData.CityCode).success(function(b){if(u=b.data,a.payTypes=b.data,q){12==_.find(u,{Id:+a.result.PayType}).ServiceMonths&&(a.result.IsPromotion=!0)}})}),b.get("/api/orders/sales").success(function(b){a.sales=b.data,a.postData.SalesId=""+b.data[0].UserId}),b.get("/api/gift?ChannelId=").success(function(b){p=b.data.filter(function(a){return a.Num>0}),l(),a.filterGifts1()})}function k(){return 3==a.postData.Category?void(a.showProm=!1):a.postData&&a.postData.IsPromotion&&!a.isReadOnly&&2!=a.postData.Status?void(a.showProm=!0):(console.log(a.isReadOnly),!a.promotion||2==a.postData.Status&&a.postData.OrderId?(a.showProm=!1,!1):void(a.promotion&&a.isReadOnly?a.showProm=!1:a.showProm=!0))}function l(){var b=[];a.postData.AddedValue&&(angular.forEach(p,function(c){c.AddedValue==a.postData.AddedValue&&(_.find(b,function(a){return a.GiftTypeId===c.GiftTypeId&&a.AddedValue===c.AddedValue&&a.Price===c.Price})||b.push(c))}),a.gifts=b)}function m(){a.postData.IsPromotion=!!a.postData.IsPromotion}function n(a,b){var d=function(a){var b="",c=a.lastIndexOf(".");return-1!=c&&(b=a.substring(c)),b},e=function(a){a=a||32;for(var b="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",c=b.length,d="",e=0;e<a;e++)d+=b.charAt(Math.floor(Math.random()*c));return d},f=d(b),g={1:"FileUploads/Order/CardID/",2:"FileUploads/Order/BusinessLicense/",3:"FileUploads/Order/Contract/",4:"FileUploads/Agent/"},h=c("date")(new Date,"yyyyMM");return g[a]+h+"/"+e(10)+f}function o(a,b){return!!/^.*\.(?:png|jpg|bmp|gif|jpeg)$/.test(a.name.toLowerCase())||(alert("请选择图片"),!1)}a.isCenter=g.get().IsCenter,a.showGift=!1;var p=[];a.postData={NoDeadLine:0,ContractPath:[]},a.companySelect=function(c,d,e,f){b.get("/api/orders/company?name="+encodeURI(e)).success(function(b){var c=b.data[0];c.SalesId&&delete c.SalesId,c.BusnissDeadline?"0001"===c.BusnissDeadline.substr(0,4)?c.BusnissDeadline="":c.BusnissDeadline=new Date(c.BusnissDeadline):c.BusnissDeadline="",c.Name=c.Name.trim(),c.AddedValue=""+c.AddedValue,c.Industry=""+c.Industry,c.RegisterDate?c.RegisterDate=new Date(c.RegisterDate):c.RegisterDate="",a.postData=angular.extend(a.postData,c)})},a.dateOptions={formatYear:"yyyy"},a.dateOptions2={formatYear:"yyyy",minMode:"month"};var q=e.orderId;if(q&&"C"===q.charAt(0)){var r=q.split("&");a.companySelect(null,null,r[0].substr(1));var s=new Date(r[1]);s.setDate(1),s.setMonth(s.getMonth()+1),a.dateOptions2.minDate=s,a.IsReOrder=!0,q=null}else q=e.orderId||a.$parent.orderId||!1;a.IsPromotionValid=function(){var b=_.find(u,{Id:+a.postData.PayType});if(!b)return!0;if(a.promotion)for(var c=a.promotion.PromotionDetailsEntityList,d=0;d<c.length;d++)if(0==b.IsZero&&0!=c[d].ServiceMonths&&0!=a.promotion.Num){if(c[d].ServiceMonths==b.ServiceMonths)return!1}else if(1==b.IsZero&&0==c[d].ServiceMonths&&0!=a.promotion.Num)return!1;return a.postData.IsPromotion=!1,!0},a.setprice=function(){if(a.isReadOnly)return a.postData.ContractAmount;_.find(u,{Id:+a.postData.PayType});return a.postData.AddedValue&&p.length>0&&(a.showGift=!0,l()),a.postData.CityCode&&u&&a.postData.AddedValue&&a.postData.PayType?(a.postData.ContractAmount=h(),a.postData.ContractAmount):""},a.category=1,a.setCategory=function(){q||(a.isNewCompany?a.category=2:a.category=1)},a.channelUsePromotion=function(){b.get("/api/newpromotion/getchannelpromotionbyorder").success(function(b){b.status&&(a.promotion=b.data,k())})},a.channelUsePromotion(),q?b.get("/api/orders/"+q).success(function(b){a.result=angular.extend(b.data,b.data.Customer),b=angular.extend(b.data,b.data.Customer),b.IsPromotion?a.promotion=b.Promotion:a.channelUsePromotion(),console.log(a.promotion,"$scope.promotion"),"0001"===b.ContractDate.substr(0,4)?b.ContractDate="":b.ContractDate=new Date(b.ContractDate),"0001"===b.BusnissDeadline.substr(0,4)?b.BusnissDeadline="":b.BusnissDeadline=new Date(b.BusnissDeadline),"0001"===b.ServiceStart.substr(0,4)?b.ServiceStart="":b.ServiceStart=new Date(b.ServiceStart),"0001"===b.RegisterDate.substr(0,4)?b.RegisterDate="":b.RegisterDate=new Date(b.RegisterDate),"0001"===b.ServiceEnd.substr(0,4)?b.ServiceEnd="":b.ServiceEnd=b.ServiceEnd.substr(0,7),b.NoDeadLine&&(b.BusnissDeadline=""),b.IsPromotion&&(b.IsPromotion=!!b.IsPromotion),b.BillLevel=""+b.BillLevel,a.isChange||1==b.IsChange?b.AddedValue="1":b.AddedValue=""+b.AddedValue,b.Industry=""+b.Industry,b.ContractPath=b.ContractPath?b.ContractPath.split(";"):[],a.postData=b,a.category=b.Category,a.IsReOrder&&(a.postData.Status=1),1==a.category&&2!=b.Status&&(a.showProm=!0),(2==b.Category&&2==b.Status||3==b.Category)&&(a.category=3,a.showProm=!1,2==b.Status&&3==b.Category&&(a.isReadOnly=!0)),2===a.postData.Status&&3!=a.category?a.isReadOnly=!0:3==a.category||a.isCenter||i(),a.$parent.readonly&&(a.isReadOnly=!0),a.isReadOnly||(a.showGift=!0),b.GiftTypeId&&a.isReadOnly&&(b.GiftStr=b.GiftTypeName+"(￥"+b.GiftPrice+")"),a.filterGifts1(),console.log(a.isReadOnly,"$scope.isReadOnly"),k(),a.isNewCompany=b.Category>1,j()}):(j(),i()),a.filterGifts1=function(){var b=[];if(a.postData.AddedValue){if(angular.forEach(p,function(c){c.AddedValue==a.postData.AddedValue&&(_.find(b,function(a){return a.GiftTypeId===c.GiftTypeId&&a.AddedValue===c.AddedValue&&a.Price===c.Price})||b.push(c))}),a.postData.GiftTypeId){var c=_.find(b,function(b){return b.GiftTypeId===a.postData.GiftTypeId&&b.AddedValue==a.postData.AddedValue&&b.Price==a.postData.GiftPrice});c&&(a.postData.gift=""+c.Id)}else a.postData.gift||(a.postData.gift="");a.gifts=b}},a.getCompanyName=function(a){return b.get("/api/orders/companyname?name="+encodeURI(a)).then(function(a){return a.data.data.map(function(a){return{Name:a.Name}})})},a.clearPaytype=function(){a.postData.PayType="",a.postData.IsPromotion=0},a.getPayType=function(){12==_.find(u,{Id:+a.postData.PayType}).ServiceMonths&&a.promotion&&(a.postData.IsPromotion=!0)},a.save=function(e){var f=(new Date).getHours(),g=(new Date).getTime()+864e5;if(1==new Date(g).getDate()&&f>21)return void alert("月末22:00之后不允许提单！");if(a.submited=!0,delete a.postData.Customer,!a.postData.SalesId)return alert("请先选择销售人员！"),void m();if(a.IsReOrder&&(a.postData.IsReOrder=1),!a.loading){var h=angular.copy(a.postData);if(h.IsPromotion&&h.OrderId&&h.Promotion.PromotionDetailsEntityList.length?h.IsPromotion=h.Promotion.Id:h.IsPromotion&&a.promotion&&a.promotion.Id?h.IsPromotion=a.promotion.Id:h.IsPromotion=0,2==a.category)return void a.saveCus(e);if(3==a.category)return void a.saveTob(e);if(a.myForm.$invalid||!a.postData.BusinessLicense)return alert("请补充必填项！"),void m();if(!h.NoDeadLine&&!h.BusnissDeadline)return alert("请填写营业期限！"),void m();if(h.ContractDate=c("date")(a.postData.ContractDate,"yyyy-MM-dd"),h.RegisterDate=c("date")(a.postData.RegisterDate,"yyyy-MM-dd"),h.BusnissDeadline=c("date")(a.postData.BusnissDeadline,"yyyy-MM-dd"),h.ServiceStart=c("date")(a.postData.ServiceStart,"yyyy-MM-dd"),h.ServiceEnd=c("date")(a.postData.ServiceEnd,"yyyy-MM-dd"),h.ContractPath=h.ContractPath.join(";"),h.NoDeadLine?(h.BusnissDeadline="",h.NoDeadLine=1):h.NoDeadLine=0,h.gift){var i=_.find(a.gifts,function(b){return b.Id===+a.postData.gift});h.GiftTypeId=i.GiftTypeId,h.GiftTypeName=i.GiftTypeName,h.GiftPrice=i.Price,delete h.gift}else delete h.GiftTypeId,delete h.GiftTypeName,delete h.GiftPrice;var j={url:"/api/orders",data:h,method:"post"};a.postData.OrderId&&(j.method="put",j.url=j.url+"/"+a.postData.OrderId,e&&(j.url="api/Reorders/"+a.postData.OrderId)),a.loading=!0,b(j).success(function(b){b.status?(alert("操作成功！"),a.isModal?a.closeModal():d.go("^.orderList"),a.postData={}):a.postData.IsPromotion=!!a.postData.IsPromotion,a.loading=!1}).error(function(){a.loading=!1})}},a.saveCus=function(){if(a.myForm.$invalid)return alert("请补充必填项！"),void m();var e=angular.copy(a.postData);if(e.IsPromotion&&e.Promotion?e.IsPromotion=e.Promotion.Id:e.IsPromotion&&a.promotion.Id?e.IsPromotion=a.promotion.Id:e.IsPromotion=0,e.ContractDate=c("date")(a.postData.ContractDate,"yyyy-MM-dd"),e.ContractPath=e.ContractPath.join(";"),!e.PersonCardPath)return alert("请上传法人身份证照片！"),void m();if(e.gift){var f=_.find(a.gifts,function(b){return b.Id===+a.postData.gift});e.GiftTypeId=f.GiftTypeId,e.GiftTypeName=f.GiftTypeName,e.GiftPrice=f.Price,delete e.gift}else delete e.GiftTypeId,delete e.GiftTypeName,delete e.GiftPrice;var g={url:"/api/orderszj",data:e,method:"post"};a.postData.OrderId&&(g.url="api/Reorders/"+a.postData.OrderId,g.method="put"),a.loading=!0,b(g).success(function(b){b.status?(alert("操作成功！"),a.isModal?a.closeModal():d.go("^.orderList"),a.postData={}):a.postData.IsPromotion=!!a.postData.IsPromotion,a.loading=!1}).error(function(){a.loading=!1})},a.saveTob=function(e){if(a.myForm.$invalid||!a.postData.BusinessLicense)return alert("请补充必填项！"),void m();var f=angular.copy(a.postData);if(f.IsPromotion&&f.Promotion?f.IsPromotion=f.Promotion.Id:f.IsPromotion&&a.promotion.Id?f.IsPromotion=a.promotion.Id:f.IsPromotion=0,!f.NoDeadLine&&!f.BusnissDeadline)return alert("请填写营业期限！"),void m();f.ContractDate=c("date")(a.postData.ContractDate,"yyyy-MM-dd"),f.RegisterDate=c("date")(a.postData.RegisterDate,"yyyy-MM-dd"),f.BusnissDeadline=c("date")(a.postData.BusnissDeadline,"yyyy-MM-dd"),f.ServiceStart=c("date")(a.postData.ServiceStart,"yyyy-MM-dd"),f.ServiceEnd=c("date")(a.postData.ServiceEnd,"yyyy-MM-dd"),f.ContractPath=f.ContractPath.join(";"),f.NoDeadLine?(f.BusnissDeadline="",f.NoDeadLine=1):f.NoDeadLine=0;var g={url:"/api/supplementaryinfo",data:f,method:"put"};a.loading=!0,b(g).success(function(b){b.status?(alert("操作成功！"),a.isModal?a.closeModal():d.go("^.orderList"),a.postData={}):a.postData.IsPromotion=!!a.postData.IsPromotion,a.loading=!1}).error(function(){a.loading=!1})};var t="https://pilipa.oss-cn-beijing.aliyuncs.com";b.get("/api/signkey").success(function(b){delete b.data.Filename,delete b.data.key,delete b.data.callback,delete b.data.expire,delete b.data.Host,a.signkey=b.data}),a.uploader1=new f({url:t,autoUpload:!0});var u;a.uploader1.filters.push({name:"customFilter",fn:o}),a.uploader2=new f({autoUpload:!0,url:t}),a.uploader3=new f({autoUpload:!0,url:t}),a.uploader1.onCompleteItem=function(b,c,d,e){a.postData.PersonCardPath=t+"/"+a._key1},a.uploader2.onCompleteItem=function(b,c,d,e){a.postData.BusinessLicense=t+"/"+a._key2},a.uploader3.onCompleteItem=function(b,c,d,e){a.postData.ContractPath.push(t+"/"+a._key3)},a.uploader1.onBeforeUploadItem=function(b){var c=n(1,b.file.name);b.formData.push({key:c}),_.each(a.signkey,function(a,c){var d={};d[c]=a,b.formData.push(d)}),a._key1=c},a.uploader2.onBeforeUploadItem=function(b){var c=n(2,b.file.name);b.formData.push({key:c}),_.each(a.signkey,function(a,c){var d={};d[c]=a,b.formData.push(d)}),a._key2=c},a.uploader3.onBeforeUploadItem=function(b){var c=n(3,b.file.name);b.formData.push({key:c}),_.each(a.signkey,function(a,c){var d={};d[c]=a,b.formData.push(d)}),a._key3=c},a.uploader2.onErrorItem=function(){alert("上传失败!")},a.uploader1.onErrorItem=function(){alert("上传失败!")},a.uploader3.onErrorItem=function(){alert("上传失败!")},a.uploader1.filters.push({name:"customFilter",fn:o}),a.uploader2.filters.push({name:"customFilter",fn:o}),a.uploader3.filters.push({name:"customFilter",fn:o}),a.setEndDate=function(){if(a.postData.ServiceStart&&a.postData.PayType&&!a.postData.FreChangeOrderId){var b=_.find(u,{Id:+a.postData.PayType});if(b){var d=b.ServiceMonths,e=0;if(a.postData.gift){e+=_.find(a.gifts,function(b){return b.Id===+a.postData.gift}).MonthNum}if(a.promotion&&a.postData.IsPromotion&&1==a.promotion.PromotionType)for(var f=a.promotion.PromotionDetailsEntityList,g=0;g<f.length;g++)0==f[g].ServiceMonths&&1==b.IsZero&&(e+=f[g].PromotionMonths),f[g].ServiceMonths==d&&1!=b.IsZero&&(e+=f[g].PromotionMonths);d+=e;var h=new Date(a.postData.ServiceStart),i=new Date(h.setMonth(h.getMonth()+d-1));a.postData.ServiceEnd=c("date")(i,"yyyy-MM")}}}}]),angular.module("channelApp").controller("AddOrderCtrl2",["$scope","$http","$filter","$state","$stateParams","$uibModal","FileUploader","user","ossUploader","promisesHandle",function(a,b,c,d,e,f,g,h,i,j){function k(){b.get("api/agent/balance").success(function(b){a.balance=b.data})}function l(a){var b=a;f.open({templateUrl:"views/summit_modal.html",size:"md",controller:"SummitModal",resolve:{error:function(){return b},sign:function(){return!0}}}).result.then(function(a){},function(){})}function m(c){b.get("/api/orders/sales").success(function(b){a.sales=b.data}),b.get("/api/citybychannel").success(function(d){a.cities=d.data,a.postData.CityCode||(a.postData.CityCode=a.cities[0].CityCode),a.isReadOnly?b.get("api/cityprice?cityCode="+a.postData.CityCode+"&ischeck=1").success(function(b){a.priceList=b.data,c&&c(1);for(var d in b.data)a.payTypes[b.data[d].AddedValue]||(a.payTypes[b.data[d].AddedValue]=[]),b.data[d].id=b.data[d].Id,b.data[d].title=b.data[d].PriceName,a.payTypes[b.data[d].AddedValue].push(b.data[d])}):b.get("api/cityprice?cityCode="+a.postData.CityCode).success(function(b){a.priceList=b.data,c&&c(1);for(var d in b.data)a.payTypes[b.data[d].AddedValue]||(a.payTypes[b.data[d].AddedValue]=[]),b.data[d].id=b.data[d].Id,b.data[d].title=b.data[d].PriceName,a.payTypes[b.data[d].AddedValue].push(b.data[d])})}),b.get("/api/gift?ChannelId=").success(function(b){if(b.status){a.giftList=b.data,c&&c(2);for(var d in b.data)0==b.data[d].Num&&b.data[d].Id==a.postData.gift&&(b.data[d].Num+=1),b.data[d].Num>0&&(b.data[d].GiftTypeName=b.data[d].GiftTypeName+"￥"+b.data[d].Price,a.gifts[b.data[d].AddedValue]||(a.gifts[b.data[d].AddedValue]=[]),a.gifts[b.data[d].AddedValue].push(b.data[d]));console.log(a.gifts)}})}function n(){b.get("/api/newpromotion/getchannelpromotionbyorder").success(function(b){b.status&&(a.promotion=b.data)})}function o(){if(a.postData.payType&&a.postData.payType.Id)var b=_.find(a.priceList,{Id:+a.postData.payType.Id});else b=_.find(a.priceList,{Id:+a.postData.PayType});if(b){if(!a.postData.IsPromotion)return b.Price;if(a.promotion&&a.postData.IsPromotion){if(1==a.promotion.PromotionType)return b.Price;if(2==a.promotion.PromotionType){var c=a.promotion.PromotionDetailsEntityList;a.price="";for(var d=0;d<c.length;d++){if(1==b.IsZero&&0==c[d].ServiceMonths)var e=b.Price/6;else 1!=b.IsZero&&c[d].ServiceMonths==b.ServiceMonths&&(e=b.Price/b.ServiceMonths);if(e){a.price=b.Price-e*c[d].PromotionMonths,(a.price+"").indexOf(".")>-1&&(a.price=a.price.toFixed(2));break}}return a.price}}}return""}function p(c){b(c).success(function(b){b.status?(alert("操作成功！"),a.isModal?a.closeModal():d.go("^.orderList"),a.postData={}):a.postData.IsPromotion=!!a.postData.IsPromotion,a.loading=!1}).error(function(){a.loading=!1})}function q(a){var b=function(a){var b="",c=a.lastIndexOf(".");return-1!=c&&(b=a.substring(c)),b},d=function(a){a=a||32;for(var b="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",c=b.length,d="",e=0;e<a;e++)d+=b.charAt(Math.floor(Math.random()*c));return d},e=b(a);return"FileUploads/Recharge/"+c("date")(new Date,"yyyyMM")+"/"+d(10)+e}function r(a){alert("上传失败!")}a.postData={AddedValue:1,Name:null,PersonCardPath:""},a.payTypes=[],a.companyList=[],a.searchType=1,a.searchError="",a.isReadOnly=!1,a.isCompanyReadonly=!1,a.nameReadonly=!1,a.gifts=[],a.submited=!1,a.priceList=[],a.category=1,a.clearCompanyInfo=function(){1!=a.searchType&&a.postData.Name!=a.searchCompanyInfo.CompanyName&&(a.postData.Address="",a.postData.BusinessScope="",a.postData.BusnissDeadline="",a.postData.NoNoDeadLine&&(a.postData.NoNoDeadLine=0),a.postData.LegalPerson="",a.postData.RegNO="",a.postData.RegisterDate="",a.postData.RegisteredCapital="",a.searchType=1,a.isCompanyReadonly=!1,a.isLegalPersonReadonly=!1,a.isRegNOReadonly=!1,a.isRegisteredCapitalReadonly=!1,a.isBusinessScopeReadonly=!1,a.isAddressReadonly=!1)},a.clearPaytype=function(){a.postData.payType="",a.postData.gift="",a.postData.IsPromotion=!1},a.clearEndDate=function(){a.postData.NoDeadLine=!a.postData.NoDeadLine,a.postData.NoDeadLine&&(a.postData.BusnissDeadline="")},a.toCheck=function(){if(a.searchError="",a.searchType=2,
!a.nameReadonly)return a.postData.Name?a.postData.Name&&a.postData.Name.length<3?void(a.searchError="请输入准确完整的公司名称！"):void a.getMoreCompanyName(a.postData.Name,function(){a.searchError=a.companyList?"":"抱歉，没有检索到公司信息！",""==a.postData.Name||a.postData.Name.length<3||0===a.companyList.length?$(".dropdown-company-list").parent().removeClass("open"):$(".dropdown-company-list").parent().addClass("open")}):void(a.searchError="请输入公司名称！")},a.$watch("postData.Name",function(){if(!s){if(!a.postData.Name)return $(".dropdown-company-list").parent().removeClass("open"),void(a.searchError="");if(a.postData.Name.length<3)return void $(".dropdown-company-list").parent().removeClass("open");if(a.searchError="",a.companySelected)return void $(".dropdown-company-list").parent().removeClass("open");a.getCompanyName(a.postData.Name,function(){""==a.postData.Name||a.postData.Name.length<3||0===a.companyList.length?$(".dropdown-company-list").parent().removeClass("open"):$(".dropdown-company-list").parent().addClass("open")})}}),a.$watch("postData.IsPromotion",function(){a.setprice(),a.setEndDate()}),a.getCompanyName=function(c,d){return b.get("/api/orders/companyname?name="+encodeURI(c)).then(function(b){var c=b.data;c.status&&(a.companyList=c.data,d&&d())})},a.getMoreCompanyName=function(c,d){b.get("/api/order/getcustomerlistbyty?size=7&word="+encodeURI(c)).then(function(b){var c=b.data;if(c.status){for(var e in c.data)c.data[e].Name=c.data[e].name;a.companyList=c.data,d&&d()}})},a.companySelect=function(c,d){console.log("选择公司"),$(".dropdown-company-list").parent().removeClass("open"),a.companySelected=!0,a.isCompanyReadonly=!1,1==a.searchType?b.get("/api/orders/company?name="+encodeURI(c)).success(function(b){a.companyInfo=b.data[0];var c=b.data[0];c.IsSync&&(a.isCompanyReadonly=!0,a.isLegalPersonReadonly=!0,a.isRegNOReadonly=!0,a.isRegisteredCapitalReadonly=!0,a.isBusinessScopeReadonly=!0,a.isAddressReadonly=!0),c.SalesId&&delete c.SalesId,c.BusnissDeadline?"0001"===c.BusnissDeadline.substr(0,4)||"9999"===c.BusnissDeadline.substr(0,4)?(c.BusnissDeadline="",c.NoDeadLine=1):(c.BusnissDeadline=new Date(c.BusnissDeadline),c.NoDeadLine=0):(c.BusnissDeadline="",c.NoDeadLine=1),c.Name=c.Name.trim(),c.AddedValue=""+c.AddedValue,c.RegisterDate?c.RegisterDate=new Date(c.RegisterDate):c.RegisterDate="",a.postData=angular.extend(a.postData,c),setTimeout(function(){a.companySelected=!1},0)}):b.get("/api/order/getcustomerbyty?code="+d).success(function(b){var c=b.data;return a.searchCompanyInfo=b.data,console.log(a.isFirstcategory3),s&&2!=a.isFirstcategory3&&a.postData.Name&&a.postData.Name!=c.CompanyName?void l("客户名称不一致，不允许修改！如需修改工商信息，请删除订单后重提"):a.xfReadonly&&a.postData.Name&&a.postData.Name!=c.CompanyName?void l("客户名称不一致，不允许修改！如需修改工商信息，请删除订单后重提"):(s&&(a.postData.Customer.IsSync=1),c.BusnissDeadline?"0001"===c.BusnissDeadline.substr(0,4)||"9999"===c.BusnissDeadline.substr(0,4)?(c.BusnissDeadline="",c.NoDeadLine=1):(c.BusnissDeadline=new Date(c.BusnissDeadline),c.NoDeadLine=0):(c.BusnissDeadline="",c.NoDeadLine=1),c.Name=c.CompanyName.trim(),c.RegisterDate?c.RegisterDate=new Date(c.RegisterDate):c.RegisterDate="",a.postData.LegalPerson?c.LegalPerson!=a.postData.LegalPerson&&(a.postData.PersonCardID="",a.isLegalPersonReadonly=!0):a.isLegalPersonReadonly=!!c.LegalPerson,a.isAddressReadonly=!!c.Address,a.isRegNOReadonly=!!c.RegNO,a.isCompanyReadonly=!!c.RegisterDate,a.isRegisteredCapitalReadonly=!!c.RegisteredCapital,a.isBusinessScopeReadonly=!!c.BusinessScope,a.postData=angular.extend(a.postData,c),void setTimeout(function(){a.companySelected=!1},0))})},a.serviceStartOptions={formatYear:"yyyy",minMode:"month"},a.orderId=e.orderId;var s=e.orderId;if(s&&"C"===s.charAt(0)){var t=s.split("&");a.companySelect(t[0].substr(1));var u=new Date(t[1]);u.setDate(1),u.setMonth(u.getMonth()+1),a.serviceStartOptions.minDate=u,a.xfReadonly=!0,s=null,a.IsReOrder=!0}else s=e.orderId||a.$parent.orderId||!1;s?b.get("/api/orders/"+s).success(function(b){if(a.companyInfo=b.data,m(function(c){switch(c){case 1:var d=_.filter(a.priceList,{Id:+b.PayType});a.payTypeReadonly=d,a.postData.payType=d[0];break;case 2:var e=_.filter(a.giftList,{Price:b.GiftPrice,GiftTypeId:b.GiftTypeId,AddedValue:b.Customer.AddedValue});e&&e[0]&&(a.postData.gift=e[0].Id.toString()||"",console.log(a.postData.gift))}}),k(),a.result=angular.extend(b.data,b.data.Customer),b=angular.extend(b.data,b.data.Customer),b.IsPromotion?a.promotion=b.Promotion:n(),b.IsSync?(a.isCompanyReadonly=!0,a.isLegalPersonReadonly=!0,a.isRegNOReadonly=!0,a.isRegisteredCapitalReadonly=!0,a.isBusinessScopeReadonly=!0,a.isAddressReadonly=!0):a.isCompanyReadonly=!1,"0001"===b.BusnissDeadline.substr(0,4)||"9999"===b.BusnissDeadline.substr(0,4)?(b.BusnissDeadline="",b.NoDeadLine=1):(b.BusnissDeadline=new Date(b.BusnissDeadline),b.NoDeadLine=0),"0001"===b.ServiceStart.substr(0,4)?b.ServiceStart="":b.ServiceStart=new Date(b.ServiceStart),"0001"===b.RegisterDate.substr(0,4)?b.RegisterDate="":b.RegisterDate=new Date(b.RegisterDate),"0001"===b.ServiceEnd.substr(0,4)?b.ServiceEnd="":b.ServiceEnd=b.ServiceEnd.substr(0,7),b.NoDeadLine&&(b.BusnissDeadline=""),b.IsPromotion=!!b.IsPromotion,b.ContractPath=b.ContractPath?b.ContractPath.split(";"):[],a.imgs=b.ContractPath,a.ServiceCompanyCode=b.ServiceCompanyCode,a.postData=b,a.isFirstcategory3=b.Category,a.category=b.Category,a.IsReOrder&&(a.postData.Status=1),1==a.category&&2!=b.Status&&(b.IsSync?a.isCompanyReadonly=!0:a.isCompanyReadonly=!1),e.isView)return a.isReadOnly=!0,a.category=b.Category,void(a.isChangeCompanyName=!0);(2==b.Category&&2==b.Status||3==b.Category)&&(a.category=3,a.isNewCompany=!0,a.complementCompanyInfo=!0,2!=b.Status&&3==b.Category&&(a.isChangeCompanyName=!0),2==b.Status&&3==b.Category&&(a.isReadOnly=!0,a.isChangeCompanyName=!0,a.postData.IsPromotion||(a.promotionShow=!0))),2===a.postData.Status&&3!=a.category?(a.isReadOnly=!0,a.postData.IsPromotion||(a.promotionShow=!0)):3!=a.category&&(2==a.category&&2!=b.Status&&(a.isNewCompany=!0),k())}):(m(),k()),s?a.result&&a.result.IsPromotion?a.promotion=a.result.Promotion:a.result&&!a.result.IsPromotion&&n():n(),a.IsPromotionValid=function(){if(!a.postData.payType)return!0;var b=_.find(a.priceList,{Id:+a.postData.payType.Id});if(!b)return!0;if(a.promotion)for(var c=a.promotion.PromotionDetailsEntityList,d=0;d<c.length;d++)if(0==b.IsZero&&0!=c[d].ServiceMonths&&0!=a.promotion.Num){if(c[d].ServiceMonths==b.ServiceMonths)return!1}else if(1==b.IsZero&&0==c[d].ServiceMonths&&0!=a.promotion.Num)return!1;return!0},a.promitionCanChoose=function(){if(a.postData.payType&&a.postData.payType.Id){var b=a.postData.payType;if(a.promotion){var c=a.promotion.PromotionDetailsEntityList;for(var d in c){if(c[d].ServiceMonths==b.ServiceMonths&&0==b.IsZero||0==c[d].ServiceMonths&&1==b.IsZero){a.postData.IsPromotion=!0,a.setprice(),a.setEndDate();break}a.postData.IsPromotion=!1,a.setprice(),a.setEndDate()}}}},a.setEndDate=function(){if(a.postData.ServiceStart&&a.postData.payType&&!a.postData.FreChangeOrderId){var b=_.find(a.priceList,{Id:+a.postData.payType.Id});if(b){var d=b.ServiceMonths,e=0;if(a.postData.gift){e+=_.find(a.giftList,function(b){return b.Id===+a.postData.gift}).MonthNum}if(a.promotion&&a.postData.IsPromotion&&1==a.promotion.PromotionType)for(var f=a.promotion.PromotionDetailsEntityList,g=0;g<f.length;g++)0==f[g].ServiceMonths&&1==b.IsZero&&(e+=f[g].PromotionMonths),f[g].ServiceMonths==d&&1!=b.IsZero&&(e+=f[g].PromotionMonths);d+=e;var h=new Date(a.postData.ServiceStart),i=new Date(h.setMonth(h.getMonth()+d-1));a.postData.ServiceEnd=c("date")(i,"yyyy-MM")}}},a.setprice=function(){if(a.isReadOnly)return a.postData.ContractAmount;if(a.postData.payType&&a.postData.payType.Id){_.find(a.priceList,{Id:+a.postData.payType.Id})}else _.find(a.priceList,{Id:+a.postData.PayType});return a.postData.ContractAmount=o(),a.postData.ContractAmount},a.setCategory=function(){a.postData.OrderId||(a.postData={AddedValue:1,Name:null,PersonCardPath:""},a.isNewCompany?(a.category=2,a.postData.CityCode||(a.postData.CityCode=a.cities[0].CityCode)):(a.category=1,a.postData.CityCode||(a.postData.CityCode=a.cities[0].CityCode)))},a.ImgUploader=function(c){return i(c).then(function(c){return b.get("/api/order/getpersoncardbypath?path="+c.sourceUrl).success(function(b){b.status&&b.data.LegalPerson?s&&2!=a.postData.Category?1==a.postData.Customer.IsSync&&a.postData.LegalPerson&&a.postData.LegalPerson==b.data.LegalPerson&&a.isLegalPersonReadonly?(a.postData.LegalPerson=b.data.LegalPerson,a.postData.PersonCardID=b.data.PersonCardID):1==a.postData.Customer.IsSync&&a.postData.LegalPerson&&a.postData.LegalPerson!=b.data.LegalPerso&&a.isLegalPersonReadonly?(a.postData.PersonCardPath="",l("身份证上的法人姓名与营业执照上的法人不符")):(a.postData.LegalPerson=b.data.LegalPerson,a.postData.PersonCardID=b.data.PersonCardID):a.xfReadonly&&a.companyInfo&&a.companyInfo.IsSync?a.postData.LegalPerson&&a.postData.LegalPerson==b.data.LegalPerson?(a.postData.LegalPerson=b.data.LegalPerson,a.postData.PersonCardID=b.data.PersonCardID):a.postData.LegalPerson&&a.postData.LegalPerson!=b.data.LegalPerso?(a.postData.PersonCardPath="",l("身份证上的法人姓名与营业执照上的法人不符")):(a.postData.LegalPerson=b.data.LegalPerson,a.postData.PersonCardID=b.data.PersonCardID):1!=a.searchType&&a.postData.LegalPerson&&a.postData.LegalPerson==b.data.LegalPerson?(a.postData.LegalPerson=b.data.LegalPerson,a.postData.PersonCardID=b.data.PersonCardID):1!=a.searchType&&a.postData.LegalPerson&&a.postData.LegalPerson!=b.data.LegalPerso?(a.postData.PersonCardPath="",l("身份证上的法人姓名与营业执照上的法人不符")):(a.postData.LegalPerson=b.data.LegalPerson,a.postData.PersonCardID=b.data.PersonCardID):b.status&&!b.data&&l("无法识别身份信息，请上传清晰的身份证或手动输入法人、法人身份证号！")}),c})},a.ImgUploader1=function(a){return i(a)},a.startDateOptions={formatYear:"yyyy"},a.endDateOptions={formatYear:"yyyy"},a.fastCheck=function(){if(!a.nameReadonly){f.open({templateUrl:"views/addorder_company_modal.html",size:"md",controller:"AddorderCompanyModal",resolve:{}}).result.then(function(b){if(b){if(s&&2!=a.isFirstcategory3&&a.postData.Name&&a.postData.Name!=b.CompanyName)return void l("客户名称不一致，不允许修改！如需修改工商信息，请删除订单后重提");if(a.xfReadonly&&a.postData.Name&&a.postData.Name!=b.CompanyName)return void l("客户名称不一致，不允许修改！如需修改工商信息，请删除订单后重提");s&&2!=a.postData.Category&&(a.isCompanyReadonly=!1,a.postData.LegalPerson="",a.isLegalPersonReadonly=!1,a.postData.Address="",a.isAddressReadonly=!1,a.postData.RegNO="",a.isRegNOReadonly=!1,a.postData.RegisterDate="",a.postData.BusnissDeadline=""),s&&(a.postData.Customer.IsSync=1),a.postData.NoNoDeadLine&&(a.postData.NoNoDeadLine=0),a.postData.RegisteredCapital="",a.isRegisteredCapitalReadonly=!1,a.postData.BusinessScope="",a.isBusinessScopeReadonly=!1,a.resultInfo=b,a.searchType=3,a.isCompanyReadonly=!0,a.searchCompanyInfo=b,a.nameReadonly=!1,b.Address&&(a.isAddressReadonly=!0),a.postData.Address=b.Address,b.BusinessScope&&(a.isBusinessScopeReadonly=!0),a.postData.BusinessScope=b.BusinessScope,b.BusnissDeadline&&"9999"!==b.BusnissDeadline.substr(0,4)&&"0001"!==b.BusnissDeadline.substr(0,4)?(a.postData.BusnissDeadline=new Date(b.BusnissDeadline),a.postData.NoDeadLine=0):(a.postData.NoDeadLine=1,a.postData.BusnissDeadline=""),a.postData.Name=b.CompanyName,b.LegalPerson?(a.isLegalPersonReadonly=!0,s?a.postData&&a.postData.Customer&&a.postData.Customer.LegalPerson&&a.postData.Customer.LegalPerson!=b.LegalPerson?(a.postData.LegalPerson=b.LegalPerson,a.postData.PersonCardID="",a.postData.PersonCardPath=""):a.postData.LegalPerson=b.LegalPerson:a.postData&&a.postData.LegalPerson&&a.postData.LegalPerson!=b.LegalPerson?(a.postData.LegalPerson=b.LegalPerson,a.postData.PersonCardID="",a.postData.PersonCardPath=""):a.postData.LegalPerson=b.LegalPerson):a.isLegalPersonReadonly=!1,b.RegNO&&(a.isRegNOReadonly=!0),a.postData.RegNO=b.RegNO,b.RegisterDate&&(a.isRegisterDateReadonly=!0),a.postData.RegisterDate=new Date(b.RegisterDate),b.RegisteredCapital&&(a.isRegisteredCapitalReadonly=!0),a.postData.RegisteredCapital=b.RegisteredCapital,a.ServiceCompanyCode=b.ServiceCompanyCode}else l("抱歉，没有检索到企业信息，请重试或手动录入！")},function(){})}},a.save=function(d){var e=(new Date).getHours(),g=(new Date).getTime()+864e5;if(1==new Date(g).getDate()&&e>21)return void alert("月末22:00之后不允许提单！");if(a.submited=!0,!a.postData.SalesId)return void alert("请先选择销售人员！");a.IsReOrder&&(a.postData.IsReOrder=1);var h=angular.copy(a.postData),i=angular.copy(a.imgs);if(h.IsPromotion&&h.OrderId&&h.Promotion.PromotionDetailsEntityList.length?h.IsPromotion=h.Promotion.Id:h.IsPromotion&&a.promotion.Id?h.IsPromotion=a.promotion.Id:h.IsPromotion=0,2==a.category)return void a.saveCus(d,h);if(3==a.category)return void a.saveTob(d,h);if(a.myForm.$invalid)return void alert("请补充必填项！");if(a.postData.Mobile.length<11)return void alert("请输入11位手机号！");if(!a.postData.BusinessLicense)return void alert("请上传营业执照！");if(!a.postData.PersonCardPath)return void alert("请上传法人身份证！");if(!h.payType)return void alert("请选择套餐类型！");if(!h.NoDeadLine&&!h.BusnissDeadline)return void alert("请填写营业期限！");if(h.RegisterDate=c("date")(a.postData.RegisterDate,"yyyy-MM-dd"),h.BusnissDeadline=c("date")(a.postData.BusnissDeadline,"yyyy-MM-dd"),h.ServiceStart=c("date")(a.postData.ServiceStart,"yyyy-MM-dd"),h.ServiceEnd=c("date")(a.postData.ServiceEnd,"yyyy-MM-dd"),h.ServiceCompanyCode=h.ServiceCompanyCode?h.ServiceCompanyCode:a.ServiceCompanyCode,h.ContractPath=i.join(";"),h.NoDeadLine?(h.BusnissDeadline="",h.NoDeadLine=1):h.NoDeadLine=0,h.gift){var j=_.find(a.giftList,function(b){return b.Id===+a.postData.gift});h.GiftTypeId=j.GiftTypeId,h.GiftTypeName=j.GiftTypeName.slice(0,3),h.GiftPrice=j.Price,delete h.gift}else delete h.GiftTypeId,delete h.GiftTypeName,delete h.GiftPrice;var k=h.payType.IsZero;h.PayType=h.payType.Id,delete h.payType,s?s&&(a.result&&a.result.Customer&&1==a.result.Customer.IsSync?h.IsSync=1:a.result&&a.result.Customer&&0==a.result.Customer.IsSync&&(h.IsSync=0)):1!=a.searchType?h.IsSync=1:h.IsSync=0,console.log(h,"最终提交数据");var m=h.PersonCardID,n=h.ServiceStart;if(a.companyInfo&&a.companyInfo.CustomerId)var o=a.companyInfo.CustomerId;else o="";var q={url:"/api/orders",data:h,method:"post"};a.postData.OrderId&&(q.method="put",q.url=q.url+"/"+a.postData.OrderId,d&&(q.url="api/Reorders/"+a.postData.OrderId)),a.loading=!0,b.get("api/order/CheckStatusByPersonalCard?personancard="+m).success(function(a){if(a.status){if(a.data>0)return void l("该法人存在未完成的预提单，请先完成预提单");if(0==a.data)if(1==k)p(q);else{var c=s||0;b.get("api/order/CheckIsConnectDate?servicestart="+n+"&customerid="+o+"&orderid="+c).success(function(a){if(a.status)if(a.data){var b=a.data,c=f.open({templateUrl:"views/summit_modal.html",size:"md",controller:"SummitModal",resolve:{error:function(){return b},sign:function(){return!1}}});c.result.then(function(a){a&&p(q)},function(){})}else p(q)})}}})},a.saveCus=function(e,f){if(a.myForm.$invalid)return void alert("请补充必填项！");if(a.postData.Mobile.length<11)return void alert("请输入11位手机号！");if(!a.postData.PersonCardPath)return void alert("请上传法人身份证");if(!f.payType)return void alert("请选择套餐类型");if(f.RegisterDate=c("date")(a.postData.RegisterDate,"yyyy-MM-dd"),f.BusnissDeadline=c("date")(a.postData.BusnissDeadline,"yyyy-MM-dd"),f.ServiceStart=c("date")(a.postData.ServiceStart,"yyyy-MM-dd"),f.ServiceEnd=c("date")(a.postData.ServiceEnd,"yyyy-MM-dd"),f.ContractPath=a.imgs.join(";"),f.NoDeadLine?(f.BusnissDeadline="",f.NoDeadLine=1):f.NoDeadLine=0,f.gift){var g=_.find(a.giftList,function(b){return b.Id===+a.postData.gift});f.GiftTypeId=g.GiftTypeId,f.GiftTypeName=g.GiftTypeName.slice(0,3),f.GiftPrice=g.Price,delete f.gift}else delete f.GiftTypeId,delete f.GiftTypeName,delete f.GiftPrice;f.PayType=f.payType.Id,delete f.payType,s?s&&(a.result&&a.result.Customer&&1==a.result.Customer.IsSync?f.IsSync=1:a.result&&a.result.Customer&&0==a.result.Customer.IsSync&&(f.IsSync=0)):1!=a.searchType?f.IsSync=1:f.IsSync=0;var h={url:"/api/orderszj",data:f,method:"post"};a.postData.OrderId&&(h.url="api/Reorders/"+a.postData.OrderId,h.method="put"),a.loading=!0,b(h).success(function(b){b.status?(alert("操作成功！"),a.isModal?a.closeModal():d.go("^.orderList"),a.postData={}):a.postData.IsPromotion=!!a.postData.IsPromotion,a.loading=!1}).error(function(){a.loading=!1})},a.saveTob=function(e,f){if(a.myForm.$invalid)return void alert("请补充必填项！");if(a.postData.Mobile.length<11)return void alert("请输入11位手机号！");if(!a.postData.BusinessLicense)return void alert("请上传营业执照！");if(!a.postData.PersonCardPath)return void alert("请上传法人身份证！");if(!f.NoDeadLine&&!f.BusnissDeadline)return void alert("请填写营业期限！");if(f.RegisterDate=c("date")(a.postData.RegisterDate,"yyyy-MM-dd"),f.BusnissDeadline=c("date")(a.postData.BusnissDeadline,"yyyy-MM-dd"),f.ServiceStart=c("date")(a.postData.ServiceStart,"yyyy-MM-dd"),f.ServiceEnd=c("date")(a.postData.ServiceEnd,"yyyy-MM-dd"),f.ServiceCompanyCode=f.ServiceCompanyCode?f.ServiceCompanyCode:a.ServiceCompanyCode,f.ContractPath=a.imgs.join(";"),f.NoDeadLine?(f.BusnissDeadline="",f.NoDeadLine=1):f.NoDeadLine=0,f.gift){var g=_.find(a.giftList,function(b){return b.Id===+a.postData.gift});f.GiftTypeId=g.GiftTypeId,f.GiftTypeName=g.GiftTypeName.slice(0,3),f.GiftPrice=g.Price,delete f.gift}else delete f.GiftTypeId,delete f.GiftTypeName,delete f.GiftPrice;f.PayType=f.payType.Id,delete f.payType,s?s&&(a.isChangeCompanyName?a.result&&a.result.Customer&&1==a.result.Customer.IsSync?f.IsSync=1:a.result&&a.result.Customer&&0==a.result.Customer.IsSync&&(f.IsSync=0):a.result&&a.result.Customer&&1!=a.searchType?(f.IsSync=1,f.Customer.IsSync=1):a.result&&a.result.Customer&&1==a.searchType&&(f.IsSync=0,f.Customer.IsSync=0)):1!=a.searchType?f.IsSync=1:f.IsSync=0,console.log(f,"记账准备最终提交数据");var h={url:"/api/supplementaryinfo",data:f,method:"put"};a.loading=!0,b(h).success(function(b){b.status?(alert("操作成功！"),a.isModal?a.closeModal():d.go("^.orderList"),a.postData={}):a.postData.IsPromotion=!!a.postData.IsPromotion,a.loading=!1}).error(function(){a.loading=!1})};var v="https://pilipa.oss-cn-beijing.aliyuncs.com";b.get("/api/signkey").success(function(b){delete b.data.Filename,delete b.data.key,delete b.data.callback,delete b.data.expire,delete b.data.Host,a.signkey=b.data}),a.imgs=[],a.uploader1=new g({autoUpload:!0,url:v}),a.uploader1.onErrorItem=r,a.uploader1.onSuccessItem=function(b,c,d,e){a.imgs.push(v+"/"+b.key)},a.uploader1.onErrorItem=function(a,b,c,d){alert(a.file.name+"上传失败")},a.uploader1.onBeforeUploadItem=function(b){var c=q(b.file.name);b.formData.push({key:c}),_.each(a.signkey,function(a,c){var d={};d[c]=a,b.formData.push(d)}),b.key=c},a.uploader1.filters.push({name:"customFilter",fn:function(a,b){return!!/^.*\.(?:png|jpg|bmp|gif|jpeg)$/.test(a.name.toLowerCase())||(alert("请选择图片"),!1)}}),a.close=function(){d.go("^.orderList")}}]).controller("AddorderCompanyModal",["$scope","$http","$uibModalInstance",function(a,b,c){a.save=function(){b.get("/api/order/getcustomerupdatebygs?word="+a.httpWord).success(function(a){if(a.status){var b=a.data;c.close(b)}})},a.cancel=function(){c.dismiss("cancel")}}]).controller("SummitModal",["$scope","$http","$uibModalInstance","error","sign",function(a,b,c,d,e){a.sign=e,a.alertMsg=d,a.submit=function(){c.close(!0)},a.cancel=function(){c.dismiss("cancel")}}]),angular.module("channelApp").controller("OrderListCtrl",["$scope","$http","$filter","$state","$uibModal",function(a,b,c,d,e){function f(){return j.map(function(a){return a.header})}function g(a){return a.forEach(function(a){var b=[];j.forEach(function(c){if(c.col.indexOf(",")>0){var d=c.col.split(","),e=(c.formate?c.formate(a[d[0]]):a[d[0]])||"无",f=(c.formate?c.formate(a[d[1]]):a[d[1]])||"无";b.push(e+"<br/>"+f)}else{var g=(c.formate?c.formate(a[c.col]):a[c.col])||"无";b.push(g)}}),a.cols=b}),a}function h(){return{cusname:a.cusname,start:c("date")(a.startdate,"yyyy-MM-dd"),end:c("date")(a.enddate,"yyyy-MM-dd"),status:a.status,LegalPerson:a.LegalPerson,IsExpireRenew:a.isExpireRenew}}function i(c){c.IsExpireRenew?c.IsExpireRenew=1:c.IsExpireRenew=0;var c=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem,c);b.get("/api/orders/my?"+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.data=g(b.data)})}var j=[{header:"公司名称",col:"Name"},{header:"合同号",col:"ContractNO"},{header:"合同金额",col:"ContractAmount"},{header:"状态",col:"Status",formate:function(a){return{1:"未审核",2:"通过",3:"拒审"}[a]}},{header:"订单日期",col:"CreateDate",formate:function(a){return a.substr(0,10)}}];a.rightAlign=[2],a.headers=f(),a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.status=0,a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.pageChanged=function(){i(a.searchItem)},a.searchItem=h(),a.searchFn=function(){a.searchItem=h(),i(a.searchItem)},a.sdateOptions={formatYear:"yyyy"},a.edateOptions={formatYear:"yyyy"},a.setMinDate=function(){a.edateOptions.minDate=a.startdate},a.reset=function(){a.cusname="",a.startdate="",a.enddate="",a.status=0},a.searchFn(),a.modify=function(b){if(b.FreChangeOrderId){e.open({templateUrl:"views/change2.html",controller:"Change",size:"lg",windowClass:"add-order-modal-container",resolve:{orderId:function(){return b.OrderId},isModify:function(){return!0},isConchange:function(){return!1}}}).result.then(function(){a.searchFn()},function(){})}else d.go("^.addOrder",{orderId:b.OrderId})},a.delete=function(c){confirm("确认删除订单？")&&b({method:"delete",url:"/api/orders/"+c}).success(function(b){b.status&&(alert("删除成功！"),a.searchFn()),i()})},a.add=function(a,b){d.go("^.addOrder",{orderId:"C"+a+"&"+b})},a.isChecked=!1,a.IsExpireRenew=!1,a.consoleValue=function(b){a.isExpireRenew=0,a.isExpireRenew=b?1:0,a.searchFn()}}]),angular.module("channelApp").controller("UserCtrl",["$scope","$state","$uibModal","UserListService","OrganizeService",function(a,b,c,d,e){a.organizeTreeModel=[{DepartmentId:"0",DepartmentName:"全部",Description:"",ParentID:null,expanded:!0,childs:[]}],e.getDepart().then(function(b){a.organizeTreeModel[0].childs=b.data,a.selectedNodeChange(a.organizeTreeModel[0]),a.expandNodes=[a.organizeTreeModel[0]]}),a.organizeTreeOptions={nodeChildren:"childs",dirSelectable:!0},a.selectedNodeChange=function(c){a.selectedOrganizeTree=c,null!==c.DepartmentId&&(window.sessionStorage.setItem("DepartmentId",a.selectedOrganizeTree.DepartmentId),b.go("main.users.usersList"),a.$broadcast("organize.getUsersList"))},a.refreshUserList=function(){a.$broadcast("organize.getUsersList")},a.addOragnize=function(b){c.open({templateUrl:"views/addOrganize.html",controller:"AddOrganizeCtrl",resolve:{SelectedNode:function(){return"root"===b?null:a.selectedOrganizeTree}}}).result.then(function(b){b&&e.getDepart().then(function(b){a.organizeTreeModel=b.data})},function(){console.info("Modal dismissed at: "+new Date)})};var f=function(b,c){if(!angular.isArray(b))return b;angular.forEach(b,function(b,d){b.DepartmentId===c.DepartmentId?(b=angular.extend(b,c),a.selectedOrganizeTree=b):b.childs.length>0&&f(b.childs,c)})};a.updateOragnize=function(){if(null===a.selectedOrganizeTree.DepartmentId)return void alert("不允许修改！");c.open({templateUrl:"views/updateOrganize.html",controller:"UpdateOrganizeCtrl",resolve:{SelectedNode:function(){return a.selectedOrganizeTree}}}).result.then(function(b){f(a.organizeTreeModel,b)},function(){console.info("Modal dismissed at: "+new Date)})},a.delOragnize=function(){if(a.organizeTreeModel[0].childs.length<=1&&0===a.selectedOrganizeTree.ParentID||null===a.selectedOrganizeTree.DepartmentId)return void alert("不允许删除!");c.open({templateUrl:"views/delOrganize.html",controller:"DelOrganizeCtrl",resolve:{TreeModel:function(){return{treeModel:angular.copy(a.organizeTreeModel[0].childs),removedNode:a.selectedOrganizeTree}}}}).result.then(function(c){c&&e.getDepart().then(function(c){a.organizeTreeModel=c.data,a.selectedOrganizeTree=a.organizeTreeModel[0],b.go("main.users.usersList")})},function(){console.info("Modal dismissed at: "+new Date)})}}]),angular.module("channelApp").controller("UserListCtrl",["$scope","$state","$stateParams","UserListService",function(a,b,c,d){function e(){d.getUserList({method:"GET",DepartmentId:a.DepartmentId,params:{offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage,userName:a.paginator.userName}}).then(function(b){a.paginator.total=b.Count,a.userItmes=b.data})}function f(){return g.map(function(a){return a.header})}var g=[{header:"用户名",col:"UserName"},{header:"姓名",col:"RealName"},{header:"手机",col:"Mobile"},{header:"邮箱",col:"Email"},{header:"角色",col:"RoleName"},{header:"部门",col:"DepartmentName"}];a.headers=f(),a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.userItmes=[],a.pageChanged=function(){a.DepartmentId=window.sessionStorage.getItem("DepartmentId"),e()},a.DepartmentId&&a.pageChanged(),a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.$on("organize.getUsersList",function(b){a.pageChanged()}),a.addUser=function(){b.go("main.users.addUser")},a.update=function(c){b.go("main.users.updateUser",{user:angular.toJson(angular.extend(c,{DepartmentId:a.DepartmentId}))})},a.delUser=function(b){confirm("确认删除该员工吗?")&&d.delUser({UserId:b}).then(function(b){a.pageChanged()})}}]),angular.module("channelApp").controller("AddUserCtrl",["$scope","$stateParams","UserListService","$http",function(a,b,c,d){a.addParams={UserName:"",RealName:"",Email:"",Password:"",Mobile:"",RoleId:"",FunctionList:[],DepartmentId:window.sessionStorage.getItem("DepartmentId")},a.seletedParent=a.$parent.selectedOrganizeTree;var e=function(){a.centerModel=[{id:1,name:"中心"},{id:0,name:" 渠道"}],a.selectedCenter=a.centerModel[0],a.addParams.IsCenter=a.selectedCenter.id};a.functionTreeOptions={nodeChildren:"children",dirSelectable:!0,multiSelection:!0},a.selectedFunction=[],a.functionModel=[];var f=function(b){c.getFunctionByRole(b).then(function(b){a.functionModel=b})},g=function(){c.getDictionary("role").then(function(b){return a.rolesModel=b,a.selectedRole=a.rolesModel[0],a.addParams.RoleId=a.selectedRole.RoleId,a.addParams.RoleId}).then(function(a){f(a)})},h=function(){d.get("/api/channelpartition").success(function(b){a.fqs=b.data})};!function(){e(),g(),h()}();var i=function(a,b){if(angular.isArray(b)){var c=null,d=!1;b.forEach(function(b,d){b.children&&b.children.length>0&&b.children.forEach(function(d){d.FunctionId===a.FunctionId&&(c=b)})}),c.children.forEach(function(a){a.selectd&&(d=!0)}),c.selectd=d}};a.setSelectedTree=function(b){if(b.selectd=!b.selectd,!(b.children&&b.children.length>0))return void i(b,a.functionModel);b.children.forEach(function(b){a.setSelectedTree(b)})},a.setAddParams=function(b){switch(b){case"role":a.addParams.RoleId=a.selectedRole.RoleId,f(a.addParams.RoleId);break;case"center":a.addParams.IsCenter=a.selectedCenter.id}},a.interacted=function(b){if(b&&b.$dirty)return a.submitted||b.$dirty};var j=function(a){return a=a.filter(function(a,b){return a.selectd}),a.forEach(function(a){a.children&&a.children.length>0&&(a.children=a.children.filter(function(a,b){return a.selectd}))}),a};a.addUser=function(b){a.submitted=!0,a.loading||(a.addParams.FunctionList=angular.toJson(j(angular.copy(a.functionModel))),a.loading=!0,c.addUser(a.addParams).then(function(b){a.loading=!1,b.status&&alert("新增成功")}))}}]),angular.module("channelApp").controller("UpdateUserCtrl",["$scope","$stateParams","UserListService","OrganizeService","$http",function(a,b,c,d,e){var f=angular.fromJson(b.user);a.updateParams={UserId:f.UserId,UserName:f.UserName,RealName:f.RealName,Email:f.Email,Password:"",Mobile:f.Mobile,RoleId:f.RoleId,DepartmentId:f.DepartmentId,FunctionList:f.FunctionList?angular.fromJson(f.FunctionList):[],ChannelPartitionId:""+f.ChannelPartitionId};var g=function(){c.getDictionary("role").then(function(b){a.rolesModel=b,angular.forEach(a.rolesModel,function(b,c){b.RoleId==a.updateParams.RoleId&&(a.selectedRole=a.rolesModel[c])})})},h=function(){e.get("/api/channelpartition").success(function(b){a.fqs=b.data})},i=function(a,b){angular.forEach(a,function(a){angular.forEach(b,function(b,c){if(b.FunctionId===a.FunctionId){if(b.selectd=!0,!(a.children&&a.children.length>0))return;i(a.children,b.children)}})})},j=function(){a.functionTreeOptions={nodeChildren:"children",dirSelectable:!0,multiSelection:!0},a.selectedFunction=[],c.getFunction().then(function(b){a.functionModel=b;var c=f.FunctionList?angular.fromJson(f.FunctionList):[];i(c,a.functionModel)})};a.selectedOrganize={};var k=function(b,c){if(angular.isArray(c))for(var d=0,e=c.length;d<e;d++){if(c[d].DepartmentId==b)return void(a.selectedOrganize=c[d]);c[d].childs&&c[d].childs.length>0&&k(b,c[d].childs)}},l=function(){a.organizeTreeOptions={nodeChildren:"childs",dirSelectable:!0},a.organizeModel=[{DepartmentId:"0",DepartmentName:"全部",Description:"",ParentID:null,expanded:!0,childs:[]}],d.getDepart().then(function(b){a.organizeModel[0].childs=b.data,k(f.DepartmentId,a.organizeModel)})};!function(){g(),j(),l(),h()}();var m=function(a,b){if(angular.isArray(b)){var c=null,d=!1;b.forEach(function(b,d){b.children&&b.children.length>0&&b.children.forEach(function(d){d.FunctionId===a.FunctionId&&(c=b)})}),c.children.forEach(function(a){a.selectd&&(d=!0)}),c.selectd=d}};a.setSelectedTree=function(b){if(b.selectd=!b.selectd,!(b.children&&b.children.length>0))return void m(b,a.functionModel);b.children.forEach(function(b){a.setSelectedTree(b)})},a.setOrganize=function(b){a.selectedOrganize=b};var n=function(b){c.getFunctionByRole(b).then(function(b){a.functionModel=b})};a.setUpdateParams=function(b){switch(b){case"role":a.updateParams.RoleId=a.selectedRole.RoleId,n(a.updateParams.RoleId);break;case"center":a.updateParams.IsCenter=a.selectedCenter.id}},a.interacted=function(b){if(b&&b.$dirty)return a.submitted||b.$dirty};var o=function(a){return a=a.filter(function(a,b){return a.selectd}),a.forEach(function(a){a.children&&a.children.length>0&&(a.children=a.children.filter(function(a,b){return a.selectd}))}),a};a.updateUser=function(){a.submitted=!0,a.updateParams.FunctionList=angular.toJson(o(angular.copy(a.functionModel))),a.updateParams.DepartmentId=a.selectedOrganize.DepartmentId,a.updateParams.ChannelPartitionId=0,c.updateUser(a.updateParams).then(function(a){a.status&&alert("修改成功")})}}]),function(){angular.module("channelApp").controller("CustomerList",["$scope","$uibModal","CustomerService",function(a,b,c){function d(){var b=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem,b);c.getCustomers(b).success(function(b){a.paginator.total=b.Count,a.customers=b.data})}a.open=function(a){b.open({templateUrl:"views/addCustomers.html",controller:"AddCustomerCtrl",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){d()},function(){})},a.delete=function(a){c.delete(a.CustomerId)},a.track=function(a){b.open({templateUrl:"views/customer_track.html",controller:"CustomerTrack",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){d()},function(){d()})},a.forward=function(a){b.open({templateUrl:"views/customer_forword.html",controller:"CustomerForward",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){d()},function(){})},a.paginator={total:0,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.searchParams={limit:10,offset:0,start:"",end:"",status:0,cusname:"",cid:""},a.pageChanged=function(){d()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,d()},a.searchItem={companyName:"",mobile:"",CustomerTypeId:""},a.search=function(){a.searchItem.companyName=a.companyName,a.searchItem.mobile=a.mobile,a.searchItem.CustomerTypeId=a.cusType,d(a.searchItem)},d(),c.custype().success(function(b){a.ctypes=b.data})}]).controller("CustomerTrack",["$scope","$filter","$uibModalInstance","CustomerService","customer","user",function(a,b,c,d,e,f){
function g(){d.getTrack(e.CustomerId).success(function(b){a.tracks=b.data})}a.title=e.Name,a.user=f.get(),a.dateOptions={formatYear:"yyyy",maxDate:new Date},a.TrackDate=new Date,a.today=b("date")(a.TrackDate,"yyyy-MM-dd"),a.save=function(){if(a.content){a.TrackDate||alert("请选择跟踪日期！");var c={CustomerId:e.CustomerId,Description:a.content,TrackDate:b("date")(a.TrackDate,"yyyy-MM-dd")};d.saveTrack(c).success(function(){a.content="",g()})}},a.delete=function(a){confirm("确认要删除吗？")&&d.trackDelete(a.TrackId).success(function(){g()})},a.cancel=function(){c.dismiss("cancel")},g()}]).controller("CustomerForward",["$scope","$uibModalInstance","CustomerService","customer","user",function(a,b,c,d,e){var f=e.get(),g=a.vm={};g.model={},g.options={},g.fields=[{key:"SalesId",type:"select",templateOptions:{label:"销售人员",options:[],valueProp:"UserId",labelProp:"RealName"},controller:["$scope",function(a){a.to.loading=c.sales().success(function(b){for(var c=b.data,d=0;d<c.length;d++)c[d].UserId==f.UserId&&c.splice(d,1);return a.to.options=c,b.data})}]}],a.save=function(a){if(!g.model.SalesId)return void alert("请选择销售人员!");c.forward(d.CustomerId,g.model.SalesId).success(function(a){a.status&&b.close("cancel")})},a.cancel=function(){b.dismiss("cancel")}}])}(angular),function(){angular.module("channelApp").controller("AddCustomerCtrl",["$scope","$uibModalInstance","CustomerService","customer","user",function(a,b,c,d,e){var f=a.user=e.get(),g=a.vm={};g.model={},d&&(g.model={CustomerId:d.CustomerId,Name:d.Name,CityCode:d.CityCode,Address:d.Address,Industry:d.Industry,AddedValue:d.AddedValue,Contacts:d.Contacts,Mobile:d.Mobile,CustomerTypeId:d.CustomerTypeId,SalesId:d.SalesId}),g.options={},g.Category=f.Category,g.fields=[{key:"Name",type:"input",templateOptions:{label:"公司名称",required:!0}},{key:"CityCode",type:"select",templateOptions:{label:"城市",required:!0,options:[],valueProp:"CityCode",labelProp:"CityName"},controller:["$scope",function(a){a.to.loading=c.cities().success(function(b){return a.to.options=b.data,b.data})}]},{key:"Address",type:"input",templateOptions:{label:"公司地址"}},{key:"Industry",type:"select",templateOptions:{label:"公司行业",options:[],valueProp:"IndustryId",labelProp:"IndustryName"},controller:["$scope",function(a){a.to.loading=c.industry().success(function(b){return a.to.options=b.data,b.data})}]},{key:"AddedValue",type:"select",templateOptions:{label:"公司性质",options:[{name:"小规模",value:1},{name:"一般纳税人",value:2}]}},{key:"Contacts",type:"input",templateOptions:{label:"联系人",required:!0}},{key:"Mobile",type:"input",templateOptions:{label:"电话",required:!0,maxlength:11}},{key:"CustomerTypeId",type:"select",templateOptions:{label:"客户类型",options:[],valueProp:"CustomerTypeId",labelProp:"Name",required:!0},controller:["$scope",function(a){a.to.loading=c.custype().success(function(b){return a.to.options=b.data,b.data})}],watcher:{expression:"model.CustomerTypeId",listener:function(a,b,c){5==b&&(g.model.SalesId="")}}}],a.save=function(){if(a.vm.form.$invalid)return void alert("请检查输入项目!");5===g.model.CustomerTypeId&&(g.model.SalesId=""),c.save(g.model).success(function(a){a.status&&b.close("cancel")})},a.cancel=function(){b.dismiss("cancel")}}])}(angular),function(){angular.module("channelApp").controller("CustomerPubList",["$scope","$uibModal","CustomerService","user","showDetails","FileUploader","$timeout",function(a,b,c,d,e,f,g){function h(){var b=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem,b);c.getCustomer_pub(b).success(function(b){a.paginator.total=b.Count,a.customers=b.data})}a.user=d.get(),a.open=function(a){b.open({templateUrl:"views/addCustomers.html",controller:"CustomerAddPubCtrl",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){h()},function(){})},a.rob=function(a){b.open({templateUrl:"views/customer_rob.html",controller:"CustomerRob",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){h()},function(){h()})},a.delete=function(a){confirm("你确认要删除该客户？")&&c.delete(a.CustomerId).success(function(){h()})},a.paginator={total:0,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.pageChanged=function(){h()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,h()},a.searchItem={companyName:"",mobile:"",HisCusTypeId:0},a.search={companyName:"",mobile:"",cusType:0},a.track=function(a){b.open({templateUrl:"views/customer_track.html",controller:"CustomerTrack",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){h()},function(){h()})},a.searchFn=function(){a.searchItem.companyName=a.search.companyName,a.searchItem.mobile=a.search.mobile,a.searchItem.HisCusTypeId=a.search.cusType,h(a.searchItem)},a.uploader=new f({url:"/api/excelfiles",autoUpload:!0}),a.uploader.onCompleteItem=function(a,b,c,d){if(b.hasError)return void alert(b.message);g(function(){e(b.data.length>0?b.join("<br/>"):"全部导入成功！"),h()},500)},h(),c.custype().success(function(b){a.ctypes=b.data})}]).controller("CustomerRob",["$scope","$uibModalInstance","CustomerService","customer",function(a,b,c,d){var e=a.vm={};e.model={},e.options={},e.fields=[{key:"CustomerTypeId",type:"select",templateOptions:{label:"客户类型",options:[],valueProp:"CustomerTypeId",labelProp:"Name"},controller:["$scope",function(a){a.to.loading=c.custype().success(function(b){return b.data.pop(),a.to.options=b.data,b.data})}],defaultValue:4}],a.save=function(a){c.rob(d.CustomerId,e.model.CustomerTypeId).success(function(a){a.status,b.close("cancel")})},a.cancel=function(){b.dismiss("cancel")}}]).controller("CustomerAddPubCtrl",["$scope","$uibModalInstance","CustomerService","customer",function(a,b,c,d){var e=a.vm={};e.model={},d&&(e.model={CustomerId:d.CustomerId,Name:d.Name,CityCode:d.CityCode,Address:d.Address,Industry:d.Industry,AddedValue:d.AddedValue,Contacts:d.Contacts,Mobile:d.Mobile}),e.options={},e.fields=[{key:"Name",type:"input",templateOptions:{label:"公司名称",required:!0}},{key:"CityCode",type:"select",templateOptions:{label:"城市",required:!0,options:[],valueProp:"CityCode",labelProp:"CityName"},controller:["$scope",function(a){a.to.loading=c.cities().success(function(b){return a.to.options=b.data,b.data})}]},{key:"Address",type:"input",templateOptions:{label:"公司地址"}},{key:"Industry",type:"select",templateOptions:{label:"公司行业",options:[],valueProp:"IndustryId",labelProp:"IndustryName"},controller:["$scope",function(a){a.to.loading=c.industry().success(function(b){return a.to.options=b.data,b.data})}]},{key:"AddedValue",type:"select",templateOptions:{label:"公司性质",options:[{name:"小规模",value:1},{name:"一般纳税人",value:2}]}},{key:"Contacts",type:"input",templateOptions:{label:"联系人",required:!0}},{key:"Mobile",type:"input",templateOptions:{label:"电话",required:!0}}],a.save=function(){if(a.vm.form.$invalid)return void alert("请输入必填项!");e.model.CustomerTypeId=5,c.save(e.model).success(function(a){a.status&&b.close("cancel")})},a.cancel=function(){b.dismiss("cancel")}}])}(angular),function(){angular.module("channelApp").controller("CustomerSetting",["$scope","$uibModalInstance","CustomerService","channel",function(a,b,c,d){c.getSettings(d.ChannelId).success(function(b){a.settings=b.data}),a.save=function(){c.saveSettings(a.settings).success(function(){alert("保存成功！"),b.close()})},a.cancel=function(){b.close()}}])}(angular),function(){angular.module("channelApp").controller("CustomerTotal",["$scope","CustomerService","$uibModal",function(a,b,c){b.getCustomer_total().success(function(b){a.customers=b.data;var c=0,d=0,e=0,f=0,g=0;_.each(b.data,function(a){c+=a.AType,d+=a.BType,e+=a.CType,f+=a.DType,g+=a.BillType}),a.aAType=c,a.aBType=d,a.aCType=e,a.aDType=f,a.aBillType=g}),a.viewDetail=function(a,b){c.open({templateUrl:"views/customers_modal.html",controller:"customersModal",size:"lg",resolve:{params:function(){return{UserId:a,Type:b}}},backdrop:"static"}).result.then(function(a){refreshData()},function(){})}}]).controller("customersModal",["$scope","CustomerService","$uibModalInstance","params","$uibModal",function(a,b,c,d,e){function f(){var c=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage,custype:d.Type,userid:d.UserId},a.searchItem,c);b.getCustomersByDetail(c).success(function(b){a.paginator.total=b.Count,a.customers=b.data})}a.cancel=function(){c.dismiss("cancel")},a.ok=function(){c.close("")},a.open=function(a){e.open({templateUrl:"views/addCustomers.html",controller:"AddCustomerCtrl",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){f()},function(){})},a.track=function(a){e.open({templateUrl:"views/customer_track.html",controller:"CustomerTrack",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){f()},function(){f()})},a.forward=function(a){e.open({templateUrl:"views/customer_forword.html",controller:"CustomerForward",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){f()},function(){})},a.paginator={total:0,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.searchParams={limit:10,offset:0,start:"",end:"",status:0,cusname:"",cid:""},a.pageChanged=function(){f()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,f()},f()}])}(angular),function(){angular.module("channelApp").controller("CustomerTotalToC",["$scope","$http","Excel","$timeout",function(a,b,c,d){a.search1={starttime:"",endtime:""},a.search2={starttime:"",endtime:""},a.tab1Search=function(){var c=_.extend({limit:9999,offset:0},a.search1);_.isDate(c.starttime)&&(c.starttime=c.starttime.toISOString()),_.isDate(c.endtime)&&(c.endtime=c.endtime.toISOString()),b.get("/api/newcustomer?"+$.param(c)).success(function(b){a.total1=b.data.Total[0],a.data1=b.data.DataInfo})},a.tab2Search=function(){var c=_.extend({limit:9999,offset:0},a.search2);_.isDate(c.starttime)&&(c.starttime=c.starttime.toISOString()),_.isDate(c.endtime)&&(c.endtime=c.endtime.toISOString()),b.get("/api/dataanalysis/notrenewstatistics?"+$.param(c)).success(function(b){a.total2=b.data.Total[0],a.data2=b.data.DataInfo})},a.tab1Search(),a.tab2Search(),a.export=function(){var b=_.isDate(a.search2.starttime)?a.search2.starttime.toISOString():a.search2.starttime,c=_.isDate(a.search2.endtime)?a.search2.endtime.toISOString():a.search2.endtime;window.open("/api/download/notrenewdetail?starttime="+b+"&endtime="+c+"&ccodes=&channelname=")},a.dataExport1=function(){var a=c.tableToExcel("#table1","新增客户统计");d(function(){window.open(a)},100)},a.dataExport2=function(){var a=c.tableToExcel("#table2","到期未续费客户统计");d(function(){window.open(a)},100)}}])}(angular),angular.module("channelApp").factory("UserListService",["$http","$q",function(a,b){function c(c){var d=b.defer();return c=angular.extend(c,{url:k+"/"+c.DepartmentId}),a(c).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function d(c){var d=b.defer();return a({url:k,method:"POST",data:c}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function e(c){var d=b.defer(),e={url:k+"/"+c.UserId,method:"PUT",data:c};return a(e).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function f(c){var d=b.defer();return a({url:k+"/"+c.UserId,method:"DELETE"}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function g(c){var d=b.defer();return a({url:k+"/exist/"+c.name}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function h(c){var d=b.defer();return window.sessionStorage&&angular.isString(window.sessionStorage.getItem(c))?d.resolve(angular.fromJson(window.sessionStorage.getItem(c))):a({url:"/api/code/"+c}).success(function(a,b,e,f){angular.isArray(a.data)?(window.sessionStorage.setItem(c,angular.toJson(a.data)),d.resolve(a.data)):d.resolve([])}).error(function(a,b,c,e){d.reject()}),d.promise}function i(){var c=b.defer();return window.sessionStorage&&angular.isString(window.sessionStorage.getItem("Function"))?c.resolve(angular.fromJson(window.sessionStorage.getItem("Function"))):a({url:"api/account/function"}).success(function(a,b,d,e){angular.isArray(a.data)?(window.sessionStorage.setItem("Function",angular.toJson(a.data)),c.resolve(a.data)):c.resolve([])}).error(function(a,b,d,e){c.reject()}),c.promise}function j(c){var d=b.defer();return a({url:"api/function/"+c,method:"GET"}).success(function(a,b,c,e){angular.isArray(a.data)?(window.sessionStorage.setItem("Function",angular.toJson(a.data)),d.resolve(a.data)):d.resolve([])}).error(function(a,b,c,e){d.reject()}),d.promise}var k="/api/account";return{getUserList:c,addUser:d,updateUser:e,delUser:f,checkExist:g,getDictionary:h,getFunction:i,getFunctionByRole:j}}]),angular.module("channelApp").controller("AddOrganizeCtrl",["$scope","$uibModalInstance","SelectedNode","OrganizeService",function(a,b,c,d){a.addParams={DepartmentId:0,DepartmentName:"",Description:"",ParentID:c?c.DepartmentId:0},a.interacted=function(b){return a.submitted||b.$dirty},a.addOragnize=function(){a.submitted=!0,a.loading||(a.loading=!0,d.addOrganize(a.addParams).then(function(a){b.close(!0)}))},a.dismiss=function(){b.dismiss()}}]),angular.module("channelApp").controller("UpdateOrganizeCtrl",["$scope","$uibModalInstance","SelectedNode","OrganizeService",function(a,b,c,d){a.updateParams=angular.copy(c),a.interacted=function(b){return a.submitted||b.$dirty},a.updateOragnize=function(){a.submitted=!0,d.addOrganize(a.updateParams).then(function(c){b.close(a.updateParams)})},a.dismiss=function(){b.dismiss()}}]),angular.module("channelApp").controller("DelOrganizeCtrl",["$scope","$uibModalInstance","TreeModel","OrganizeService",function(a,b,c,d){var e=function(a,b){if(angular.isArray(a))return angular.forEach(a,function(c,d){c.DepartmentId===b.DepartmentId?a.splice(d,1):c.childs.length>0&&e(c.childs,b)}),a};a.treeModel=e(c.treeModel,c.removedNode),a.selectedNode=a.treeModel[0],a.removedNode=c.removedNode,a.treeOptions={nodeChildren:"childs",dirSelectable:!0},a.selectedNodeChange=function(b){a.selectedNode=b},a.dismiss=function(){b.dismiss()},a.delOragnize=function(){d.delOrganize({delId:a.removedNode.DepartmentId,newId:a.selectedNode?a.selectedNode.DepartmentId:""}).then(function(a){b.close(!0)})}}]),angular.module("channelApp").factory("OrganizeService",["$http","$q",function(a,b){function c(){var c=b.defer();return a({url:g+"/departments"}).success(function(a,b,d,e){c.resolve(a)}).error(function(a,b,d,e){c.reject()}),c.promise}function d(c){var d=b.defer();return a({url:g+"/departments",method:"POST",data:c}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function e(c){var d=b.defer();return a({url:g+"/departments",method:"POST",data:c}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function f(c){var d=b.defer(),e={url:g+"/departments/"+c.delId+"/"+c.newId,method:"DELETE"};return a(e).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}var g="/api";return{getDepart:c,addOrganize:d,updateOrganize:e,delOrganize:f}}]),angular.module("channelApp").controller("OrderSearchCtrl",["$scope","$http","$filter","$state","user","OrderSearchService","$uibModal",function(a,b,c,d,e,f,g){a.user=e.get(),a.datepickerConfig={options:{formatYear:"yy",maxDate:new Date(2020,5,22),minDate:new Date,startingDay:1},clearText:"清空",currentText:"今天",closeText:"关闭",startFlag:!1,endFlag:!1},a.showDatepicker=function(b){switch(b){case"start":a.datepickerConfig.startFlag=!0;break;case"end":a.datepickerConfig.endFlag=!0}},a.reback=function(c){b.put("/api/orderauditback?orderid="+c).success(function(b){b.status&&a.pageChanged()})},a.guaqi=function(a){g.open({templateUrl:"views/invoiceReject.html",controller:["$scope","$http","$filter","$uibModalInstance",function(b,c,d,e){b.invoice={},b.title="订单挂起",b.cancel=function(){e.dismiss("")},b.ok=function(){if(!b.loading){var d={CompanyId:a.CustomerId,ChannelId:a.ChannelId,Description:b.invoice.AuditMsg};c.put("/api/toagent/hangupcustomer",d).success(function(a){a.status&&(alert("挂起成功!"),e.close())})}}}]}).result.then(function(){})},function(){a.statusModel=[{name:"全部",status:0},{name:"未审核",status:1},{name:"通过",status:2},{name:"拒审",status:3}],a.selectedStatus=a.statusModel[0]}();var h=function(){f.getAgent().then(function(b){b.data.unshift({ChannelName:"全部",ChannelId:""}),a.agentModel=b.data,a.selectedAgent=a.agentModel[0],a.pageChanged()})};1==a.user.IsCenter&&h(),a.paginator={total:0,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.searchParams={limit:10,offset:0,start:"",end:"",status:0,cusname:"",cid:""},a.orderModel=[],a.category="0",a.pageChanged=function(){if(a.searchParams=angular.extend(a.searchParams,{limit:a.paginator.perPage,offset:(a.paginator.currentPage-1)*a.paginator.perPage,start:c("date")(a.start,"yyyy-MM-dd"),end:c("date")(a.end,"yyyy-MM-dd"),status:a.selectedStatus.status,Category:a.category,LegalPerson:a.LegalPerson}),1==a.user.IsCenter){if(a.channel&&!a.channel.ChannelId)return void alert("请选择代理商!");a.channel&&(a.searchParams.cid=a.channel.ChannelId)}else delete a.searchParams.cid;f.getOrder(a.searchParams).then(function(b){a.orderModel=b.data,a.paginator.total=b.Count})},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.view=function(a){g.open({templateUrl:"views/addOrder.html",controller:["$scope","$uibModalInstance",function(b,c){b.readonly=!0,b.orderId=a,b.showClose=!0,b.close=function(){c.dismiss("")}}],size:"lg"})},a.modify=function(b){var c=b.OrderId;if(b.FreChangeOrderId){g.open({templateUrl:"views/change.html",controller:"Change",size:"lg",resolve:{orderId:function(){return b.OrderId},isModify:function(){return!0}}})}else{g.open({templateUrl:"views/addOrder.html",controller:["$scope","$uibModalInstance",function(a,b){a.orderId=c,a.showClose=!0,a.isModal=!0,a.close=function(){b.dismiss("")},a.closeModal=function(){b.close("")}}],size:"lg"}).result.then(function(){a.pageChanged()})}},a.delete=function(c){confirm("确认删除订单？")&&b({method:"delete",url:"/api/orders/"+c}).success(function(b){b.status&&(alert("删除成功！"),a.pageChanged()),a.pageChanged()})}}]),angular.module("channelApp").factory("OrderSearchService",["$http","$q","PyCapital",function(a,b,c){function d(c){var d=b.defer();return window.sessionStorage&&angular.isString(window.sessionStorage.getItem(c))?d.resolve(angular.fromJson(window.sessionStorage.getItem(c))):a({url:"/api/code/"+c}).success(function(a,b,e,f){angular.isArray(a.data)?(window.sessionStorage.setItem(c,angular.toJson(a.data)),d.resolve(a.data)):d.resolve([])}).error(function(a,b,c,e){d.reject()}),d.promise}function e(c){var d=b.defer();return a({url:"/api/orders/agent",method:"GET",params:c}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function f(){var d=b.defer();return a({url:"/api/agent/dict",method:"GET"}).success(function(a,b,e,f){a.data=_.map(a.data,function(a){return a.py=c.getCaptial(a.ChannelName),a}),d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}return{getArea:d,getOrder:e,getAgent:f}}]),angular.module("channelApp").factory("ossUploader",["$http","$filter",function(a,b){function c(a,c){var d=function(a){var b="",c=a.lastIndexOf(".");return-1!=c&&(b=a.substring(c)),b},f=function(a){a=a||32;for(var b="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",c=b.length,d="",e=0;e<a;e++)d+=b.charAt(Math.floor(Math.random()*c));return d},g=d(c),h=b("date")(new Date,"yyyyMM");return e[a]+h+"/"+f(10)+g}var d="https://pilipa.oss-cn-beijing.aliyuncs.com",e={1:"FileUploads/Order/CardID/",2:"FileUploads/Order/BusinessLicense/",3:"FileUploads/Order/Contract/",4:"FileUploads/Agent/"},f={};return a.get("/api/signkey").success(function(a){delete a.data.Filename,delete a.data.key,delete a.data.callback,delete a.data.expire,delete a.data.Host,f=a.data}),function(b){var e=new FormData,g=c(1,b.name),h=d+"/"+g;return e.append("key",g),_.each(f,function(a,b){e.append(b,a)}),e.append("file",b),a({url:d,method:"post",data:e,headers:{"Content-Type":void 0}}).then(function(a){return a.sourceUrl=h,a})}}]),angular.module("channelApp").directive("buGroup",function(){return{restrict:"A",scope:{title:"@buGroup"},replace:!0,transclude:!0,link:function(a,b,c,d){a.toggleMsg="隐藏",a.toggle=function(){a.isHide=!a.isHide,a.isHide?a.toggleMsg="显示":a.toggleMsg="隐藏"}},templateUrl:"views/buGroup.html"}}),angular.module("channelApp").directive("compareTo",function(){return{require:"ngModel",scope:{otherModelValue:"=compareTo"},link:function(a,b,c,d){d.$validators.compareTo=function(b){return b==a.otherModelValue},a.$watch("otherModelValue",function(){d.$validate()})}}}),angular.module("channelApp").directive("acSelect",["$http","$compile","$timeout",function(a,b,c){return{restrict:"A",scope:{settings:"=acSelect",item:"=acModel"},require:"ngModel",link:function(c,d,e,f){function g(){a.get(c.options.url+i).success(function(a){c.fullData=angular.copy(a.data),h(a.data)})}function h(a){if(c.data=a,a.length){c.item[c.settings.realCol]||(c.options.hasDefault?(c.item[c.settings.realCol]=""+a[0][c.options.id],c.settings.col!=c.settings.realCol&&(c.item[c.settings.col]=a[0][c.options.label])):c.item[c.settings.realCol]="null");var e=angular.element('<option ng-repeat="option in data"  value="{{::option[options.id]}}"  ng-bind="option[options.label]"></option>');e=b(e)(c),d.empty(),d.append(e)}}c.options=c.settings.options;var i="";c.options.watchField?(c.$watch("item."+c.options.watchField,function(a,b){a&&(i=c.options.paramStr.replace("{val}",c.item[c.options.watchField]),c.item[c.settings.realCol]="",g())}),c.item&&c.item[c.options.watchField]&&(i=c.options.paramStr.replace("{val}",c.item[c.options.watchField]),g())):g(),d.change(function(){var a=c.settings,b=a.options,d=c.data.find(function(d){return c.item[a.realCol]==d[b.id]});d&&a.col!=a.realCol&&(c.item[a.col]=d[b.label]),f.$setViewValue(d[b.id])})}}}]),angular.module("channelApp").directive("jsHeight",["$http","$compile","$timeout",function(a,b,c){return{restrict:"A",link:function(a,b,c,d){var e=b.parents(".content-right"),f=b.offset(),g=e.offset(),h=f.top-g.top,i=c.jsHeight||0;b.height(e.height()-h-i)}}}]),angular.module("channelApp").directive("picView",["$uibModal",function(a){return{restrict:"A",replace:!0,link:function(a,b,c,d){var e=c.ngSrc;a.src=e,a.attitional=c.additional||"?x-oss-process=image/resize,m_lfit,h_75,w_100",b.find("img").viewer({navbar:!1,title:!1,url:"url",built:function(){var a=$(this).next(),b=this;a.find(".viewer-canvas").on("click",function(a){"IMG"!==a.target.tagName.toUpperCase()&&$(b).viewer("hide")}),$("body").append(a)}}),a.$watch(function(){return c.ngSrc},function(b,c){b!==c&&(a.src=b)})},template:'<div class="picView img-thumbnail"><img src="{{src+attitional}}" url="{{src}}" alt=""></div>'}}]).directive("picDelete",["$parse",function(a){return{restrict:"A",replace:!0,link:function(b,c,d,e){c.append('<span class="close">&times;</span>'),c.on("click",".close",function(){a(d.picDelete)(b.$parent),b.$parent.$digest()})}}}]),angular.module("channelApp").directive("customRadio",function(){return{scope:{options:"="},restrict:"AE",require:"?ngModel",replace:!0,controller:["$scope",function(a){console.log(a,"xxx"),a.value=""}],link:function(a,b,c,d){d&&(d.$render=function(){a.disabled=b.attr("disabled"),a.value=d.$viewValue},a.toClick=function(c){b.attr("disabled")||(d.$setViewValue(c),a.value=c)})},template:'<div style="outline:none"><div ng-repeat="item in options" ng-class="{\'custom-check\': true, checked: value.id == item.id, \'custom-disabled\': disabled}" ng-click="toClick(item)"><i class="fa fa-check" aria-hidden="true"></i>{{item.title}}</div></div>'}}),angular.module("channelApp").directive("customFileUploader",function(){return{restrict:"AE",scope:{title:"@",uploader:"="},require:"?ngModel",link:function(a,b,c,d){if(console.log(a),!d)throw new Error("not set the model");b.find("input[type=file]").on("change",function(){var c=b.find("input[type=file]")[0].files[0];if(c){if(c.size>3145728)return void alert("图片大小超过3M!");if(/^(?!image)./.test(c.type))return void alert("上传格式不正确！");b.find(".upload-area").append('<div class="upload-shadow"></div><i class="fa fa-spinner fa-pulse" aria-hidden="true"></i>');window.URL.createObjectURL(c);a.uploader(c).then(function(a){console.log(a),200==a.status?(console.log(a.config.data instanceof FormData),b.find(".upload-area .upload-shadow, .upload-area i").remove(),e(a.sourceUrl),d.$setViewValue(a.sourceUrl)):alert("上传失败")},function(){alert("上传失败")})}}),d.$render=function(){a.disabled=b.attr("disabled"),d.$viewValue?e(d.$viewValue):(b.find("input[type=file]")[0].value="",b.find(".upload-area img").remove(),b.find(".upload-area span").hide())},b.find(".upload-area").click(function(a){b.attr("disabled")||(d&&d.$viewValue?"SPAN"==a.target.tagName.toUpperCase()&&b.find("input[type=file]").trigger("click"):b.find("input[type=file]").trigger("click"))}),b.hover(function(){b.attr("disabled")||(d.$viewValue?(b.find(".upload-area span").show(),b.find(".upload-area span").removeClass().addClass("enter")):b.find(".upload-area").append('<div class="upload-shadow"></div><i class="fa fa-cloud-upload" aria-hidden="true"></i>'))},function(){b.find(".upload-area i, .upload-area .upload-shadow").remove(),d.$viewValue&&b.find(".upload-area span").removeClass().addClass("leave")});var e=function(a){b.find(".upload-area img")[0]?b.find(".upload-area img").prop("src",a):b.find(".upload-area").append('<img src="'+a+'"  />'),b.find(".upload-area img").viewer({navbar:!1,title:!1,url:"url",built:function(){var a=$(this).next(),b=this;a.find(".viewer-canvas").on("click",function(a){"IMG"!==a.target.tagName.toUpperCase()&&$(b).viewer("hide")}),$("body").append(a)}})}},replace:!0,template:'<div class="img-upload-container"><input type="file" style="display: none;"/><div class="upload-area"><span>重新上传</span></div><p><span class="required"></span>{{title}}</p></div>'}}),angular.module("channelApp").controller("BalanceCtrl",["$scope","$http","$filter","$uibModal",function(a,b,c,d){function e(){a.paginator.currentPage=1,a.paginator.perPage=10}function f(){j.start=c("date")(a.searchParams.startTime,"yyyy-MM-dd"),j.end=c("date")(a.searchParams.endTime,"yyyy-MM-dd")}function g(){var c={offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage,start:j.start,end:j.end};b.get(i+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.data=h(b.data)})}function h(a){var b={2:"正常充值",1:"支付订单",3:"退单回充",4:"返点",5:"一代提成",6:"二代提单,扣减一代提成",7:"中心充值"};return a.forEach(function(a){var c=[];a.BillTime=a.BillTime.replace("T"," "),a.CategoryStr=b[a.Category],a.cols=c}),a}a.searchParams={startTime:"",endTime:""},a.datepickerConfig={options:{formatYear:"yy",maxDate:new Date(2020,5,22),minDate:new Date,startingDay:1},clearText:"清空",currentText:"今天",closeText:"关闭",startFlag:!1,endFlag:!1},a.showDatepicker=function(b){switch(b){case"start":a.datepickerConfig.startFlag=!0;break;case"end":a.datepickerConfig.endFlag=!0}},a.paginator={total:1,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.pageChanged=function(){g()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},b.get("/api/finance/balance").success(function(b){a.balance=b.data}),a.rightAlign=[1,2];var i,j={};a.showDetail=function(b){a.curType!==b&&(a.curType=b,i="/api/finance/agent/details?type="+b+"&",e(),g())},a.search=function(){e(),f(),g()},a.showDetail(0),g(),a.msgAlert=function(){d.open({templateUrl:"views/summit_modal.html",size:"md",controller:"SummitModal",resolve:{error:function(){return"该订单已退单"},sign:function(){return!0}}}).result.then(function(a){},function(){})}}]),angular.module("channelApp").controller("AchieveCtrl",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(){if(!a.cities)return"全部";var b=a.cities,c=_.filter(b,{selected:!0});return c.length<3?_.map(c,"Name").join(","):c.length===b.length?"全部":_.map(_.slice(c,0,2),"Name").join(",")+"等"}function h(b){a.params.selectedText=g()}function i(b){void 0!==b&&_.each(a.cities,function(a){a.selected=b})}function j(b){var c=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0;return angular.forEach(b,function(a){a.cols=[],a.cols.push(a.ProvinceName),a.cols.push(a.CityName),a.cols.push(a.ChannelName1),a.cols.push(a.ChannelName2),a.cols.push(a.YSSmall),a.cols.push(a.YSGeneral),a.cols.push(a.YSHJ),a.cols.push(a.SSSmall),a.cols.push(a.SSGeneral),a.cols.push(a.SSHJ),a.cols.push(a.OrderNumSmall),a.cols.push(a.OrderNumGeneral),a.cols.push(a.OrderNumHJ),c+=+a.YSSmall,d+=+a.YSGeneral,e+=+a.YSHJ,f+=+a.SSSmall,g+=+a.SSGeneral,h+=+a.SSHJ,i+=+a.OrderNumSmall,j+=+a.OrderNumGeneral,k+=+a.OrderNumHJ}),a.aYSSmall=c,a.aYSGeneral=d,a.aYSHJ=e,a.aSSSmall=f,a.aSSGeneral=g,a.aSSHJ=h,a.aOrderNumSmall=i,a.aOrderNumGeneral=j,a.aOrderNumHJ=k,b}a.isCenter=d.get().IsCenter,a.isCenter&&b.get("/api/code/city").success(function(b){_.each(b.data,function(a){a.selected=!0}),a.cities=b.data}),a.params={startdate:"",enddate:"",cityCode:"",provinceCode:"",getSelectedText:g,selectedAll:i,setSelectedText:h,selectedText:"全部"},a.search=function(){a.startdate&&(a.params.startdate=c("date")(a.startdate,"yyyy-MM-dd")),a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),b.get("/api/agentsreports?offset=0&limit=10&"+jQuery.param(a.params)).success(function(b){var c,d=_.filter(a.cities,{selected:!0});c=a.cities&&d.length!==a.cities.length?_.filter(b.data,function(b){var c=_.find(a.cities,{Code:b.CityCode});return c&&c.selected}):b.data,a.rows=j(c)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate},a.rightAlign=[4,5,6,7,8,9,10,11,12],a.toExcel=function(){a.exportHref=e.tableToExcel("div[js-height]>#dataTable","sheet name"),f(function(){location.href=a.exportHref},100)}}]),angular.module("channelApp").controller("RechargeCtrl",["$scope","$http","$uibModal",function(a,b,c){function d(){var c={offset:a.paginator.perPage*(a.paginator.currentPage-1),limit:a.paginator.perPage};b.get("/api/agent?"+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.data=f(b.data)})}function e(){return g.map(function(a){return a.header})}function f(a){return a.forEach(function(a){var b=[];g.forEach(function(c){if(c.col.indexOf(",")>0){var d=c.col.split(",");b.push((a[d[0]]||"")+"<br/>"+(a[d[1]]||""))}else b.push(a[c.col])}),a.cols=b}),a}var g=[{header:"省",col:"ProvinceName"},{header:"市",col:"CityName"},{header:"代理商",col:"ChannelName1"},{header:"二级代理商",col:"ChannelName2"},{header:"地址",col:"Address"},{header:"联系方式",col:"Tel,Mobile"},{header:"余额",col:"Balance"}];a.rightAlign=[6],a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.pageChanged=function(){d()},d(),a.headers=e(),a.addMoney=function(a){c.open({templateUrl:"views/addMoney.html",controller:"addMoneyCtrl",resolve:{channel:function(){return a}}}).result.then(function(a){d()},function(){})},a.addMoneyDetail=function(a){c.open({templateUrl:"views/addMoneyDetail.html",controller:"addMoneyDetailCtrl",size:"lg",resolve:{channelId:function(){return a}}}).result.then(function(a){d()},function(){})},a.payDetail=function(a){c.open({templateUrl:"views/payDetail.html",controller:"payDetailCtrl",size:"lg",resolve:{channelId:function(){return a}}}).result.then(function(a){d()},function(){})},a.setDiscount=function(a){c.open({templateUrl:"views/setDiscount.html",controller:["$scope","$uibModalInstance",function(b,c){b.discount=a.Discount,b.cancel=function(){c.dismiss("cancel")},b.ok=function(){var a=+b.discount;if(!(a>0&&a<10))return void alert("请输入合理的折扣值");c.close(b.discount)}}]}).result.then(function(c){
b.put("/api/agent/"+a.ChannelId+"/discount",{Discount:c}).success(function(){a.Discount=c})},function(){})},a.modify=function(a){c.open({templateUrl:"views/agent.html",controller:"agentCtrl",size:"lg",resolve:{agent:function(){return a}}}).result.then(function(a){d()},function(){})},a.remove=function(a){confirm("确认删除?")&&b.delete("/api/agent/"+a).success(function(){d()})}}]).controller("addMoneyCtrl",["$scope","$http","$uibModalInstance","channel",function(a,b,c,d){a.channel=d,a.cancel=function(){c.dismiss("cancel")},a.ok=function(){if(!a.money)return void alert("请输入充值金额!");var e="您确认为“"+d.ChannelName1;d.ChannelName2&&(e+=" > ",d.ChannelName2),e=e+'" 充值 '+a.money+" 元？",confirm(e)&&b.post("/api/finance",{ChannelId:d.ChannelId,Amount:a.money}).success(function(){c.close("")})}}]).controller("addMoneyDetailCtrl",["$scope","$http","$uibModalInstance","channelId",function(a,b,c,d){function e(){return h.map(function(a){return a.header})}function f(a){return a.forEach(function(a){var b=[];a.BillTime=a.BillTime.replace("T"," "),h.forEach(function(c){b.push(a[c.col])}),a.cols=b}),a}function g(){var c={type:2,channelId:d,limit:a.paginator.perPage,offset:(a.paginator.currentPage-1)*a.paginator.perPage};b.get("api/finance/detail?"+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.data=f(b.data)})}var h=[{header:"账单编号",col:"BillId"},{header:"充值金额",col:"Amount"},{header:"余额",col:"Balance"},{header:"备注",col:"Description"},{header:"订单时间",col:"BillTime"}];a.rightAlign=[1,2],a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.pageChanged=function(){g()},a.headers=e(),a.cancel=function(){c.dismiss("cancel")},a.ok=function(){c.close("")},a.status=0,a.pageChanged=function(){g()},g()}]).controller("payDetailCtrl",["$scope","$http","$uibModal","$uibModalInstance","channelId",function(a,b,c,d,e){function f(){return i.map(function(a){return a.header})}function g(a){return a.forEach(function(a){var b=[];a.BillTime=a.BillTime.replace("T"," "),i.forEach(function(c){b.push(a[c.col])}),a.cols=b}),a}function h(){var c={type:1,channelId:e,limit:a.paginator.perPage,offset:(a.paginator.currentPage-1)*a.paginator.perPage};b.get("api/finance/detail?"+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.data=g(b.data)})}var i=[{header:"订单编号",col:"OrderId"},{header:"订单金额",col:"Amount"},{header:"余额",col:"Balance"},{header:"备注",col:"Description"},{header:"订单时间",col:"BillTime"}];a.rightAlign=[1,2],a.headers=f(),a.cancel=function(){d.dismiss("cancel")},a.ok=function(){d.close("")},a.status=0,a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.pageChanged=function(){h()},a.view=function(a){c.open({templateUrl:"views/addOrder.html",controller:["$scope","$uibModalInstance",function(b,c){b.readonly=!0,b.orderId=a,b.showClose=!0,b.close=function(){c.dismiss("")}}],size:"lg"})},h()}]),angular.module("channelApp").controller("ReviewCtrl",["$scope","$http","$filter","$uibModal","PyCapital",function(a,b,c,d,e){function f(){return j.map(function(a){return a.header})}function g(a){return a.forEach(function(a){var b=[];j.forEach(function(c){if(c.col.indexOf(",")>0){var d=c.col.split(","),e=(c.formate?c.formate(a[d[0]],a):a[d[0]])||"无",f=(c.formate?c.formate(a[d[1]],a):a[d[1]])||"无";b.push(e+"<br/>"+f)}else{var g=(c.formate?c.formate(a[c.col],a):a[c.col])||"无";b.push(g)}}),a.cols=b}),a}function h(){return a.channel&&!a.channel.ChannelId?(alert("请选择渠道！"),void(a.channel=void 0)):{cid:a.channel&&a.channel.ChannelId||void 0,start:c("date")(a.startdate,"yyyy-MM-dd"),end:c("date")(a.enddate,"yyyy-MM-dd"),status:a.status,Category:1}}function i(c){var c=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem,c);b.get("/api/orders/agent?"+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.data=g(b.data)})}var j=[{header:"省",col:"ProvinceName"},{header:"市",col:"CityName"},{header:"一级代理商",col:"ChannelName1"},{header:"二级代理商",col:"ChannelName2"},{header:"公司名称",col:"Name",formate:function(a,b){return b.FreChangeOrderId?a+"<br/>(企业性质变更)":a}},{header:"订单编号/合同号",col:"OrderId,ContractNO"},{header:"订单日期",col:"CreateDate",formate:function(a){return a.substr(0,10)}}];a.headers=f(),a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.status=1,a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.pageChanged=function(){i(a.searchItem)},a.searchItem=h(),a.searchFn=function(){a.searchItem=h(),i(a.searchItem)},a.sdateOptions={formatYear:"yyyy"},a.edateOptions={formatYear:"yyyy"},a.setMinDate=function(){a.edateOptions.minDate=a.startdate},a.reset=function(){a.channelId=void 0,a.status=1,a.startdate="",a.enddate=""},a.audit=function(c){c.FreChangeOrderId?b.put("/api/signacontract/audit/"+c.OrderId).success(function(b){b.status&&alert("操作成功！"),a.searchFn()}):b.put("/api/orders/audit/"+c.OrderId).success(function(b){b.status&&alert("操作成功！"),a.searchFn()})},a.back=function(a){d.open({templateUrl:"views/invoiceReject.html",controller:["$scope","$http","$filter","$uibModalInstance",function(b,c,d,e){b.invoice={},b.title="拒绝提单",b.cancel=function(){e.dismiss("")},b.ok=function(){if(!b.loading){var d={id:a,BackReason:b.invoice.AuditMsg};b.loading=!0,c.put("/api/orders/back",d).success(function(){e.close()})}}}]}).result.then(function(){i()})},a.view=function(a,b){d.open({templateUrl:"views/addOrder.html",controller:["$scope","$uibModalInstance",function(c,d){c.readonly=!0,c.orderId=a,c.showClose=!0,c.isChange=b,c.close=function(){d.dismiss("")}}],size:"lg"})},b.get("/api/agent/dict").success(function(b){a.agents=_.map(b.data,function(a){return a.py=e.getCaptial(a.ChannelName),a}),a.searchFn()})}]),angular.module("channelApp").controller("ReviewCusCtrl",["$scope","$http","$filter","$uibModal","PyCapital",function(a,b,c,d,e){function f(){return j.map(function(a){return a.header})}function g(a){return a.forEach(function(a){var b=[];j.forEach(function(c){if(c.col.indexOf(",")>0){var d=c.col.split(","),e=(c.formate?c.formate(a[d[0]]):a[d[0]])||"无",f=(c.formate?c.formate(a[d[1]]):a[d[1]])||"无";b.push(e+"<br/>"+f)}else{var g=(c.formate?c.formate(a[c.col]):a[c.col])||"无";b.push(g)}}),a.cols=b}),a}function h(){return a.channel&&!a.channel.ChannelId?(alert("请选择渠道！"),void(a.channel=void 0)):{cid:a.channel&&a.channel.ChannelId||void 0,start:c("date")(a.startdate,"yyyy-MM-dd"),end:c("date")(a.enddate,"yyyy-MM-dd"),status:a.status}}function i(c){var c=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem,c);b.get("/api/orderszj/agent?"+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.data=g(b.data)})}a.title="注册审核";var j=[{header:"省",col:"ProvinceName"},{header:"市",col:"CityName"},{header:"一级代理商",col:"ChannelName1"},{header:"二级代理商",col:"ChannelName2"},{header:"订单编号/合同号",col:"OrderId,ContractNO"},{header:"联系人/电话",col:"Contacts,Mobile"},{header:"法人",col:"LegalPerson"},{header:"订单日期",col:"CreateDate",formate:function(a){return a.substr(0,10)}}];a.headers=f(),a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.channelId=void 0,a.status=1,a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.pageChanged=function(){i(a.searchItem)},a.searchItem=h(),a.searchFn=function(){a.searchItem=h(),i(a.searchItem)},a.sdateOptions={formatYear:"yyyy"},a.edateOptions={formatYear:"yyyy"},a.setMinDate=function(){a.edateOptions.minDate=a.startdate},a.reset=function(){a.channelId=void 0,a.status=1,a.startdate="",a.enddate=""},a.audit=function(c){b.put("/api/orderszj/audit/"+c.OrderId).success(function(b){b.status&&alert("操作成功！"),a.searchFn()})},a.back=function(a){d.open({templateUrl:"views/invoiceReject.html",controller:["$scope","$http","$filter","$uibModalInstance",function(b,c,d,e){b.invoice={},b.title="拒绝提单",b.cancel=function(){e.dismiss("")},b.ok=function(){if(!b.loading){var d={id:a,BackReason:b.invoice.AuditMsg};b.loading=!0,c.put("/api/orders/back",d).success(function(){e.close()})}}}]}).result.then(function(){i()})},a.view=function(a){d.open({templateUrl:"views/addOrder.html",controller:["$scope","$uibModalInstance",function(b,c){b.readonly=!0,b.orderId=a,b.showClose=!0,b.close=function(){c.dismiss("")}}],size:"lg"})},b.get("/api/agent/dict").success(function(b){a.agents=_.map(b.data,function(a){return a.py=e.getCaptial(a.ChannelName),a}),a.searchFn()})}]),angular.module("channelApp").controller("ReviewTobCtrl",["$scope","$http","$filter","$uibModal","PyCapital",function(a,b,c,d,e){function f(){return j.map(function(a){return a.header})}function g(a){return a.forEach(function(a){var b=[];j.forEach(function(c){if(c.col.indexOf(",")>0){var d=c.col.split(","),e=(c.formate?c.formate(a[d[0]]):a[d[0]])||"无",f=(c.formate?c.formate(a[d[1]]):a[d[1]])||"无";b.push(e+"<br/>"+f)}else{var g=(c.formate?c.formate(a[c.col]):a[c.col])||"无";b.push(g)}}),a.cols=b}),a}function h(){return a.channel&&!a.channel.ChannelId?(alert("请选择渠道！"),void(a.channel=void 0)):{cid:a.channel&&a.channel.ChannelId||void 0,start:c("date")(a.startdate,"yyyy-MM-dd"),end:c("date")(a.enddate,"yyyy-MM-dd"),status:a.status}}function i(c){var c=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem,c);b.get("/api/orderszj2/agent?"+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.data=g(b.data)})}a.title="记账审核";var j=[{header:"省",col:"ProvinceName"},{header:"市",col:"CityName"},{header:"一级代理商",col:"ChannelName1"},{header:"二级代理商",col:"ChannelName2"},{header:"公司名称",col:"Name"},{header:"订单编号/合同号",col:"OrderId,ContractNO"},{header:"订单日期",col:"CreateDate",formate:function(a){return a.substr(0,10)}}];a.headers=f(),a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.channelId=void 0,a.status=1,a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.pageChanged=function(){i(a.searchItem)},a.searchItem=h(),a.searchFn=function(){a.searchItem=h(),i(a.searchItem)},a.sdateOptions={formatYear:"yyyy"},a.edateOptions={formatYear:"yyyy"},a.setMinDate=function(){a.edateOptions.minDate=a.startdate},a.reset=function(){a.channelId=void 0,a.status=1,a.startdate="",a.enddate=""},a.audit=function(c){b.put("/api/orderszj2/audit/"+c.OrderId).success(function(b){b.status&&alert("操作成功！"),a.searchFn()})},a.back=function(a){d.open({templateUrl:"views/invoiceReject.html",controller:["$scope","$http","$filter","$uibModalInstance",function(b,c,d,e){b.invoice={},b.title="拒绝提单",b.cancel=function(){e.dismiss("")},b.ok=function(){if(!b.loading){var d={id:a,BackReason:b.invoice.AuditMsg};b.loading=!0,c.put("/api/orders/back",d).success(function(){e.close()})}}}]}).result.then(function(){i()})},a.view=function(a){d.open({templateUrl:"views/addOrder.html",controller:["$scope","$uibModalInstance",function(b,c){b.readonly=!0,b.orderId=a,b.showClose=!0,b.close=function(){c.dismiss("")}}],size:"lg"})},b.get("/api/agent/dict").success(function(b){a.agents=_.map(b.data,function(a){return a.py=e.getCaptial(a.ChannelName),a}),a.searchFn()})}]),angular.module("channelApp").controller("AgentListCtrl",["$scope","$http","$state","$uibModal","user",function(a,b,c,d,e){function f(a,c){return a.status=c,a=angular.extend(a),delete a.cols,b.put("/api/checkagent/"+a.ChannelId,a)}function g(){var c={limit:a.paginator.perPage,offset:a.paginator.perPage*(a.paginator.currentPage-1),channelname:a.channelname,status:a.status};b.get("/api/agents?"+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.data=b.data})}a.isCenter=e.get().IsCenter,a.user=e.get(),a.status=0,a.addAgent=function(){d.open({templateUrl:"views/agentModal.html",controller:"agentCtrlModal",size:"lg",resolve:{agent:function(){return null},title:function(){return"申请下级代理商"}},backdrop:"static"}).result.then(function(a){g()},function(){})},a.modify=function(a){d.open({templateUrl:"views/agentModal.html",controller:"agentCtrlModal",size:"lg",resolve:{agent:function(){return a},title:function(){return"修改下级代理商"}},backdrop:"static"}).result.then(function(a){g()},function(){})},a.remove=function(a){confirm("确认删除?")&&b.delete("/api/agent/"+a).success(function(){g()})},a.pass=function(a,b){if(1==b){var c=d.open({templateUrl:"views/userPassword.html",backdrop:"static",controller:["$scope","$uibModalInstance",function(b,c){b.item=a,b.cancel=function(){c.dismiss("cancel")},b.ok=function(){return b.submited=!0,b.agForm.$error.required?void alert("请补充必填项。"):b.agForm.$error.pattern?void alert("请输入有效的用户名"):void c.close(b.item)}}]});c.result.then(function(a){f(a,b).success(function(){g()})},function(){})}else{var c=d.open({templateUrl:"views/rejectModal.html",controller:"agRejectModalCtrl"});c.result.then(function(c){a.Desc=c,f(a,b).success(function(){g()})},function(){})}},a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.pageChanged=function(){g()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},g()}]).controller("agentCtrlModal",["$scope","$http","$uibModalInstance","agent","FileUploader","user","$filter","title",function(a,b,c,d,e,f,g,h){function i(b,c){var d=j(4,b.file.name);b.formData.push({key:d}),_.each(a.signkey,function(a,c){var d={};d[c]=a,b.formData.push(d)}),a["_key"+c]=d}function j(a,b){var c=function(a){var b="",c=a.lastIndexOf(".");return-1!=c&&(b=a.substring(c)),b},d=function(a){a=a||32;for(var b="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",c=b.length,d="",e=0;e<a;e++)d+=b.charAt(Math.floor(Math.random()*c));return d},e=c(b),f={1:"FileUploads/Order/CardID/",2:"FileUploads/Order/BusinessLicense/",3:"FileUploads/Order/Contract/",4:"FileUploads/Agent/"},h=g("date")(new Date,"yyyyMM");return f[a]+h+"/"+d(10)+e}function k(a){alert("上传失败!")}a.item=d||{},console.log(a.item,"$scope.item"),a.title=h,a.isCenter=f.get().IsCenter,a.item.ChannelId&&b.get("/api/agent/"+a.item.ChannelId).success(function(b){a.item=b.data[0],a.item.IsFetation=""+a.item.IsFetation}),b.get("/api/code/city").success(function(b){a.cities=b.data}),a.cancel=function(){c.dismiss("cancel")},a.isModal=!0,a.ok=function(){if(a.submited=!0,!a.loading)return a.agForm.$error.required?void alert("请补充必填项。"):a.agForm.$error.pattern?void alert("请输入有效的用户名"):void(a.item.ChannelId?(a.loading=!0,delete a.item.PassWrod,delete a.item.UserName,delete a.item.Balance,delete a.item.CityName,delete a.item.CreateDate,delete a.item.ModifyBy,delete a.item.ModifyDate,delete a.item.ParentId,delete a.item.Status,delete a.item.ProvinceName,b.put("/api/agent/"+a.item.ChannelId,a.item).success(function(a){a.status&&c.close("")})):b.post("/api/agent",a.item).success(function(a){a.status&&c.close("")}))};var l="https://pilipa.oss-cn-beijing.aliyuncs.com";b.get("/api/signkey").success(function(b){delete b.data.Filename,delete b.data.key,delete b.data.callback,delete b.data.expire,delete b.data.Host,a.signkey=b.data}),a.uploader1=new e({url:l,autoUpload:!0}),a.uploader1.onErrorItem=k,a.uploader1.onCompleteItem=function(b,c,d,e){a.item.IdCard=l+"/"+a._key1},a.uploader1.onBeforeUploadItem=function(a){i(a,1)},a.uploader2=new e({url:l,autoUpload:!0}),a.uploader2.onCompleteItem=function(b,c,d,e){a.item.Aptitude=l+"/"+a._key2},a.uploader2.onBeforeUploadItem=function(a){i(a,2)},a.uploader2.onErrorItem=k,a.uploader3=new e({url:l,autoUpload:!0}),a.uploader3.onCompleteItem=function(b,c,d,e){a.item.Documents=l+"/"+a._key3},a.uploader3.onErrorItem=k,a.uploader3.onBeforeUploadItem=function(a){i(a,3)}}]).controller("agentCtrl",["$scope","$http","$state","FileUploader","user","$filter",function(a,b,c,d,e,f){function g(b,c){var d=h(4,b.file.name);b.formData.push({key:d}),_.each(a.signkey,function(a,c){var d={};d[c]=a,b.formData.push(d)}),a["_key"+c]=d}function h(a,b){var c=function(a){var b="",c=a.lastIndexOf(".");return-1!=c&&(b=a.substring(c)),b},d=function(a){a=a||32;for(var b="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",c=b.length,d="",e=0;e<a;e++)d+=b.charAt(Math.floor(Math.random()*c));return d},e=c(b),g={1:"FileUploads/Order/CardID/",2:"FileUploads/Order/BusinessLicense/",3:"FileUploads/Order/Contract/",4:"FileUploads/Agent/"},h=f("date")(new Date,"yyyyMM");return g[a]+h+"/"+d(10)+e}function i(a){alert("上传失败!")}a.item={},a.isCenter=e.get().IsCenter,b.get("/api/code/city").success(function(b){a.cities=b.data}),a.ok=function(){if(a.submited=!0,!a.loading){if(a.agForm.$error.required)return void alert("请补充必填项。");if(a.agForm.$error.pattern)return void alert("请输入有效的用户名");a.loading=!0,b.post("/api/agent",a.item).success(function(a){a.status&&c.go("^.agent")})}};var j="https://pilipa.oss-cn-beijing.aliyuncs.com";b.get("/api/signkey").success(function(b){delete b.data.Filename,delete b.data.key,delete b.data.callback,delete b.data.expire,delete b.data.Host,a.signkey=b.data}),a.uploader1=new d({url:j,autoUpload:!0}),a.uploader1.onErrorItem=i,a.uploader1.onCompleteItem=function(b,c,d,e){a.item.IdCard=j+"/"+a._key1},a.uploader1.onBeforeUploadItem=function(a){g(a,1)},a.uploader2=new d({url:j,autoUpload:!0}),a.uploader2.onCompleteItem=function(b,c,d,e){a.item.Aptitude=j+"/"+a._key2},a.uploader2.onBeforeUploadItem=function(a){g(a,2)},a.uploader2.onErrorItem=i,a.uploader3=new d({url:j,autoUpload:!0}),a.uploader3.onCompleteItem=function(b,c,d,e){a.item.Documents=j+"/"+a._key3},a.uploader3.onErrorItem=i,a.uploader3.onBeforeUploadItem=function(a){g(a,3)}}]).controller("agRejectModalCtrl",["$scope","$uibModalInstance",function(a,b){a.item={reason:""},a.cancel=function(){b.dismiss("cancel")},a.ok=function(){b.close(a.item.reason)}}]).controller("messageModalCtrl",["$scope","$uibModalInstance","message",function(a,b,c){a.message=c,a.cancel=function(){b.dismiss("cancel")},a.ok=function(){b.close(a.item.reason)}}]),angular.module("channelApp").controller("UpdatePswdCtrl",["$scope","$uibModalInstance","UpdatePswdService",function(a,b,c){a.pswdParams={Old:"",New:"",Confirm:""},a.interacted=function(b){return a.submitted||b.$dirty},a.dismiss=function(){b.dismiss()},a.update=function(b){a.submitted=!0,c.update(a.pswdParams).then(function(b){b.status&&(alert("修改成功"),a.dismiss())})}}]),angular.module("channelApp").controller("InvoiceCtrl",["$scope","$filter","$uibModal","InvoiceService",function(a,b,c,d){function e(){d.getEffective().then(function(b){a.effective=b.data})}var f=function(){d.getEffective().then(function(b){a.balance=b.data})};f(),e();var g=(new Date).getDate();(g<10||g>20)&&(a.invalid=!0),a.applyInvoice=function(b){c.open({templateUrl:"views/invoiceApply.html",controller:"InvoiceApplyCtrl",resolve:{Balance:function(){return{balance:a.balance,invoiceId:b&&b.InvoiceId}}}}).result.then(function(b){a.selectedTab=1,a.pageChanged(),f()},function(){})},a.tabSelect=function(b){a.selectedTab=b},a.applyViews={start:"",end:"",selectedApplyType:{},currentPage:""},a.issueViews={start:"",end:"",currentPage:""},function(){a.applyType=[{name:"全部",status:"0"},{name:"未审核",status:"1"},{name:"通过",status:"2"},{name:"拒审",status:"3"}],a.applyViews.selectedApplyType=a.applyType[0]}(),a.datepickerConfig={clearText:"清空",currentText:"今天",closeText:"关闭",startFlag:!1,endFlag:!1},a.showDatepicker=function(b){switch(b){case"start":a.datepickerConfig.startFlag=!0;break;case"end":a.datepickerConfig.endFlag=!0}},a.applyParams={invoiceid:"",start:"",end:"",status:0,offset:0,limit:0},a.issueParams={invoiceid:"",invoicecode:"",start:"",end:"",offset:0,limit:0};var h={perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"};a.applyPaginator=angular.extend(angular.copy(h),{total:0,currentPage:1}),a.issuePaginator=angular.extend(angular.copy(h),{total:0,currentPage:1}),a.applyModel=[],a.issueModel=[],a.pageChanged=function(){1==a.selectedTab?(a.applyParams=angular.extend(a.applyParams,{start:b("date")(a.applyViews.start,"yyyy-MM-dd"),end:b("date")(a.applyViews.end,"yyyy-MM-dd"),limit:a.applyPaginator.perPage,offset:(a.applyPaginator.currentPage-1)*a.applyPaginator.perPage,status:a.applyViews.selectedApplyType.status}),d.getApplyLists(a.applyParams).then(function(b){a.applyModel=b.data,a.applyPaginator.total=b.Count})):(a.issueParams=angular.extend(a.issueParams,{start:b("date")(a.issueViews.start,"yyyy-MM-dd"),end:b("date")(a.issueViews.end,"yyyy-MM-dd"),limit:a.issuePaginator.perPage,offset:(a.issuePaginator.currentPage-1)*a.issuePaginator.perPage}),d.getIssueLists(a.issueParams).then(function(b){a.issueModel=b.data,a.issuePaginator.total=b.Count}))},a.delete=function(b){confirm("确定要删除发票申请？")&&d.delete(b.InvoiceId).success(function(b){b.status&&(alert("删除成功！"),a.pageChanged(),f())})},a.selectedTab=1,a.pageChanged(),a.getList=function(){1===a.selectedTab?a.applyPaginator.currentPage=1:a.issuePaginator.currentPage=1,a.pageChanged()},a.setCurrentPage=function(){1===a.selectedTab?a.applyPaginator.currentPage=a.applyViews.currentPage:a.issuePaginator.currentPage=a.issueViews.currentPage,a.pageChanged()},a.scan=function(a){c.open({templateUrl:"views/invoiceScan.html",controller:"InvoiceScanCtrl",resolve:{SelectedInvoice:function(){return{id:a.InvoiceId}}}})}}]),angular.module("channelApp").controller("InvoiceApplyCtrl",["$scope","$filter","$uibModalInstance","$uibModal","Balance","InvoiceService",function(a,b,c,d,e,f){console.log(e,"Balance");var g=function(){a.propertyModel=[{name:"公司",property:1},{name:"个人",property:2}],a.selectedProp=a.propertyModel[0]},h=function(){a.categoryModel=[{name:"专票",category:1},{name:"普票",category:2}],a.selectedCate=a.categoryModel[0]},i=function(){f.getProject().then(function(b){a.projectModel=b,a.applyParams.Project?a.selectedProject=_.find(a.projectModel,{Key:a.applyParams.Project}):a.selectedProject=a.projectModel.length>0?a.projectModel[0]:{}})},j=function(){f.getAddress().then(function(b){a.addressModel=b.data,a.applyParams.AddressId?a.selectedAddress=_.find(a.addressModel,{Id:a.applyParams.AddressId}):a.selectedAddress=a.addressModel&&a.addressModel.length>0?a.addressModel[0]:""})},k=function(){f.getInvoiceType().then(function(b){a.typeModel=b,a.applyParams.ApplyType?a.selectedType=_.find(a.typeModel,{Key:a.applyParams.ApplyType}):a.selectedType=a.typeModel&&a.typeModel.length>0?a.typeModel[0]:{}})};(function(){g(),h(),i(),j(),k()})(),a.applyParams={Title:"",Property:1,Category:1,Project:1,Amount:0,AddressId:"",ApplyType:"",InvoiceNumber:""},a.apply=function(){if(a.applyParams=angular.extend(a.applyParams,{Property:a.selectedProp.property,Category:a.selectedCate.category,Project:a.selectedProject.Key,AddressId:a.selectedAddress.Id,ApplyType:a.selectedType.Key}),0==a.applyParams.Amount)return void alert("请选择未开发票订单！");f.applyInvoice(a.applyParams).then(function(a){a.status&&(alert("申请成功"),c.close())})},a.dismiss=function(){c.dismiss()},a.addAddress=function(){d.open({templateUrl:"views/cmFormModal.html",size:"lg",controller:"AddressModalCtrl",resolve:{item:function(){return{}}}}).result.then(function(a){j()},function(){})},a.selectOrder=function(){d.open({templateUrl:"views/invoiceSelectOrder.html",controller:"InvoiceSelectOrder",size:"lg",resolve:{InvoiceItem:function(){return{balance:e.balance,orderIds:a.applyParams.orderids,invoiceId:e.invoiceId}}}}).result.then(function(b){/\./.test(b.amount)?a.applyParams.Amount=b.amount.toFixed(2):a.applyParams.Amount=b.amount,a.applyParams.orderids=b.orderIds},function(){})},e.invoiceId&&f.getDetail({id:e.invoiceId}).then(function(b){a.applyParams=_.pick(b.data,"InvoiceId","Title","Property","Category","Project","Amount","AddressId","ApplyType","InvoiceNumber","DepositBank","BankNo","orderids"),a.selectedCate=_.find(a.categoryModel,{category:b.data.Category}),a.selectedProp=_.find(a.propertyModel,{property:b.data.Property}),a.projectModel&&_.find(a.projectModel,{Key:b.data.Project}),a.addressModel&&(a.selectedAddress=_.find(a.addressModel,{Id:b.data.AddressId})),a.typeModel&&(a.selectedType=_.find(a.typeModel,{Key:b.data.ApplyType}))})}]).controller("InvoiceSelectOrder",["$scope","$filter","$uibModalInstance","$http","InvoiceItem",function(a,b,c,d,e){a.searchParams={invoiceId:e.invoiceId},console.log(e.balance,"InvoiceItem"),a.datepickerConfig={clearText:"清空",currentText:"今天",closeText:"关闭",startFlag:!1,endFlag:!1},a.isCheckAll=!1,a.isChecked=function(){return!_.find(a.orders,{selected:!1})},a.checkAll=function(){a.isCheckAll?_.each(a.orders,function(a){a.selected=!0}):_.each(a.orders,function(a){a.selected=!1})},a.showDatepicker=function(b){switch(b){case"start":a.datepickerConfig.startFlag=!0;break;case"end":a.datepickerConfig.endFlag=!0}},a.ok=function(){var b=_.filter(a.orders,{selected:!0});if(0===b.length)return void alert("请选择未开发票订单！");var d=_.reduce(b,function(a,b){return a+=b.BLAmount},0);if(d>e.balance)return void alert("发票金额不允许超出"+e.balance+"！");c.close({amount:d,orderIds:_.map(b,function(a){return"'"+a.OrderId+"'"}).join(",")})},a.cancel=function(){c.dismiss()},a.search=function(){d.get("/api/invoice/getneworders?"+$.param(a.searchParams)).success(function(b){a.orders=b.data;var c=e.orderIds&&e.orderIds.split(",");_.each(b.data,function(a){a.selected=c?c.indexOf("'"+a.OrderId+"'")>-1:a.InvoiceId==e.invoiceId})})},a.search()}]),angular.module("channelApp").controller("InvoiceScanCtrl",["$scope","$filter","$uibModalInstance","SelectedInvoice","InvoiceService",function(a,b,c,d,e){e.getDetail({id:d.id}).then(function(b){a.invoiceInfo=b.data}).then(function(){e.getInvoiceType().then(function(b){b&&angular.forEach(b,function(b,c){b.Key==a.invoiceInfo.Project&&(a.invoiceInfo.projectMap=b.Value)})})}),a.dismiss=function(){c.dismiss()}}]),angular.module("channelApp").controller("InvoiceSearchCtrl",["$scope","$http","$filter","$state","user","OrderSearchService","$uibModal",function(a,b,c,d,e,f,g){function h(){b.get("/api/invoice/agent/issue?"+jQuery.param(a.searchParams)).success(function(b){a.paginator.total=b.Count,a.invoices=b.data})}a.user=e.get();var i={options:{formatYear:"yy",maxDate:new Date(2020,5,22),minDate:new Date,startingDay:1},clearText:"清空",currentText:"今天",closeText:"关闭",startFlag:!1,endFlag:!1};a.datepickerConfig=i,a.showDatepicker=function(b){switch(b){case"start":a.datepickerConfig.startFlag=!0;break;case"end":a.datepickerConfig.endFlag=!0}};var j=function(){f.getAgent().then(function(b){a.agentModel=b.data,a.agentModel.unshift({ChannelId:"",ChannelName:"全部"}),a.selectedAgent=a.agentModel[0]})};1==a.user.IsCenter&&j(),a.paginator={total:0,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.searchParams={limit:a.paginator.perPage,offset:(a.paginator.currentPage-1)*a.paginator.perPage,status:1,cid:""},a.orderModel=[],a.pageChanged=function(){a.searchParams=angular.extend(a.searchParams,{limit:a.paginator.perPage,offset:(a.paginator.currentPage-1)*a.paginator.perPage}),h()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.search=function(){a.paginator.currentPage=1,a.searchParams=angular.extend(a.searchParams,{limit:a.paginator.perPage,offset:(a.paginator.currentPage-1)*a.paginator.perPage,start:c("date")(a.start,"yyyy-MM-dd"),end:c("date")(a.end,"yyyy-MM-dd"),status:1,cid:a.selectedAgent.ChannelId,invoicecode:a.invoiceCode}),h()},h(),a.scan=function(a){g.open({templateUrl:"views/invoiceScan.html",controller:"InvoiceScanCtrl",resolve:{SelectedInvoice:function(){return{id:a.InvoiceId}}}})}}]),function(a){var b=[{header:"省",col:"ProvinceName",realCol:"ProvinceCode",type:"acSelect",options:{url:"/api/code/province",label:"Name",id:"Code",hasDefault:!0}},{header:"市",col:"CityName",realCol:"CityCode",type:"acSelect",options:{url:"/api/code/city",label:"Name",id:"Code",watchField:"ProvinceCode",paramStr:"?pcode={val}",hasDefault:!0}},{header:"名称",col:"Name",type:"text",required:!0},{header:"接收人",col:"Receiver",type:"text",required:!0},{header:"联系方式",col:"Mobile",type:"text",required:!0},{header:"地址",col:"Address",type:"text",required:!0}];a.module("channelApp").controller("AddressListCtrl",["$scope","$http","$uibModal",function(a,c,d){function e(){return b.map(function(a){return a.header})}function f(a){return a.forEach(function(a){var c=[];b.forEach(function(b){var d=(b.formate?b.formate(a[b.col]):a[b.col])||"无";c.push(d)}),a.cols=c}),a}function g(){c.get("/api/address").success(function(b){a.data=f(b.data)})}a.headers=e(),g(),a.open=function(a){d.open({templateUrl:"views/cmFormModal.html",size:"lg",controller:"AddressModalCtrl",resolve:{item:function(){return a||{}}}}).result.then(function(a){g()},function(){})}}]).controller("AddressModalCtrl",["$scope","$uibModalInstance","$http","item",function(a,c,d,e){a.item=e||{},a.title="地址管理",a.settings=b,console.log(b,"tbOptions"),a.ok=function(){function b(a){a.status&&c.close()}console.log(a.item,"$scope.item"),a.item.Id?d.put("/api/address/"+a.item.Id,a.item).success(b):d.post("/api/address",a.item).success(b)},a.cancel=function(){c.dismiss()}}])}(angular),function(){angular.module("channelApp").controller("CustomerSigned",["$scope","$uibModal","CustomerService",function(a,b,c){function d(){var b=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem,b);c.getSignedCustomers(b).success(function(b){a.paginator.total=b.Count,a.customers=b.data})}a.open=function(a){b.open({templateUrl:"views/addCustomers.html",controller:"AddCustomerCtrl",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){d()},function(){})},a.paginator={total:0,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.searchParams={limit:10,offset:0,start:"",end:"",status:0,cusname:"",cid:""},a.pageChanged=function(){d()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,d()},a.searchItem={companyName:"",mobile:""},a.search=function(){a.searchItem.companyName=a.companyName,a.searchItem.mobile=a.mobile,d(a.searchItem)},d()}])}(angular),angular.module("channelApp").controller("OrdersTob",["$scope","$http","$filter","$state",function(a,b,c,d){function e(){return i.map(function(a){return a.header})}function f(a){return a.forEach(function(a){var b=[];i.forEach(function(c){if(c.col.indexOf(",")>0){var d=c.col.split(","),e=(c.formate?c.formate(a[d[0]]):a[d[0]])||"无",f=(c.formate?c.formate(a[d[1]]):a[d[1]])||"无";b.push(e+"<br/>"+f)}else{var g=(c.formate?c.formate(a[c.col]):a[c.col])||"无";b.push(g)}}),a.cols=b}),a}function g(){return{cusname:a.cusname,start:c("date")(a.startdate,"yyyy-MM-dd"),end:c("date")(a.enddate,"yyyy-MM-dd"),status:a.status,LegalPerson:a.LegalPerson}}function h(c){var c=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem,c);b.get("/api/orderszj/my?"+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.data=f(b.data)})}a.title="需要补充注册材料的订单";var i=[{header:"合同号",col:"ContractNO"},{header:"联系人",col:"Contacts"},{header:"电话",col:"Mobile"},{header:"法人",col:"LegalPerson"},{header:"合同金额",col:"ContractAmount"},{header:"订单日期",col:"CreateDate",formate:function(a){return a.substr(0,10)}}];a.rightAlign=[2],a.headers=e(),a.isZB=!0,a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.status=0,a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.pageChanged=function(){h(a.searchItem)},a.searchItem=g(),a.searchFn=function(){a.searchItem=g(),h(a.searchItem)},a.sdateOptions={formatYear:"yyyy"},a.edateOptions={formatYear:"yyyy"},a.setMinDate=function(){a.edateOptions.minDate=a.startdate},a.reset=function(){a.cusname="",a.startdate="",a.enddate="",a.status=0},a.searchFn(),a.modify=function(a){
d.go("^.addOrder",{orderId:a.OrderId})},a.delete=function(a){confirm("确认删除订单？")&&b({method:"delete",url:"/api/orders/"+a}).success(function(a){a.status&&alert("删除成功！"),h()})}}]),angular.module("channelApp").controller("OtherBussnessAdd",["$scope","$http","$filter","$state","$stateParams","CustomerService","user",function(a,b,c,d,e,f,g){function h(){b.get("/api/code/industry").success(function(b){a.industries=b.data}),b.get("/api/citybychannel").success(function(b){a.cities=b.data,1===a.cities.length&&(a.postData.CityCode=a.cities[0].CityCode)}),b.get("/api/orders/sales").success(function(b){a.sales=b.data,a.postData.SaleId=""+b.data[0].UserId}),f.getObNames().success(function(b){a.bnames=b.data})}a.postData={};var i=e.orderId||a.$parent.orderId||!1;i?f.getObById(i).success(function(b){a.postData=angular.extend(b.data,b.data.Customer),a.postData.SaleId=""+a.postData.SaleId,a.postData.AddedValue=""+a.postData.AddedValue,a.postData.Industry=""+a.postData.Industry,h()}):h(),a.getCompanyName=function(a){return b.get("/api/orders/companyname?name="+a).then(function(a){return a.data.data.map(function(a){return{Name:a.Name}})})},a.companySelect=function(c,d,e,f){b.get("/api/orders/company?name="+e).success(function(b){var c=b.data[0];delete c.SalesId,c.Name=c.Name.trim(),c.AddedValue=""+c.AddedValue,c.Industry=""+c.Industry,a.postData=angular.extend(a.postData,c)})},a.save=function(){if(a.submited=!0,!a.postData.SaleId)return void alert("请先选择销售人员！");if(!a.loading){if(a.myForm.$invalid)return void alert("请补充必填项！");var c={url:"/api/cusregister",data:a.postData,method:"post"};a.postData.Id&&(c.method="put"),a.loading=!0,b(c).success(function(b){b.status&&(alert("操作成功！"),d.go("^.oblist")),a.loading=!1}).error(function(){a.loading=!1})}}}]),function(){angular.module("channelApp").controller("OtherBussnessList",["$scope","$uibModal","CustomerService",function(a,b,c){function d(){var b=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem);c.getObList(b).success(function(b){a.paginator.total=b.Count,a.customers=b.data})}a.open=function(a){b.open({templateUrl:"views/addCustomers.html",controller:"AddCustomerCtrl",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){d()},function(){})},a.delete=function(a){c.delete(a.CustomerId)},a.track=function(a){b.open({templateUrl:"views/customer_track.html",controller:"CustomerTrack",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){d()},function(){d()})},a.forward=function(a){b.open({templateUrl:"views/customer_forword.html",controller:"CustomerForward",size:"lg",resolve:{customer:function(){return a}},backdrop:"static"}).result.then(function(a){d()},function(){})},a.paginator={total:0,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.searchParams={limit:10,offset:0,start:"",end:"",status:0,cusname:"",cid:""},a.pageChanged=function(){d()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,d()},a.searchItem={companyName:"",BusinessName:""},a.search=function(){a.searchItem.BusinessName=a.bsName,a.searchItem.companyName=a.companyName,d(a.searchItem)},d(),c.getObNames().success(function(b){a.bnames=b.data}),a.delete=function(a){c.deleteObById(a).success(function(a){a.status&&d()})}}])}(angular),function(){angular.module("channelApp").controller("DateRemind",["$scope","$uibModal","CustomerService","user","$state",function(a,b,c,d,e){function f(){var b=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem);c.getCustomerRemind(b).success(function(b){a.paginator.total=b.Count,a.customers=b.data})}a.user=d.get(),a.view=function(a){b.open({templateUrl:"views/addOrder.html",controller:["$scope","$uibModalInstance",function(b,c){b.readonly=!0,b.orderId=a,b.showClose=!0,b.close=function(){c.dismiss("")}}],size:"lg"})},a.add=function(a,b){e.go("^.addOrder",{orderId:"C"+a+"&"+b})},a.paginator={total:0,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.pageChanged=function(){f()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,f()},a.searchItem={monthcount:"1"},a.search=function(){a.searchItem.monthcount=a.limit,f(a.searchItem)},a.limit="1",f()}])}(angular),function(){angular.module("channelApp").controller("ConChange",["$scope","$uibModal","CustomerService","user","$state",function(a,b,c,d,e){function f(){var b=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem);c.getCustomerChange(b).success(function(b){a.paginator.total=b.Count,a.customers=b.data})}a.user=d.get(),a.view=function(a){b.open({templateUrl:"views/change2.html",controller:"Change",size:"lg",windowClass:"add-order-modal-container",resolve:{orderId:function(){return a},isModify:function(){return!1},isConchange:function(){return!0}}}).result.then(function(){f()})},a.paginator={total:0,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.pageChanged=function(){f()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,f()},a.searchItem={cusname:""},a.search=function(){a.paginator.currentPage=1,a.searchItem.cusname=a.cusname,f(a.searchItem)},a.limit="1",f()}]).controller("Change",["$scope","$uibModal","$http","$uibModalInstance","FileUploader","orderId","$filter","isModify","isConchange",function(a,b,c,d,e,f,g,h,i){function j(){a.hasBalance=!0,c.get("api/agent/balance").success(function(b){a.balance=b.data})}function k(){c.get("/api/citybychannel").success(function(b){a.cities=b.data,1===a.cities.length&&(a.postData.CityCode=a.cities[0].CityCode,a.setprice(!0))}),c.get("/api/orders/sales").success(function(b){a.sales=b.data,a.postData.SalesId=""+b.data[0].UserId})}a.orderId=f,a.showClose=!0,a.close=function(){d.dismiss("")},a.postData={NoDeadLine:0},a.setprice=function(){function b(){var b=new Date(a.postData.ServiceEnd),c=a.postData.ServiceStart,d=12*(b.getFullYear()-c.getFullYear())+b.getMonth()-c.getMonth()+1;a.postData.ContractAmount=+(200*d).toFixed(2)}var d;c.get("api/cityprice?cityCode="+a.postData.CityCode).success(function(c){d=c.data,a.payTypes=c.data,a.postData.AddedValue&&a.postData.PayType&&b()})},f?c.get("/api/orders/"+f).success(function(b){if(b=angular.extend(b.data,b.data.Customer),"0001"===b.BusnissDeadline.substr(0,4)?b.BusnissDeadline="":b.BusnissDeadline=new Date(b.BusnissDeadline),"0001"===b.ServiceStart.substr(0,4))b.ServiceStart="";else if(h)b.ServiceStart=new Date(b.ServiceStart);else{var c=new Date,d=c.getTime();b.ServiceStart=new Date(b.ServiceStart);var e=b.ServiceStart.getTime();b.ServiceStart=d>e?c:b.ServiceStart}"0001"===b.RegisterDate.substr(0,4)?b.RegisterDate="":b.RegisterDate=new Date(b.RegisterDate),"0001"===b.ServiceEnd.substr(0,4)?b.ServiceEnd="":b.ServiceEnd=b.ServiceEnd.substr(0,7),b.NoDeadLine&&(b.BusnissDeadline=""),b.ContractPath=b.ContractPath?b.ContractPath.split(";"):"",a.imgs=b.ContractPath,a.serviceStartOptions.maxDate=new Date(b.ServiceEnd),a.serviceStartOptions.minDate=new Date,2==b.Status&&b.FreChangeOrderId&&(a.readonly=!0),b.AddedValue="2",a.postData=b,k(),j()}):(k(),j()),a.save=function(b){if(!a.loading&&confirm("您确定纳税人类别变更日期为："+g("date")(a.postData.ServiceStart,"yyyy-MM")+"?")){var e=angular.copy(a.postData);delete e.Customer,delete e.Promotion,e.ContractPath=a.imgs?a.imgs.join(";"):"",e.RegisterDate=g("date")(a.postData.RegisterDate,"yyyy-MM-dd"),e.BusnissDeadline=g("date")(a.postData.BusnissDeadline,"yyyy-MM-dd"),e.ServiceStart=g("date")(a.postData.ServiceStart,"yyyy-MM-dd"),e.ServiceEnd=g("date")(a.postData.ServiceEnd,"yyyy-MM-dd"),e.NoDeadLine?(e.BusnissDeadline="",e.NoDeadLine=1):e.NoDeadLine=0,delete e.GiftTypeId,delete e.GiftTypeName,delete e.GiftPrice,e.IsPromotion=0;var f={url:"/api/orders",data:e,method:"post"};h?(f.method="put",f.url="/api/Reorders/"+a.postData.OrderId):(e.FreChangeOrderId=a.postData.OrderId,delete e.OrderId,e.Remark=(e.Remark||"")+"纳税人类别变更;"),a.loading=!0,c(f).success(function(b){b.status&&(alert("操作成功！"),d.close()),a.loading=!1}).error(function(){a.loading=!1})}};var l=new Date;l.setMonth(l.getMonth()-1),a.serviceStartOptions={formatYear:"yyyy",minMode:"month",maxDate:new Date(a.postData.ServiceEnd),minDate:l},a.startDateOptions={formatYear:"yyyy"},a.endDateOptions={formatYear:"yyyy"}}])}(angular),angular.module("channelApp").controller("NewCustomer",["$scope","$http","$filter","user",function(a,b,c,d){a.isCenter=d.get().IsCenter;var e=new Date;e.setMonth(e.getMonth()-1),a.startdate=e,a.enddate=new Date,a.isCenter&&b.get("/api/code/city").success(function(b){_.each(b.data,function(a){a.selected=!0}),a.cities=b.data}),a.params={startime:"",endtime:""},a.search=function(){a.startdate&&(a.params.startime=c("date")(a.startdate,"yyyy-MM-dd")),a.enddate&&(a.params.endtime=c("date")(a.enddate,"yyyy-MM-dd")),b.get("/api/newcustomer?"+jQuery.param(a.params)).success(function(b){a.rows=b.data,a.totalNum=_.reduce(b.data,function(a,b){return a+b.CustomerNum},0),a.totalAmount=_.reduce(b.data,function(a,b){return a+b.ContractAmount},0)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate}}]),angular.module("channelApp").controller("StatisPaytype",["$scope","$http","$filter","user",function(a,b,c,d){a.isCenter=d.get().IsCenter;var e=new Date;e.setMonth(e.getMonth()-1),a.startdate=e,a.enddate=new Date,a.isCenter&&b.get("/api/code/city").success(function(b){_.each(b.data,function(a){a.selected=!0}),a.cities=b.data}),a.params={startdate:"",enddate:""},b.get("api/cityprice?cityCode=").success(function(b){a.priceNames=_.keys(_.groupBy(b.data,"PriceName"))}),a.search=function(){a.startdate&&(a.params.startdate=c("date")(a.startdate,"yyyy-MM-dd")),a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),b.get("/api/agentordernum?"+jQuery.param(a.params)).success(function(b){var c=_.groupBy(b.data,function(a){return a.ChannelId+","+a.ChannelId1||""}),d=[];_.each(c,function(b,c){var e=b[0];_.each(a.priceNames,function(a){var c=_.find(b,{PriceName:a});e[a]=c?c.OrderNum:0}),d.push(e)}),a.rows=d,a.total=_.reduce(b.data,function(a,b){return b.PriceName?(a[b.PriceName]?a[b.PriceName]+=b.OrderNum:a[b.PriceName]=b.OrderNum,a):a},{})})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate}}]),angular.module("channelApp").controller("StatisProportionC",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(){var b=a.months2,c=_.filter(b,{selected:!0});return c.length===b.length||0===c.length?"全部":c.length<3?_.map(c,function(a){return a.label+"月"}).join(","):_.map(_.slice(c,0,2),function(a){return a.label+"月"}).join(",")+"等"}function h(b){a.params2.selectedText=g()}a.isCenter=d.get().IsCenter,a.search1={year:"2017",months:""},a.search2={year:"2017",months:""};new Date;a.months=[];for(var i=1;i<13;i++)a.months.push({label:i,value:i<10?"0"+i:i});a.months2=[];for(var i=1;i<13;i++)a.months2.push({label:i,value:i<10?"0"+i:i});a.params2={getSelectedText:g,setSelectedText:h,selectedText:"全部"},a.chart2={config:{showXAxis:!0,showYAxis:!0,showLegend:!0,stack:!1,width:800,height:400,grid:{left:"3%",right:"4%",containLabel:!0},tooltip:{show:!0,trigger:"axis",axisPointer:{type:"cross",snap:"true"},formatter:"{b0}<br/>{a0}: {c0}%<br />{a1}: {c1}%"},yAxis:{type:"value",name:"占比",min:0,max:100,position:"left",axisLabel:{formatter:"{value}%"},axisLine:{show:!0}},legend:{bottom:10}},data:[{name:"预提单占比",datapoints:[]},{name:"正式订单占比",datapoints:[]}]},a.tab1Search=function(){if(console.log(a.months,"$scope.months"),console.log(a.search1.months,"months"),a.search1.months){var c={year:a.search1.year,months:a.search1.months,limit:9999,offset:0};b.get("/api/dataanalysis/renew?"+$.param(c)).success(function(b){a.total1=b.data.Total[0],a.data1=b.data.DataInfo})}else alert("请选择到期月份")},a.tab2Search=function(){var c=_.filter(a.months2,{selected:!0}),d=_.map(c,"value").join(","),e={year:a.search2.year,months:d,limit:9999,offset:0};b.get("/api/dataanalysis/reneworofficial?"+$.param(e)).success(function(b){a.total2=b.data.Total[0],a.data2=b.data.DataInfo}),b.get("/api/dataanalysis/reneworofficialchart?"+$.param(e)).success(function(b){var d=_.map(c,"value");if(0===d.length)for(var e=1;e<=12;e++)d.push(e);var f=b.data;_.each(d,function(a){_.find(f,{currMonth:+a})||f.push({currMonth:+a,preOrderRate:0,zsRate:0})}),f=_.sortBy(f,"currMonth"),a.chart2.data[0].datapoints=_.map(f,function(a){return{x:a.currMonth+"月",y:parseFloat(a.preOrderRate)}}),a.chart2.data[1].datapoints=_.map(f,function(a){return{x:a.currMonth+"月",y:parseFloat(a.zsRate)}})})},a.export=function(){var b=a.search1.months;console.log("/api/download/renewdetail?year="+a.search1.year+"&months="+b+"&ccodes=&channelname="),window.open("/api/download/renewdetail?year="+a.search1.year+"&months="+b+"&ccodes=&channelname=")},a.dataExport1=function(){var a=e.tableToExcel("#table1","续费订单占比");f(function(){window.open(a)},100)},a.dataExport2=function(){var a=e.tableToExcel("#table2","预提单与正式订单占比");f(function(){window.open(a)},100)},a.tab2Search()}]),function(){angular.module("channelApp").controller("FD_settings",["$scope","$http",function(a,b){function c(){b.get("/api/codereward").success(function(b){a.fds=b.data})}var d=a.postData={};a.add=function(){return d.LowRate?d.HeighRate?d.RebatesRatio?void b.post("/api/codereward",d).success(function(a){c(),d={}}):void alert("请输入返点"):void alert("请输入最高达成率"):void alert("请输入最低达成率")},c(),a.delete=function(a){confirm("确认要删除？")&&b.delete("/api/codereward?id="+a.Id).success(function(a){c()})}}])}(angular),angular.module("channelApp").controller("FD_AgentList",["$scope","$http","$state","$uibModal","user",function(a,b,c,d,e){function f(){return i.map(function(a){return a.header})}function g(a){var b={1:"通过",2:"审核中",3:"拒审"};return a.forEach(function(a){var c=[];a.StatusStr=b[a.Status],i.forEach(function(b){if(b.col.indexOf(",")>0){var d=b.col.split(",");c.push((a[d[0]]||"")+"<br/>"+(a[d[1]]||""))}else c.push(a[b.col])}),a.cols=c}),a}function h(){var c,d={limit:a.paginator.perPage,offset:a.paginator.perPage*(a.paginator.currentPage-1),channelname:a.channelname};c="/api/agent?",b.get(c+jQuery.param(d)).success(function(b){a.paginator.total=b.Count,a.data=g(b.data)})}a.isCenter=e.get().IsCenter;var i=[{header:"省",col:"ProvinceName"},{header:"市",col:"CityName"},{header:"一级代理商",col:"ChannelName1"},{header:"二级代理商",col:"ChannelName2"},{header:"地址",col:"Address"},{header:"联系方式",col:"Tel,Mobile"}];a.rightAlign=[6];var j="main.agent"===c.$current.name?1:2;i.push({header:"状态",col:"StatusStr"}),a.isHide=2==j,a.headers=f(),a.setTask=function(a){d.open({templateUrl:"views/fd_tasksetting.html",controller:"FD_TaskSetting",size:"lg",resolve:{agent:function(){return a}},backdrop:"static"}).result.then(function(a){h()},function(){})},a.fandian=function(a){d.open({templateUrl:"views/fd_fd.html",controller:"FD_FD",size:"lg",resolve:{agent:function(){return a}},backdrop:"static"}).result.then(function(a){h()},function(){})},a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.pageChanged=function(){h()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},h()}]).controller("FD_TaskSetting",["$scope","$http","$uibModalInstance","agent",function(a,b,c,d){var e=a.year=(new Date).getFullYear();a.tasks=[];for(var f=1;f<13;f++)a.tasks.push({Name:f+"月",ChannelId:d.ChannelId,TaskMonth:[e,f,"1"].join("-"),TaskNumMonth:0});var g={channelId:d.ChannelId,currYear:e};b.get("/api/salestask?"+$.param(g)).success(function(b){b.data.length>0&&(a.saved=!0,_.each(b.data,function(a){a.Name=+a.TaskMonth.split("-")[1]+"月"}),a.tasks=b.data)}),a.ok=function(){var d;d=a.saved?b.put:b.post,d("/api/salestask",a.tasks).success(function(a){a.data&&(alert("保存成功！"),c.close())})},a.cancel=function(){c.dismiss("cancel")}}]).controller("FD_FD",["$scope","$http","$uibModal","$uibModalInstance","agent",function(a,b,c,d,e){function f(){b.get("/api/rewardnotes?"+$.param(h)).success(function(b){_.each(b.data,function(b){var c=_.find(a.tasks,{TaskMonth:b.YearMonth});if(c){+c.TaskMonth.split("-")[1]%3>0?(c.CompleteNum=b.MonthCompleteNum,c.GoalRate=b.MonthGoalRate,c.RewardsMoney=b.RewardsMoney,c.RebatesRatio=b.MonthRebatesRatio,c.fdStatus=b.Status):(c.CompleteNum=b.QuarterCompleteNum,c.GoalRate=b.QuarterGoalRate,c.RewardsMoney=b.RewardsMoney,c.RebatesRatio=b.QuarterRebatesRatio,c.fdStatus=b.Status),c.access=!1,c.fd=b}})})}var g=new Date;g.setMonth(g.getMonth()-1),a.year=g.getFullYear();var h={channelId:e.ChannelId,currYear:a.year};b.get("/api/salestask?"+$.param(h)).success(function(b){b.data.length>0&&(a.saved=!0,_.each(b.data,function(a){a.Name=+a.TaskMonth.split("-")[1]+"月",parseInt(a.TaskMonth.split("-")[1])>g.getMonth()+1?a.access=!1:a.access=!0}),a.tasks=b.data,f())}),a.fetch=function(a){var c={ChannelId:e.ChannelId,YearMonth:a.TaskMonth.substr(0,7)};b.post("/api/rewardnotes",c).success(function(a){f()})},a.fandian=function(a){c.open({templateUrl:"views/fd_fdConfirm.html",controller:"FD_FDConfirm",size:"md",resolve:{fd:function(){return a}},backdrop:"static"}).result.then(function(a){f()},function(){})},a.cancel=function(){d.dismiss("cancel")}}]).controller("FD_FDConfirm",["$scope","$http","$uibModalInstance","fd",function(a,b,c,d){a.rewardsMoney=d.RewardsMoney,a.ok=function(){d.RewardsMoney=a.rewardsMoney,b.put("/api/confirmback",d).success(function(a){a.status&&(alert("保存成功！"),c.close())})},a.cancel=function(){c.dismiss("cancel")}}]),angular.module("channelApp").controller("Users_fq",["$scope","$http","$uibModal",function(a,b,c){function d(b){var c=_.find(a.fqs,{active:!0});c&&(c.active=!1),b.active=!0,f(b)}function e(){b.get("/api/channelpartition").success(function(b){var c=_.find(a.fqs,{active:!0});if(a.fqs=b.data,c){_.find(a.fqs,{Id:c.Id})?e():d(a.fqs[0])}else d(a.fqs[0])})}function f(c){c||(c=_.find(a.fqs,{active:!0})),b.get("/api/channelpartition/"+c.Id).success(function(b){a.qds=b.data})}a.addFQ=function(){c.open({templateUrl:"views/users_addfq.html",controller:"Users_addFQ",size:"sm",backdrop:"static"}).result.then(function(a){e()},function(){})},a.addQD=function(){c.open({templateUrl:"views/users_addQD.html",controller:"Users_addQD",size:"lg",backdrop:"static",resolve:{fqId:function(){return _.find(a.fqs,{active:!0}).Id},channels:function(){return a.qds||[]}}}).result.then(function(a){f()},function(){})},a.deleteFQ=function(a){b.delete("api/channelpartition/"+a).success(function(a){a.status&&e()})},a.activeFQ=d,e()}]).controller("Users_addFQ",["$scope","$http","$uibModalInstance",function(a,b,c){a.ok=function(){var d={PartitionName:a.name};b.post("/api/channelpartition",d).success(function(a){a.status&&(alert("保存成功！"),c.close())})},a.cancel=function(){c.dismiss("cancel")}}]).controller("Users_addQD",["$scope","$http","$uibModalInstance","fqId","channels",function(a,b,c,d,e){function f(){var c={limit:1e3,offset:0};b.get("/api/agent?"+jQuery.param(c)).success(function(b){_.each(b.data,function(a){_.find(e,{ChannelId:a.ChannelId})&&(a.hide=!0)}),a.data=b.data})}f(),a.ok=function(){var e=_.map(_.filter(a.data,{selected:!0}),"ChannelId");b.put("/api/channelpartition/"+d,e).success(function(a){a.data&&(alert("保存成功！"),c.close())}),c.close()},a.cancel=function(){c.dismiss("cancel")}}]),angular.module("channelApp").factory("InvoiceService",["$http","$q",function(a,b){function c(){var c=b.defer();return a({url:k+"balance",method:"GET"}).success(function(a,b,d,e){c.resolve(a)}).error(function(a,b,d,e){c.reject()}),c.promise}function d(){var c=b.defer();return window.sessionStorage&&angular.isString(window.sessionStorage.getItem("invoiceType"))?c.resolve(angular.fromJson(window.sessionStorage.getItem("invoiceType"))):a({url:k+"type"}).success(function(a,b,d,e){angular.isArray(a.data)?(window.sessionStorage.setItem("invoiceType",angular.toJson(a.data)),c.resolve(a.data)):c.resolve([])}).error(function(a,b,d,e){c.reject()}),c.promise}function e(c){var d=b.defer(),e={url:"/api/invoice/addinvoice",method:"POST",data:c};return c.InvoiceId&&(e.url="/api/invoice/putinvoice",e.method="PUT",c.Status=1),a(e).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function f(c){var d=b.defer();return a({url:k,method:"GET",params:c}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function g(c){var d=b.defer();return a({url:k+"issue",method:"GET",params:c}).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function h(c){var d=b.defer(),e={url:k+c.id,method:"GET"};return a(e).success(function(a,b,c,e){d.resolve(a)}).error(function(a,b,c,e){d.reject()}),d.promise}function i(){var c=b.defer();return a({url:"/api/address",method:"GET"}).success(function(a,b,d,e){c.resolve(a)}).error(function(a,b,d,e){c.reject()}),c.promise}function j(){var c=b.defer();return window.sessionStorage&&angular.isString(window.sessionStorage.getItem("project"))?c.resolve(angular.fromJson(window.sessionStorage.getItem("project"))):a({url:k+"project"}).success(function(a,b,d,e){angular.isArray(a.data)?(window.sessionStorage.setItem("project",angular.toJson(a.data)),c.resolve(a.data)):c.resolve([])}).error(function(a,b,d,e){c.reject()}),c.promise}var k="/api/invoice/";return{getBalance:c,getInvoiceType:d,applyInvoice:e,getApplyLists:f,getIssueLists:g,getDetail:h,getAddress:i,getProject:j,getEffective:function(){var c=b.defer();return a({url:k+"invoiceLastmonth",method:"GET"}).success(function(a,b,d,e){c.resolve(a)}).error(function(a,b,d,e){c.reject()}),c.promise},delete:function(b){return a.put("/api/invoice/deleteinvoice/"+b)}}}]),angular.module("channelApp").factory("CustomerService",["$http",function(a){return{cities:function(){return a.get("/api/citybychannel")},industry:function(){return a.get("/api/code/industry")},sales:function(){return a.get("/api/orders/sales")},save:function(b){return b.CustomerId?a.put("/api/customer",b):a.post("/api/customer",b)},getCustomers:function(b){return a.get("/api/customer?"+jQuery.param(b))},custype:function(){return a.get("/api/customer/custype")},delete:function(b){return a.delete("/api/customer/"+b)},getCustomer_pub:function(b){return a.get("/api/opencustomer?"+jQuery.param(b))},rob:function(b,c){return a.put("/api/opencustomer/"+b+"/"+c)},getTrack:function(b){return a.get("/api/customertrack/"+b)},saveTrack:function(b){return a.post("/api/customertrack",b)},trackDelete:function(b){return a.delete("/api/customertrack/"+b)},getSettings:function(b){return a.get("/api/cuscategory?ChannelId="+b)},saveSettings:function(b){return a.put("/api/cuscategory",b)},forward:function(b,c){return a.put("/api/customer/"+b+"/"+c)},getCustomer_total:function(){return a.get("/api/customerforchannel")},getCustomer_total_toc:function(){return a.get("/api/customerforcenter")},getCustomersByDetail:function(b){return a.get("/api/customerbycustype?"+jQuery.param(b))},getSignedCustomers:function(b){return a.get("/api/customer/bill?"+jQuery.param(b))},getObNames:function(){return a.get("/api/code/cusregister")},getObList:function(b){return a.get("/api/cusregister?"+jQuery.param(b))},getObById:function(b){return a.get("/api/cusregister/"+b)},deleteObById:function(b){return a.delete("/api/cusregister/"+b)},getCustomerRemind:function(b){return a.get("/api/signacontract?"+jQuery.param(b))},getCustomerChange:function(b){return a.get("/api/signacontract/my?"+jQuery.param(b))}}}]),angular.module("channelApp").factory("Excel",["$window",function(a){var b=function(b){return a.btoa(unescape(encodeURIComponent(b)))},c=function(a,b){return a.replace(/{(\w+)}/g,function(a,c){return b[c]})};return{tableToExcel:function(a,d){var e=document.createElement("a"),f=$(a),g={worksheet:d,table:f.html()},h="data:application/vnd.ms-excel;base64,"+b(c('<html xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns="http://www.w3.org/TR/REC-html40" encoding="UTF-8"><head encoding="utf-8">\x3c!--[if gte mso 9]><xml version="1.0" encoding="utf-8"><x:ExcelWorkbook><x:ExcelWorksheets><x:ExcelWorksheet><x:Name>{worksheet}</x:Name><x:WorksheetOptions><x:DisplayGridlines/></x:WorksheetOptions></x:ExcelWorksheet></x:ExcelWorksheets></x:ExcelWorkbook></xml><![endif]--\x3e</head><body><table>{table}</table></body></html>',g));e.href=h,e.download=d+".xls",e.setAttribute("style","display: none"),document.documentElement.append(e),e.click(),document.documentElement.removeChild(e)}}}]),angular.module("channelApp").factory("PyCapital",function(){function a(a){var b=a.charCodeAt(0);return b>40869||b<19968?a:d[b]?d[b]:c.charAt(b-19968)}function b(a){for(var b=[""],c=0,d=a.length;c<d;c++){var e=a[c],f=e.length;if(1==f)for(var g=0;g<b.length;g++)b[g]+=e;else{var h=b.slice(0);for(b=[],g=0;g<f;g++){for(var i=h.slice(0),j=0;j<i.length;j++)i[j]+=e.charAt(g);b=b.concat(i)}}}return b}
var c="YDYQSXMWZSSXJBYMGCCZQPSSQBYCDSCDQLDYLYBSSJGYZZJJFKCCLZDHWDWZJLJPFYYNWJJTMYHZWZHFLZPPQHGSCYYYNJQYXXGJHHSDSJNKKTMOMLCRXYPSNQSECCQZGGLLYJLMYZZSECYKYYHQWJSSGGYXYZYJWWKDJHYCHMYXJTLXJYQBYXZLDWRDJRWYSRLDZJPCBZJJBRCFTLECZSTZFXXZHTRQHYBDLYCZSSYMMRFMYQZPWWJJYFCRWFDFZQPYDDWYXKYJAWJFFXYPSFTZYHHYZYSWCJYXSCLCXXWZZXNBGNNXBXLZSZSBSGPYSYZDHMDZBQBZCWDZZYYTZHBTSYYBZGNTNXQYWQSKBPHHLXGYBFMJEBJHHGQTJCYSXSTKZHLYCKGLYSMZXYALMELDCCXGZYRJXSDLTYZCQKCNNJWHJTZZCQLJSTSTBNXBTYXCEQXGKWJYFLZQLYHYXSPSFXLMPBYSXXXYDJCZYLLLSJXFHJXPJBTFFYABYXBHZZBJYZLWLCZGGBTSSMDTJZXPTHYQTGLJSCQFZKJZJQNLZWLSLHDZBWJNCJZYZSQQYCQYRZCJJWYBRTWPYFTWEXCSKDZCTBZHYZZYYJXZCFFZZMJYXXSDZZOTTBZLQWFCKSZSXFYRLNYJMBDTHJXSQQCCSBXYYTSYFBXDZTGBCNSLCYZZPSAZYZZSCJCSHZQYDXLBPJLLMQXTYDZXSQJTZPXLCGLQTZWJBHCTSYJSFXYEJJTLBGXSXJMYJQQPFZASYJNTYDJXKJCDJSZCBARTDCLYJQMWNQNCLLLKBYBZZSYHQQLTWLCCXTXLLZNTYLNEWYZYXCZXXGRKRMTCNDNJTSYYSSDQDGHSDBJGHRWRQLYBGLXHLGTGXBQJDZPYJSJYJCTMRNYMGRZJCZGJMZMGXMPRYXKJNYMSGMZJYMKMFXMLDTGFBHCJHKYLPFMDXLQJJSMTQGZSJLQDLDGJYCALCMZCSDJLLNXDJFFFFJCZFMZFFPFKHKGDPSXKTACJDHHZDDCRRCFQYJKQCCWJDXHWJLYLLZGCFCQDSMLZPBJJPLSBCJGGDCKKDEZSQCCKJGCGKDJTJDLZYCXKLQSCGJCLTFPCQCZGWPJDQYZJJBYJHSJDZWGFSJGZKQCCZLLPSPKJGQJHZZLJPLGJGJJTHJJYJZCZMLZLYQBGJWMLJKXZDZNJQSYZMLJLLJKYWXMKJLHSKJGBMCLYYMKXJQLBMLLKMDXXKWYXYSLMLPSJQQJQXYXFJTJDXMXXLLCXQBSYJBGWYMBGGBCYXPJYGPEPFGDJGBHBNSQJYZJKJKHXQFGQZKFHYGKHDKLLSDJQXPQYKYBNQSXQNSZSWHBSXWHXWBZZXDMNSJBSBKBBZKLYLXGWXDRWYQZMYWSJQLCJXXJXKJEQXSCYETLZHLYYYSDZPAQYZCMTLSHTZCFYZYXYLJSDCJQAGYSLCQLYYYSHMRQQKLDXZSCSSSYDYCJYSFSJBFRSSZQSBXXPXJYSDRCKGJLGDKZJZBDKTCSYQPYHSTCLDJDHMXMCGXYZHJDDTMHLTXZXYLYMOHYJCLTYFBQQXPFBDFHHTKSQHZYYWCNXXCRWHOWGYJLEGWDQCWGFJYCSNTMYTOLBYGWQWESJPWNMLRYDZSZTXYQPZGCWXHNGPYXSHMYQJXZTDPPBFYHZHTJYFDZWKGKZBLDNTSXHQEEGZZYLZMMZYJZGXZXKHKSTXNXXWYLYAPSTHXDWHZYMPXAGKYDXBHNHXKDPJNMYHYLPMGOCSLNZHKXXLPZZLBMLSFBHHGYGYYGGBHSCYAQTYWLXTZQCEZYDQDQMMHTKLLSZHLSJZWFYHQSWSCWLQAZYNYTLSXTHAZNKZZSZZLAXXZWWCTGQQTDDYZTCCHYQZFLXPSLZYGPZSZNGLNDQTBDLXGTCTAJDKYWNSYZLJHHZZCWNYYZYWMHYCHHYXHJKZWSXHZYXLYSKQYSPSLYZWMYPPKBYGLKZHTYXAXQSYSHXASMCHKDSCRSWJPWXSGZJLWWSCHSJHSQNHCSEGNDAQTBAALZZMSSTDQJCJKTSCJAXPLGGXHHGXXZCXPDMMHLDGTYBYSJMXHMRCPXXJZCKZXSHMLQXXTTHXWZFKHCCZDYTCJYXQHLXDHYPJQXYLSYYDZOZJNYXQEZYSQYAYXWYPDGXDDXSPPYZNDLTWRHXYDXZZJHTCXMCZLHPYYYYMHZLLHNXMYLLLMDCPPXHMXDKYCYRDLTXJCHHZZXZLCCLYLNZSHZJZZLNNRLWHYQSNJHXYNTTTKYJPYCHHYEGKCTTWLGQRLGGTGTYGYHPYHYLQYQGCWYQKPYYYTTTTLHYHLLTYTTSPLKYZXGZWGPYDSSZZDQXSKCQNMJJZZBXYQMJRTFFBTKHZKBXLJJKDXJTLBWFZPPTKQTZTGPDGNTPJYFALQMKGXBDCLZFHZCLLLLADPMXDJHLCCLGYHDZFGYDDGCYYFGYDXKSSEBDHYKDKDKHNAXXYBPBYYHXZQGAFFQYJXDMLJCSQZLLPCHBSXGJYNDYBYQSPZWJLZKSDDTACTBXZDYZYPJZQSJNKKTKNJDJGYYPGTLFYQKASDNTCYHBLWDZHBBYDWJRYGKZYHEYYFJMSDTYFZJJHGCXPLXHLDWXXJKYTCYKSSSMTWCTTQZLPBSZDZWZXGZAGYKTYWXLHLSPBCLLOQMMZSSLCMBJCSZZKYDCZJGQQDSMCYTZQQLWZQZXSSFPTTFQMDDZDSHDTDWFHTDYZJYQJQKYPBDJYYXTLJHDRQXXXHAYDHRJLKLYTWHLLRLLRCXYLBWSRSZZSYMKZZHHKYHXKSMDSYDYCJPBZBSQLFCXXXNXKXWYWSDZYQOGGQMMYHCDZTTFJYYBGSTTTYBYKJDHKYXBELHTYPJQNFXFDYKZHQKZBYJTZBXHFDXKDASWTAWAJLDYJSFHBLDNNTNQJTJNCHXFJSRFWHZFMDRYJYJWZPDJKZYJYMPCYZNYNXFBYTFYFWYGDBNZZZDNYTXZEMMQBSQEHXFZMBMFLZZSRXYMJGSXWZJSPRYDJSJGXHJJGLJJYNZZJXHGXKYMLPYYYCXYTWQZSWHWLYRJLPXSLSXMFSWWKLCTNXNYNPSJSZHDZEPTXMYYWXYYSYWLXJQZQXZDCLEEELMCPJPCLWBXSQHFWWTFFJTNQJHJQDXHWLBYZNFJLALKYYJLDXHHYCSTYYWNRJYXYWTRMDRQHWQCMFJDYZMHMYYXJWMYZQZXTLMRSPWWCHAQBXYGZYPXYYRRCLMPYMGKSJSZYSRMYJSNXTPLNBAPPYPYLXYYZKYNLDZYJZCZNNLMZHHARQMPGWQTZMXXMLLHGDZXYHXKYXYCJMFFYYHJFSBSSQLXXNDYCANNMTCJCYPRRNYTYQNYYMBMSXNDLYLYSLJRLXYSXQMLLYZLZJJJKYZZCSFBZXXMSTBJGNXYZHLXNMCWSCYZYFZLXBRNNNYLBNRTGZQYSATSWRYHYJZMZDHZGZDWYBSSCSKXSYHYTXXGCQGXZZSHYXJSCRHMKKBXCZJYJYMKQHZJFNBHMQHYSNJNZYBKNQMCLGQHWLZNZSWXKHLJHYYBQLBFCDSXDLDSPFZPSKJYZWZXZDDXJSMMEGJSCSSMGCLXXKYYYLNYPWWWGYDKZJGGGZGGSYCKNJWNJPCXBJJTQTJWDSSPJXZXNZXUMELPXFSXTLLXCLJXJJLJZXCTPSWXLYDHLYQRWHSYCSQYYBYAYWJJJQFWQCQQCJQGXALDBZZYJGKGXPLTZYFXJLTPADKYQHPMATLCPDCKBMTXYBHKLENXDLEEGQDYMSAWHZMLJTWYGXLYQZLJEEYYBQQFFNLYXRDSCTGJGXYYNKLLYQKCCTLHJLQMKKZGCYYGLLLJDZGYDHZWXPYSJBZKDZGYZZHYWYFQYTYZSZYEZZLYMHJJHTSMQWYZLKYYWZCSRKQYTLTDXWCTYJKLWSQZWBDCQYNCJSRSZJLKCDCDTLZZZACQQZZDDXYPLXZBQJYLZLLLQDDZQJYJYJZYXNYYYNYJXKXDAZWYRDLJYYYRJLXLLDYXJCYWYWNQCCLDDNYYYNYCKCZHXXCCLGZQJGKWPPCQQJYSBZZXYJSQPXJPZBSBDSFNSFPZXHDWZTDWPPTFLZZBZDMYYPQJRSDZSQZSQXBDGCPZSWDWCSQZGMDHZXMWWFYBPDGPHTMJTHZSMMBGZMBZJCFZWFZBBZMQCFMBDMCJXLGPNJBBXGYHYYJGPTZGZMQBQTCGYXJXLWZKYDPDYMGCFTPFXYZTZXDZXTGKMTYBBCLBJASKYTSSQYYMSZXFJEWLXLLSZBQJJJAKLYLXLYCCTSXMCWFKKKBSXLLLLJYXTYLTJYYTDPJHNHNNKBYQNFQYYZBYYESSESSGDYHFHWTCJBSDZZTFDMXHCNJZYMQWSRYJDZJQPDQBBSTJGGFBKJBXTGQHNGWJXJGDLLTHZHHYYYYYYSXWTYYYCCBDBPYPZYCCZYJPZYWCBDLFWZCWJDXXHYHLHWZZXJTCZLCDPXUJCZZZLYXJJTXPHFXWPYWXZPTDZZBDZCYHJHMLXBQXSBYLRDTGJRRCTTTHYTCZWMXFYTWWZCWJWXJYWCSKYBZSCCTZQNHXNWXXKHKFHTSWOCCJYBCMPZZYKBNNZPBZHHZDLSYDDYTYFJPXYNGFXBYQXCBHXCPSXTYZDMKYSNXSXLHKMZXLYHDHKWHXXSSKQYHHCJYXGLHZXCSNHEKDTGZXQYPKDHEXTYKCNYMYYYPKQYYYKXZLTHJQTBYQHXBMYHSQCKWWYLLHCYYLNNEQXQWMCFBDCCMLJGGXDQKTLXKGNQCDGZJWYJJLYHHQTTTNWCHMXCXWHWSZJYDJCCDBQCDGDNYXZTHCQRXCBHZTQCBXWGQWYYBXHMBYMYQTYEXMQKYAQYRGYZSLFYKKQHYSSQYSHJGJCNXKZYCXSBXYXHYYLSTYCXQTHYSMGSCPMMGCCCCCMTZTASMGQZJHKLOSQYLSWTMXSYQKDZLJQQYPLSYCZTCQQPBBQJZCLPKHQZYYXXDTDDTSJCXFFLLCHQXMJLWCJCXTSPYCXNDTJSHJWXDQQJSKXYAMYLSJHMLALYKXCYYDMNMDQMXMCZNNCYBZKKYFLMCHCMLHXRCJJHSYLNMTJZGZGYWJXSRXCWJGJQHQZDQJDCJJZKJKGDZQGJJYJYLXZXXCDQHHHEYTMHLFSBDJSYYSHFYSTCZQLPBDRFRZTZYKYWHSZYQKWDQZRKMSYNBCRXQBJYFAZPZZEDZCJYWBCJWHYJBQSZYWRYSZPTDKZPFPBNZTKLQYHBBZPNPPTYZZYBQNYDCPJMMCYCQMCYFZZDCMNLFPBPLNGQJTBTTNJZPZBBZNJKLJQYLNBZQHKSJZNGGQSZZKYXSHPZSNBCGZKDDZQANZHJKDRTLZLSWJLJZLYWTJNDJZJHXYAYNCBGTZCSSQMNJPJYTYSWXZFKWJQTKHTZPLBHSNJZSYZBWZZZZLSYLSBJHDWWQPSLMMFBJDWAQYZTCJTBNNWZXQXCDSLQGDSDPDZHJTQQPSWLYYJZLGYXYZLCTCBJTKTYCZJTQKBSJLGMGZDMCSGPYNJZYQYYKNXRPWSZXMTNCSZZYXYBYHYZAXYWQCJTLLCKJJTJHGDXDXYQYZZBYWDLWQCGLZGJGQRQZCZSSBCRPCSKYDZNXJSQGXSSJMYDNSTZTPBDLTKZWXQWQTZEXNQCZGWEZKSSBYBRTSSSLCCGBPSZQSZLCCGLLLZXHZQTHCZMQGYZQZNMCOCSZJMMZSQPJYGQLJYJPPLDXRGZYXCCSXHSHGTZNLZWZKJCXTCFCJXLBMQBCZZWPQDNHXLJCTHYZLGYLNLSZZPCXDSCQQHJQKSXZPBAJYEMSMJTZDXLCJYRYYNWJBNGZZTMJXLTBSLYRZPYLSSCNXPHLLHYLLQQZQLXYMRSYCXZLMMCZLTZSDWTJJLLNZGGQXPFSKYGYGHBFZPDKMWGHCXMSGDXJMCJZDYCABXJDLNBCDQYGSKYDQTXDJJYXMSZQAZDZFSLQXYJSJZYLBTXXWXQQZBJZUFBBLYLWDSLJHXJYZJWTDJCZFQZQZZDZSXZZQLZCDZFJHYSPYMPQZMLPPLFFXJJNZZYLSJEYQZFPFZKSYWJJJHRDJZZXTXXGLGHYDXCSKYSWMMZCWYBAZBJKSHFHJCXMHFQHYXXYZFTSJYZFXYXPZLCHMZMBXHZZSXYFYMNCWDABAZLXKTCSHHXKXJJZJSTHYGXSXYYHHHJWXKZXSSBZZWHHHCWTZZZPJXSNXQQJGZYZYWLLCWXZFXXYXYHXMKYYSWSQMNLNAYCYSPMJKHWCQHYLAJJMZXHMMCNZHBHXCLXTJPLTXYJHDYYLTTXFSZHYXXSJBJYAYRSMXYPLCKDUYHLXRLNLLSTYZYYQYGYHHSCCSMZCTZQXKYQFPYYRPFFLKQUNTSZLLZMWWTCQQYZWTLLMLMPWMBZSSTZRBPDDTLQJJBXZCSRZQQYGWCSXFWZLXCCRSZDZMCYGGDZQSGTJSWLJMYMMZYHFBJDGYXCCPSHXNZCSBSJYJGJMPPWAFFYFNXHYZXZYLREMZGZCYZSSZDLLJCSQFNXZKPTXZGXJJGFMYYYSNBTYLBNLHPFZDCYFBMGQRRSSSZXYSGTZRNYDZZCDGPJAFJFZKNZBLCZSZPSGCYCJSZLMLRSZBZZLDLSLLYSXSQZQLYXZLSKKBRXBRBZCYCXZZZEEYFGKLZLYYHGZSGZLFJHGTGWKRAAJYZKZQTSSHJJXDCYZUYJLZYRZDQQHGJZXSSZBYKJPBFRTJXLLFQWJHYLQTYMBLPZDXTZYGBDHZZRBGXHWNJTJXLKSCFSMWLSDQYSJTXKZSCFWJLBXFTZLLJZLLQBLSQMQQCGCZFPBPHZCZJLPYYGGDTGWDCFCZQYYYQYSSCLXZSKLZZZGFFCQNWGLHQYZJJCZLQZZYJPJZZBPDCCMHJGXDQDGDLZQMFGPSYTSDYFWWDJZJYSXYYCZCYHZWPBYKXRYLYBHKJKSFXTZJMMCKHLLTNYYMSYXYZPYJQYCSYCWMTJJKQYRHLLQXPSGTLYYCLJSCPXJYZFNMLRGJJTYZBXYZMSJYJHHFZQMSYXRSZCWTLRTQZSSTKXGQKGSPTGCZNJSJCQCXHMXGGZTQYDJKZDLBZSXJLHYQGGGTHQSZPYHJHHGYYGKGGCWJZZYLCZLXQSFTGZSLLLMLJSKCTBLLZZSZMMNYTPZSXQHJCJYQXYZXZQZCPSHKZZYSXCDFGMWQRLLQXRFZTLYSTCTMJCXJJXHJNXTNRZTZFQYHQGLLGCXSZSJDJLJCYDSJTLNYXHSZXCGJZYQPYLFHDJSBPCCZHJJJQZJQDYBSSLLCMYTTMQTBHJQNNYGKYRQYQMZGCJKPDCGMYZHQLLSLLCLMHOLZGDYYFZSLJCQZLYLZQJESHNYLLJXGJXLYSYYYXNBZLJSSZCQQCJYLLZLTJYLLZLLBNYLGQCHXYYXOXCXQKYJXXXYKLXSXXYQXCYKQXQCSGYXXYQXYGYTQOHXHXPYXXXULCYEYCHZZCBWQBBWJQZSCSZSSLZYLKDESJZWMYMCYTSDSXXSCJPQQSQYLYYZYCMDJDZYWCBTJSYDJKCYDDJLBDJJSODZYSYXQQYXDHHGQQYQHDYXWGMMMAJDYBBBPPBCMUUPLJZSMTXERXJMHQNUTPJDCBSSMSSSTKJTSSMMTRCPLZSZMLQDSDMJMQPNQDXCFYNBFSDQXYXHYAYKQYDDLQYYYSSZBYDSLNTFQTZQPZMCHDHCZCWFDXTMYQSPHQYYXSRGJCWTJTZZQMGWJJTJHTQJBBHWZPXXHYQFXXQYWYYHYSCDYDHHQMNMTMWCPBSZPPZZGLMZFOLLCFWHMMSJZTTDHZZYFFYTZZGZYSKYJXQYJZQBHMBZZLYGHGFMSHPZFZSNCLPBQSNJXZSLXXFPMTYJYGBXLLDLXPZJYZJYHHZCYWHJYLSJEXFSZZYWXKZJLUYDTMLYMQJPWXYHXSKTQJEZRPXXZHHMHWQPWQLYJJQJJZSZCPHJLCHHNXJLQWZJHBMZYXBDHHYPZLHLHLGFWLCHYYTLHJXCJMSCPXSTKPNHQXSRTYXXTESYJCTLSSLSTDLLLWWYHDHRJZSFGXTSYCZYNYHTDHWJSLHTZDQDJZXXQHGYLTZPHCSQFCLNJTCLZPFSTPDYNYLGMJLLYCQHYSSHCHYLHQYQTMZYPBYWRFQYKQSYSLZDQJMPXYYSSRHZJNYWTQDFZBWWTWWRXCWHGYHXMKMYYYQMSMZHNGCEPMLQQMTCWCTMMPXJPJJHFXYYZSXZHTYBMSTSYJTTQQQYYLHYNPYQZLCYZHZWSMYLKFJXLWGXYPJYTYSYXYMZCKTTWLKSMZSYLMPWLZWXWQZSSAQSYXYRHSSNTSRAPXCPWCMGDXHXZDZYFJHGZTTSBJHGYZSZYSMYCLLLXBTYXHBBZJKSSDMALXHYCFYGMQYPJYCQXJLLLJGSLZGQLYCJCCZOTYXMTMTTLLWTGPXYMZMKLPSZZZXHKQYSXCTYJZYHXSHYXZKXLZWPSQPYHJWPJPWXQQYLXSDHMRSLZZYZWTTCYXYSZZSHBSCCSTPLWSSCJCHNLCGCHSSPHYLHFHHXJSXYLLNYLSZDHZXYLSXLWZYKCLDYAXZCMDDYSPJTQJZLNWQPSSSWCTSTSZLBLNXSMNYYMJQBQHRZWTYYDCHQLXKPZWBGQYBKFCMZWPZLLYYLSZYDWHXPSBCMLJBSCGBHXLQHYRLJXYSWXWXZSLDFHLSLYNJLZYFLYJYCDRJLFSYZFSLLCQYQFGJYHYXZLYLMSTDJCYHBZLLNWLXXYGYYHSMGDHXXHHLZZJZXCZZZCYQZFNGWPYLCPKPYYPMCLQKDGXZGGWQBDXZZKZFBXXLZXJTPJPTTBYTSZZDWSLCHZHSLTYXHQLHYXXXYYZYSWTXZKHLXZXZPYHGCHKCFSYHUTJRLXFJXPTZTWHPLYXFCRHXSHXKYXXYHZQDXQWULHYHMJTBFLKHTXCWHJFWJCFPQRYQXCYYYQYGRPYWSGSUNGWCHKZDXYFLXXHJJBYZWTSXXNCYJJYMSWZJQRMHXZWFQSYLZJZGBHYNSLBGTTCSYBYXXWXYHXYYXNSQYXMQYWRGYQLXBBZLJSYLPSYTJZYHYZAWLRORJMKSCZJXXXYXCHDYXRYXXJDTSQFXLYLTSFFYXLMTYJMJUYYYXLTZCSXQZQHZXLYYXZHDNBRXXXJCTYHLBRLMBRLLAXKYLLLJLYXXLYCRYLCJTGJCMTLZLLCYZZPZPCYAWHJJFYBDYYZSMPCKZDQYQPBPCJPDCYZMDPBCYYDYCNNPLMTMLRMFMMGWYZBSJGYGSMZQQQZTXMKQWGXLLPJGZBQCDJJJFPKJKCXBLJMSWMDTQJXLDLPPBXCWRCQFBFQJCZAHZGMYKPHYYHZYKNDKZMBPJYXPXYHLFPNYYGXJDBKXNXHJMZJXSTRSTLDXSKZYSYBZXJLXYSLBZYSLHXJPFXPQNBYLLJQKYGZMCYZZYMCCSLCLHZFWFWYXZMWSXTYNXJHPYYMCYSPMHYSMYDYSHQYZCHMJJMZCAAGCFJBBHPLYZYLXXSDJGXDHKXXTXXNBHRMLYJSLTXMRHNLXQJXYZLLYSWQGDLBJHDCGJYQYCMHWFMJYBMBYJYJWYMDPWHXQLDYGPDFXXBCGJSPCKRSSYZJMSLBZZJFLJJJLGXZGYXYXLSZQYXBEXYXHGCXBPLDYHWETTWWCJMBTXCHXYQXLLXFLYXLLJLSSFWDPZSMYJCLMWYTCZPCHQEKCQBWLCQYDPLQPPQZQFJQDJHYMMCXTXDRMJWRHXCJZYLQXDYYNHYYHRSLSRSYWWZJYMTLTLLGTQCJZYABTCKZCJYCCQLJZQXALMZYHYWLWDXZXQDLLQSHGPJFJLJHJABCQZDJGTKHSSTCYJLPSWZLXZXRWGLDLZRLZXTGSLLLLZLYXXWGDZYGBDPHZPBRLWSXQBPFDWOFMWHLYPCBJCCLDMBZPBZZLCYQXLDOMZBLZWPDWYYGDSTTHCSQSCCRSSSYSLFYBFNTYJSZDFNDPDHDZZMBBLSLCMYFFGTJJQWFTMTPJWFNLBZCMMJTGBDZLQLPYFHYYMJYLSDCHDZJWJCCTLJCLDTLJJCPDDSQDSSZYBNDBJLGGJZXSXNLYCYBJXQYCBYLZCFZPPGKCXZDZFZTJJFJSJXZBNZYJQTTYJYHTYCZHYMDJXTTMPXSPLZCDWSLSHXYPZGTFMLCJTYCBPMGDKWYCYZCDSZZYHFLYCTYGWHKJYYLSJCXGYWJCBLLCSNDDBTZBSCLYZCZZSSQDLLMQYYHFSLQLLXFTYHABXGWNYWYYPLLSDLDLLBJCYXJZMLHLJDXYYQYTDLLLBUGBFDFBBQJZZMDPJHGCLGMJJPGAEHHBWCQXAXHHHZCHXYPHJAXHLPHJPGPZJQCQZGJJZZUZDMQYYBZZPHYHYBWHAZYJHYKFGDPFQSDLZMLJXKXGALXZDAGLMDGXMWZQYXXDXXPFDMMSSYMPFMDMMKXKSYZYSHDZKXSYSMMZZZMSYDNZZCZXFPLSTMZDNMXCKJMZTYYMZMZZMSXHHDCZJEMXXKLJSTLWLSQLYJZLLZJSSDPPMHNLZJCZYHMXXHGZCJMDHXTKGRMXFWMCGMWKDTKSXQMMMFZZYDKMSCLCMPCGMHSPXQPZDSSLCXKYXTWLWJYAHZJGZQMCSNXYYMMPMLKJXMHLMLQMXCTKZMJQYSZJSYSZHSYJZJCDAJZYBSDQJZGWZQQXFKDMSDJLFWEHKZQKJPEYPZYSZCDWYJFFMZZYLTTDZZEFMZLBNPPLPLPEPSZALLTYLKCKQZKGENQLWAGYXYDPXLHSXQQWQCQXQCLHYXXMLYCCWLYMQYSKGCHLCJNSZKPYZKCQZQLJPDMDZHLASXLBYDWQLWDNBQCRYDDZTJYBKBWSZDXDTNPJDTCTQDFXQQMGNXECLTTBKPWSLCTYQLPWYZZKLPYGZCQQPLLKCCYLPQMZCZQCLJSLQZDJXLDDHPZQDLJJXZQDXYZQKZLJCYQDYJPPYPQYKJYRMPCBYMCXKLLZLLFQPYLLLMBSGLCYSSLRSYSQTMXYXZQZFDZUYSYZTFFMZZSMZQHZSSCCMLYXWTPZGXZJGZGSJSGKDDHTQGGZLLBJDZLCBCHYXYZHZFYWXYZYMSDBZZYJGTSMTFXQYXQSTDGSLNXDLRYZZLRYYLXQHTXSRTZNGZXBNQQZFMYKMZJBZYMKBPNLYZPBLMCNQYZZZSJZHJCTZKHYZZJRDYZHNPXGLFZTLKGJTCTSSYLLGZRZBBQZZKLPKLCZYSSUYXBJFPNJZZXCDWXZYJXZZDJJKGGRSRJKMSMZJLSJYWQSKYHQJSXPJZZZLSNSHRNYPZTWCHKLPSRZLZXYJQXQKYSJYCZTLQZYBBYBWZPQDWWYZCYTJCJXCKCWDKKZXSGKDZXWWYYJQYYTCYTDLLXWKCZKKLCCLZCQQDZLQLCSFQCHQHSFSMQZZLNBJJZBSJHTSZDYSJQJPDLZCDCWJKJZZLPYCGMZWDJJBSJQZSYZYHHXJPBJYDSSXDZNCGLQMBTSFSBPDZDLZNFGFJGFSMPXJQLMBLGQCYYXBQKDJJQYRFKZTJDHCZKLBSDZCFJTPLLJGXHYXZCSSZZXSTJYGKGCKGYOQXJPLZPBPGTGYJZGHZQZZLBJLSQFZGKQQJZGYCZBZQTLDXRJXBSXXPZXHYZYCLWDXJJHXMFDZPFZHQHQMQGKSLYHTYCGFRZGNQXCLPDLBZCSCZQLLJBLHBZCYPZZPPDYMZZSGYHCKCPZJGSLJLNSCDSLDLXBMSTLDDFJMKDJDHZLZXLSZQPQPGJLLYBDSZGQLBZLSLKYYHZTTNTJYQTZZPSZQZTLLJTYYLLQLLQYZQLBDZLSLYYZYMDFSZSNHLXZNCZQZPBWSKRFBSYZMTHBLGJPMCZZLSTLXSHTCSYZLZBLFEQHLXFLCJLYLJQCBZLZJHHSSTBRMHXZHJZCLXFNBGXGTQJCZTMSFZKJMSSNXLJKBHSJXNTNLZDNTLMSJXGZJYJCZXYJYJWRWWQNZTNFJSZPZSHZJFYRDJSFSZJZBJFZQZZHZLXFYSBZQLZSGYFTZDCSZXZJBQMSZKJRHYJZCKMJKHCHGTXKXQGLXPXFXTRTYLXJXHDTSJXHJZJXZWZLCQSBTXWXGXTXXHXFTSDKFJHZYJFJXRZSDLLLTQSQQZQWZXSYQTWGWBZCGZLLYZBCLMQQTZHZXZXLJFRMYZFLXYSQXXJKXRMQDZDMMYYBSQBHGZMWFWXGMXLZPYYTGZYCCDXYZXYWGSYJYZNBHPZJSQSYXSXRTFYZGRHZTXSZZTHCBFCLSYXZLZQMZLMPLMXZJXSFLBYZMYQHXJSXRXSQZZZSSLYFRCZJRCRXHHZXQYDYHXSJJHZCXZBTYNSYSXJBQLPXZQPYMLXZKYXLXCJLCYSXXZZLXDLLLJJYHZXGYJWKJRWYHCPSGNRZLFZWFZZNSXGXFLZSXZZZBFCSYJDBRJKRDHHGXJLJJTGXJXXSTJTJXLYXQFCSGSWMSBCTLQZZWLZZKXJMLTMJYHSDDBXGZHDLBMYJFRZFSGCLYJBPMLYSMSXLSZJQQHJZFXGFQFQBPXZGYYQXGZTCQWYLTLGWSGWHRLFSFGZJMGMGBGTJFSYZZGZYZAFLSSPMLPFLCWBJZCLJJMZLPJJLYMQDMYYYFBGYGYZMLYZDXQYXRQQQHSYYYQXYLJTYXFSFSLLGNQCYHYCWFHCCCFXPYLYPLLZYXXXXXKQHHXSHJZCFZSCZJXCPZWHHHHHAPYLQALPQAFYHXDYLUKMZQGGGDDESRNNZLTZGCHYPPYSQJJHCLLJTOLNJPZLJLHYMHEYDYDSQYCDDHGZUNDZCLZYZLLZNTNYZGSLHSLPJJBDGWXPCDUTJCKLKCLWKLLCASSTKZZDNQNTTLYYZSSYSSZZRYLJQKCQDHHCRXRZYDGRGCWCGZQFFFPPJFZYNAKRGYWYQPQXXFKJTSZZXSWZDDFBBXTBGTZKZNPZZPZXZPJSZBMQHKCYXYLDKLJNYPKYGHGDZJXXEAHPNZKZTZCMXCXMMJXNKSZQNMNLWBWWXJKYHCPSTMCSQTZJYXTPCTPDTNNPGLLLZSJLSPBLPLQHDTNJNLYYRSZFFJFQWDPHZDWMRZCCLODAXNSSNYZRESTYJWJYJDBCFXNMWTTBYLWSTSZGYBLJPXGLBOCLHPCBJLTMXZLJYLZXCLTPNCLCKXTPZJSWCYXSFYSZDKNTLBYJCYJLLSTGQCBXRYZXBXKLYLHZLQZLNZCXWJZLJZJNCJHXMNZZGJZZXTZJXYCYYCXXJYYXJJXSSSJSTSSTTPPGQTCSXWZDCSYFPTFBFHFBBLZJCLZZDBXGCXLQPXKFZFLSYLTUWBMQJHSZBMDDBCYSCCLDXYCDDQLYJJWMQLLCSGLJJSYFPYYCCYLTJANTJJPWYCMMGQYYSXDXQMZHSZXPFTWWZQSWQRFKJLZJQQYFBRXJHHFWJJZYQAZMYFRHCYYBYQWLPEXCCZSTYRLTTDMQLYKMBBGMYYJPRKZNPBSXYXBHYZDJDNGHPMFSGMWFZMFQMMBCMZZCJJLCNUXYQLMLRYGQZCYXZLWJGCJCGGMCJNFYZZJHYCPRRCMTZQZXHFQGTJXCCJEAQCRJYHPLQLSZDJRBCQHQDYRHYLYXJSYMHZYDWLDFRYHBPYDTSSCNWBXGLPZMLZZTQSSCPJMXXYCSJYTYCGHYCJWYRXXLFEMWJNMKLLSWTXHYYYNCMMCWJDQDJZGLLJWJRKHPZGGFLCCSCZMCBLTBHBQJXQDSPDJZZGKGLFQYWBZYZJLTSTDHQHCTCBCHFLQMPWDSHYYTQWCNZZJTLBYMBPDYYYXSQKXWYYFLXXNCWCXYPMAELYKKJMZZZBRXYYQJFLJPFHHHYTZZXSGQQMHSPGDZQWBWPJHZJDYSCQWZKTXXSQLZYYMYSDZGRXCKKUJLWPYSYSCSYZLRMLQSYLJXBCXTLWDQZPCYCYKPPPNSXFYZJJRCEMHSZMSXLXGLRWGCSTLRSXBZGBZGZTCPLUJLSLYLYMTXMTZPALZXPXJTJWTCYYZLBLXBZLQMYLXPGHDSLSSDMXMBDZZSXWHAMLCZCPJMCNHJYSNSYGCHSKQMZZQDLLKABLWJXSFMOCDXJRRLYQZKJMYBYQLYHETFJZFRFKSRYXFJTWDSXXSYSQJYSLYXWJHSNLXYYXHBHAWHHJZXWMYLJCSSLKYDZTXBZSYFDXGXZJKHSXXYBSSXDPYNZWRPTQZCZENYGCXQFJYKJBZMLJCMQQXUOXSLYXXLYLLJDZBTYMHPFSTTQQWLHOKYBLZZALZXQLHZWRRQHLSTMYPYXJJXMQSJFNBXYXYJXXYQYLTHYLQYFMLKLJTMLLHSZWKZHLJMLHLJKLJSTLQXYLMBHHLNLZXQJHXCFXXLHYHJJGBYZZKBXSCQDJQDSUJZYYHZHHMGSXCSYMXFEBCQWWRBPYYJQTYZCYQYQQZYHMWFFHGZFRJFCDPXNTQYZPDYKHJLFRZXPPXZDBBGZQSTLGDGYLCQMLCHHMFYWLZYXKJLYPQHSYWMQQGQZMLZJNSQXJQSYJYCBEHSXFSZPXZWFLLBCYYJDYTDTHWZSFJMQQYJLMQXXLLDTTKHHYBFPWTYYSQQWNQWLGWDEBZWCMYGCULKJXTMXMYJSXHYBRWFYMWFRXYQMXYSZTZZTFYKMLDHQDXWYYNLCRYJBLPSXCXYWLSPRRJWXHQYPHTYDNXHHMMYWYTZCSQMTSSCCDALWZTCPQPYJLLQZYJSWXMZZMMYLMXCLMXCZMXMZSQTZPPQQBLPGXQZHFLJJHYTJSRXWZXSCCDLXTYJDCQJXSLQYCLZXLZZXMXQRJMHRHZJBHMFLJLMLCLQNLDXZLLLPYPSYJYSXCQQDCMQJZZXHNPNXZMEKMXHYKYQLXSXTXJYYHWDCWDZHQYYBGYBCYSCFGPSJNZDYZZJZXRZRQJJYMCANYRJTLDPPYZBSTJKXXZYPFDWFGZZRPYMTNGXZQBYXNBUFNQKRJQZMJEGRZGYCLKXZDSKKNSXKCLJSPJYYZLQQJYBZSSQLLLKJXTBKTYLCCDDBLSPPFYLGYDTZJYQGGKQTTFZXBDKTYYHYBBFYTYYBCLPDYTGDHRYRNJSPTCSNYJQHKLLLZSLYDXXWBCJQSPXBPJZJCJDZFFXXBRMLAZHCSNDLBJDSZBLPRZTSWSBXBCLLXXLZDJZSJPYLYXXYFTFFFBHJJXGBYXJPMMMPSSJZJMTLYZJXSWXTYLEDQPJMYGQZJGDJLQJWJQLLSJGJGYGMSCLJJXDTYGJQJQJCJZCJGDZZSXQGSJGGCXHQXSNQLZZBXHSGZXCXYLJXYXYYDFQQJHJFXDHCTXJYRXYSQTJXYEFYYSSYYJXNCYZXFXMSYSZXYYSCHSHXZZZGZZZGFJDLTYLNPZGYJYZYYQZPBXQBDZTZCZYXXYHHSQXSHDHGQHJHGYWSZTMZMLHYXGEBTYLZKQWYTJZRCLEKYSTDBCYKQQSAYXCJXWWGSBHJYZYDHCSJKQCXSWXFLTYNYZPZCCZJQTZWJQDZZZQZLJJXLSBHPYXXPSXSHHEZTXFPTLQYZZXHYTXNCFZYYHXGNXMYWXTZSJPTHHGYMXMXQZXTSBCZYJYXXTYYZYPCQLMMSZMJZZLLZXGXZAAJZYXJMZXWDXZSXZDZXLEYJJZQBHZWZZZQTZPSXZTDSXJJJZNYAZPHXYYSRNQDTHZHYYKYJHDZXZLSWCLYBZYECWCYCRYLCXNHZYDZYDYJDFRJJHTRSQTXYXJRJHOJYNXELXSFSFJZGHPZSXZSZDZCQZBYYKLSGSJHCZSHDGQGXYZGXCHXZJWYQWGYHKSSEQZZNDZFKWYSSTCLZSTSYMCDHJXXYWEYXCZAYDMPXMDSXYBSQMJMZJMTZQLPJYQZCGQHXJHHLXXHLHDLDJQCLDWBSXFZZYYSCHTYTYYBHECXHYKGJPXHHYZJFXHWHBDZFYZBCAPNPGNYDMSXHMMMMAMYNBYJTMPXYYMCTHJBZYFCGTYHWPHFTWZZEZSBZEGPFMTSKFTYCMHFLLHGPZJXZJGZJYXZSBBQSCZZLZCCSTPGXMJSFTCCZJZDJXCYBZLFCJSYZFGSZLYBCWZZBYZDZYPSWYJZXZBDSYUXLZZBZFYGCZXBZHZFTPBGZGEJBSTGKDMFHYZZJHZLLZZGJQZLSFDJSSCBZGPDLFZFZSZYZYZSYGCXSNXXCHCZXTZZLJFZGQSQYXZJQDCCZTQCDXZJYQJQCHXZTDLGSCXZSYQJQTZWLQDQZTQCHQQJZYEZZZPBWKDJFCJPZTYPQYQTTYNLMBDKTJZPQZQZZFPZSBNJLGYJDXJDZZKZGQKXDLPZJTCJDQBXDJQJSTCKNXBXZMSLYJCQMTJQWWCJQNJNLLLHJCWQTBZQYDZCZPZZDZYDDCYZZZCCJTTJFZDPRRTZTJDCQTQZDTJNPLZBCLLCTZSXKJZQZPZLBZRBTJDCXFCZDBCCJJLTQQPLDCGZDBBZJCQDCJWYNLLZYZCCDWLLXWZLXRXNTQQCZXKQLSGDFQTDDGLRLAJJTKUYMKQLLTZYTDYYCZGJWYXDXFRSKSTQTENQMRKQZHHQKDLDAZFKYPBGGPZREBZZYKZZSPEGJXGYKQZZZSLYSYYYZWFQZYLZZLZHWCHKYPQGNPGBLPLRRJYXCCSYYHSFZFYBZYYTGZXYLXCZWXXZJZBLFFLGSKHYJZEYJHLPLLLLCZGXDRZELRHGKLZZYHZLYQSZZJZQLJZFLNBHGWLCZCFJYSPYXZLZLXGCCPZBLLCYBBBBUBBCBPCRNNZCZYRBFSRLDCGQYYQXYGMQZWTZYTYJXYFWTEHZZJYWLCCNTZYJJZDEDPZDZTSYQJHDYMBJNYJZLXTSSTPHNDJXXBYXQTZQDDTJTDYYTGWSCSZQFLSHLGLBCZPHDLYZJYCKWTYTYLBNYTSDSYCCTYSZYYEBHEXHQDTWNYGYCLXTSZYSTQMYGZAZCCSZZDSLZCLZRQXYYELJSBYMXSXZTEMBBLLYYLLYTDQYSHYMRQWKFKBFXNXSBYCHXBWJYHTQBPBSBWDZYLKGZSKYHXQZJXHXJXGNLJKZLYYCDXLFYFGHLJGJYBXQLYBXQPQGZTZPLNCYPXDJYQYDYMRBESJYYHKXXSTMXRCZZYWXYQYBMCLLYZHQYZWQXDBXBZWZMSLPDMYSKFMZKLZCYQYCZLQXFZZYDQZPZYGYJYZMZXDZFYFYTTQTZHGSPCZMLCCYTZXJCYTJMKSLPZHYSNZLLYTPZCTZZCKTXDHXXTQCYFKSMQCCYYAZHTJPCYLZLYJBJXTPNYLJYYNRXSYLMMNXJSMYBCSYSYLZYLXJJQYLDZLPQBFZZBLFNDXQKCZFYWHGQMRDSXYCYTXNQQJZYYPFZXDYZFPRXEJDGYQBXRCNFYYQPGHYJDYZXGRHTKYLNWDZNTSMPKLBTHBPYSZBZTJZSZZJTYYXZPHSSZZBZCZPTQFZMYFLYPYBBJQXZMXXDJMTSYSKKBJZXHJCKLPSMKYJZCXTMLJYXRZZQSLXXQPYZXMKYXXXJCLJPRMYYGADYSKQLSNDHYZKQXZYZTCGHZTLMLWZYBWSYCTBHJHJFCWZTXWYTKZLXQSHLYJZJXTMPLPYCGLTBZZTLZJCYJGDTCLKLPLLQPJMZPAPXYZLKKTKDZCZZBNZDYDYQZJYJGMCTXLTGXSZLMLHBGLKFWNWZHDXUHLFMKYSLGXDTWWFRJEJZTZHYDXYKSHWFZCQSHKTMQQHTZHYMJDJSKHXZJZBZZXYMPAGQMSTPXLSKLZYNWRTSQLSZBPSPSGZWYHTLKSSSWHZZLYYTNXJGMJSZSUFWNLSOZTXGXLSAMMLBWLDSZYLAKQCQCTMYCFJBSLXCLZZCLXXKSBZQCLHJPSQPLSXXCKSLNHPSFQQYTXYJZLQLDXZQJZDYYDJNZPTUZDSKJFSLJHYLZSQZLBTXYDGTQFDBYAZXDZHZJNHHQBYKNXJJQCZMLLJZKSPLDYCLBBLXKLELXJLBQYCXJXGCNLCQPLZLZYJTZLJGYZDZPLTQCSXFDMNYCXGBTJDCZNBGBQYQJWGKFHTNPYQZQGBKPBBYZMTJDYTBLSQMPSXTBNPDXKLEMYYCJYNZCTLDYKZZXDDXHQSHDGMZSJYCCTAYRZLPYLTLKXSLZCGGEXCLFXLKJRTLQJAQZNCMBYDKKCXGLCZJZXJHPTDJJMZQYKQSECQZDSHHADMLZFMMZBGNTJNNLGBYJBRBTMLBYJDZXLCJLPLDLPCQDHLXZLYCBLCXZZJADJLNZMMSSSMYBHBSQKBHRSXXJMXSDZNZPXLGBRHWGGFCXGMSKLLTSJYYCQLTSKYWYYHYWXBXQYWPYWYKQLSQPTNTKHQCWDQKTWPXXHCPTHTWUMSSYHBWCRWXHJMKMZNGWTMLKFGHKJYLSYYCXWHYECLQHKQHTTQKHFZLDXQWYZYYDESBPKYRZPJFYYZJCEQDZZDLATZBBFJLLCXDLMJSSXEGYGSJQXCWBXSSZPDYZCXDNYXPPZYDLYJCZPLTXLSXYZYRXCYYYDYLWWNZSAHJSYQYHGYWWAXTJZDAXYSRLTDPSSYYFNEJDXYZHLXLLLZQZSJNYQYQQXYJGHZGZCYJCHZLYCDSHWSHJZYJXCLLNXZJJYYXNFXMWFPYLCYLLABWDDHWDXJMCXZTZPMLQZHSFHZYNZTLLDYWLSLXHYMMYLMBWWKYXYADTXYLLDJPYBPWUXJMWMLLSAFDLLYFLBHHHBQQLTZJCQJLDJTFFKMMMBYTHYGDCQRDDWRQJXNBYSNWZDBYYTBJHPYBYTTJXAAHGQDQTMYSTQXKBTZPKJLZRBEQQSSMJJBDJOTGTBXPGBKTLHQXJJJCTHXQDWJLWRFWQGWSHCKRYSWGFTGYGBXSDWDWRFHWYTJJXXXJYZYSLPYYYPAYXHYDQKXSHXYXGSKQHYWFDDDPPLCJLQQEEWXKSYYKDYPLTJTHKJLTCYYHHJTTPLTZZCDLTHQKZXQYSTEEYWYYZYXXYYSTTJKLLPZMCYHQGXYHSRMBXPLLNQYDQHXSXXWGDQBSHYLLPJJJTHYJKYPPTHYYKTYEZYENMDSHLCRPQFDGFXZPSFTLJXXJBSWYYSKSFLXLPPLBBBLBSFXFYZBSJSSYLPBBFFFFSSCJDSTZSXZRYYSYFFSYZYZBJTBCTSBSDHRTJJBYTCXYJEYLXCBNEBJDSYXYKGSJZBXBYTFZWGENYHHTHZHHXFWGCSTBGXKLSXYWMTMBYXJSTZSCDYQRCYTWXZFHMYMCXLZNSDJTTTXRYCFYJSBSDYERXJLJXBBDEYNJGHXGCKGSCYMBLXJMSZNSKGXFBNBPTHFJAAFXYXFPXMYPQDTZCXZZPXRSYWZDLYBBKTYQPQJPZYPZJZNJPZJLZZFYSBTTSLMPTZRTDXQSJEHBZYLZDHLJSQMLHTXTJECXSLZZSPKTLZKQQYFSYGYWPCPQFHQHYTQXZKRSGTTSQCZLPTXCDYYZXSQZSLXLZMYCPCQBZYXHBSXLZDLTCDXTYLZJYYZPZYZLTXJSJXHLPMYTXCQRBLZSSFJZZTNJYTXMYJHLHPPLCYXQJQQKZZSCPZKSWALQSBLCCZJSXGWWWYGYKTJBBZTDKHXHKGTGPBKQYSLPXPJCKBMLLXDZSTBKLGGQKQLSBKKTFXRMDKBFTPZFRTBBRFERQGXYJPZSSTLBZTPSZQZSJDHLJQLZBPMSMMSXLQQNHKNBLRDDNXXDHDDJCYYGYLXGZLXSYGMQQGKHBPMXYXLYTQWLWGCPBMQXCYZYDRJBHTDJYHQSHTMJSBYPLWHLZFFNYPMHXXHPLTBQPFBJWQDBYGPNZTPFZJGSDDTQSHZEAWZZYLLTYYBWJKXXGHLFKXDJTMSZSQYNZGGSWQSPHTLSSKMCLZXYSZQZXNCJDQGZDLFNYKLJCJLLZLMZZNHYDSSHTHZZLZZBBHQZWWYCRZHLYQQJBEYFXXXWHSRXWQHWPSLMSSKZTTYGYQQWRSLALHMJTQJSMXQBJJZJXZYZKXBYQXBJXSHZTSFJLXMXZXFGHKZSZGGYLCLSARJYHSLLLMZXELGLXYDJYTLFBHBPNLYZFBBHPTGJKWETZHKJJXZXXGLLJLSTGSHJJYQLQZFKCGNNDJSSZFDBCTWWSEQFHQJBSAQTGYPQLBXBMMYWXGSLZHGLZGQYFLZBYFZJFRYSFMBYZHQGFWZSYFYJJPHZBYYZFFWODGRLMFTWLBZGYCQXCDJYGZYYYYTYTYDWEGAZYHXJLZYYHLRMGRXXZCLHNELJJTJTPWJYBJJBXJJTJTEEKHWSLJPLPSFYZPQQBDLQJJTYYQLYZKDKSQJYYQZLDQTGJQYZJSUCMRYQTHTEJMFCTYHYPKMHYZWJDQFHYYXWSHCTXRLJHQXHCCYYYJLTKTTYTMXGTCJTZAYYOCZLYLBSZYWJYTSJYHBYSHFJLYGJXXTMZYYLTXXYPZLXYJZYZYYPNHMYMDYYLBLHLSYYQQLLNJJYMSOYQBZGDLYXYLCQYXTSZEGXHZGLHWBLJHEYXTWQMAKBPQCGYSHHEGQCMWYYWLJYJHYYZLLJJYLHZYHMGSLJLJXCJJYCLYCJPCPZJZJMMYLCQLNQLJQJSXYJMLSZLJQLYCMMHCFMMFPQQMFYLQMCFFQMMMMHMZNFHHJGTTHHKHSLNCHHYQDXTMMQDCYZYXYQMYQYLTDCYYYZAZZCYMZYDLZFFFMMYCQZWZZMABTBYZTDMNZZGGDFTYPCGQYTTSSFFWFDTZQSSYSTWXJHXYTSXXYLBYQHWWKXHZXWZNNZZJZJJQJCCCHYYXBZXZCYZTLLCQXYNJYCYYCYNZZQYYYEWYCZDCJYCCHYJLBTZYYCQWMPWPYMLGKDLDLGKQQBGYCHJXY",d={19969:"DZ",19975:"WM",19988:"QJ",20048:"YL",20056:"SC",20060:"NM",20094:"QG",20127:"QJ",20167:"QC",20193:"YG",20250:"KH",20256:"ZC",20282:"SC",20285:"QJG",20291:"TD",20314:"YD",20340:"NE",20375:"TD",20389:"YJ",20391:"CZ",20415:"PB",20446:"YS",20447:"SQ",20504:"TC",20608:"KG",20854:"QJ",20857:"ZC",20911:"PF",20504:"TC",20608:"KG",20854:"QJ",20857:"ZC",20911:"PF",20985:"AW",21032:"PB",21048:"XQ",21049:"SC",21089:"YS",21119:"JC",21242:"SB",21273:"SC",21305:"YP",21306:"QO",21330:"ZC",21333:"SDC",21345:"QK",21378:"CA",21397:"SC",21414:"XS",21442:"SC",21477:"JG",21480:"TD",21484:"ZS",21494:"YX",21505:"YX",21512:"HG",21523:"XH",21537:"PB",21542:"PF",21549:"KH",21571:"E",21574:"DA",21588:"TD",21589:"O",21618:"ZC",21621:"KHA",21632:"ZJ",21654:"KG",21679:"LKG",21683:"KH",21710:"A",21719:"YH",21734:"WOE",21769:"A",21780:"WN",21804:"XH",21834:"A",21899:"ZD",21903:"RN",21908:"WO",21939:"ZC",21956:"SA",21964:"YA",21970:"TD",22003:"A",22031:"JG",22040:"XS",22060:"ZC",22066:"ZC",22079:"MH",22129:"XJ",22179:"XA",22237:"NJ",22244:"TD",22280:"JQ",22300:"YH",22313:"XW",22331:"YQ",22343:"YJ",22351:"PH",22395:"DC",22412:"TD",22484:"PB",22500:"PB",22534:"ZD",22549:"DH",22561:"PB",22612:"TD",22771:"KQ",22831:"HB",22841:"JG",22855:"QJ",22865:"XQ",23013:"ML",23081:"WM",23487:"SX",23558:"QJ",23561:"YW",23586:"YW",23614:"YW",23615:"SN",23631:"PB",23646:"ZS",23663:"ZT",23673:"YG",23762:"TD",23769:"ZS",23780:"QJ",23884:"QK",24055:"XH",24113:"DC",24162:"ZC",24191:"GA",24273:"QJ",24324:"NL",24377:"TD",24378:"QJ",24439:"PF",24554:"ZS",24683:"TD",24694:"WE",24733:"LK",24925:"TN",25094:"ZG",25100:"XQ",25103:"XH",25153:"PB",25170:"PB",25179:"KG",25203:"PB",25240:"ZS",25282:"FB",25303:"NA",25324:"KG",25341:"ZY",25373:"WZ",25375:"XJ",25384:"A",25457:"A",25528:"SD",25530:"SC",25552:"TD",25774:"ZC",25874:"ZC",26044:"YW",26080:"WM",26292:"PB",26333:"PB",26355:"ZY",26366:"CZ",26397:"ZC",26399:"QJ",26415:"ZS",26451:"SB",26526:"ZC",26552:"JG",26561:"TD",26588:"JG",26597:"CZ",26629:"ZS",26638:"YL",26646:"XQ",26653:"KG",26657:"XJ",26727:"HG",26894:"ZC",26937:"ZS",26946:"ZC",26999:"KJ",27099:"KJ",27449:"YQ",27481:"XS",27542:"ZS",27663:"ZS",27748:"TS",27784:"SC",27788:"ZD",27795:"TD",27812:"O",27850:"PB",27852:"MB",27895:"SL",27898:"PL",27973:"QJ",27981:"KH",27986:"HX",27994:"XJ",28044:"YC",28065:"WG",28177:"SM",28267:"QJ",28291:"KH",28337:"ZQ",28463:"TL",28548:"DC",28601:"TD",28689:"PB",28805:"JG",28820:"QG",28846:"PB",28952:"TD",28975:"ZC",29100:"A",29325:"QJ",29575:"SL",29602:"FB",30010:"TD",30044:"CX",30058:"PF",30091:"YSP",30111:"YN",30229:"XJ",30427:"SC",30465:"SX",30631:"YQ",30655:"QJ",30684:"QJG",30707:"SD",30729:"XH",30796:"LG",30917:"PB",31074:"NM",31085:"JZ",31109:"SC",31181:"ZC",31192:"MLB",31293:"JQ",31400:"YX",31584:"YJ",31896:"ZN",31909:"ZY",31995:"XJ",32321:"PF",32327:"ZY",32418:"HG",32420:"XQ",32421:"HG",32438:"LG",32473:"GJ",32488:"TD",32521:"QJ",32527:"PB",32562:"ZSQ",32564:"JZ",32735:"ZD",32793:"PB",33071:"PF",33098:"XL",33100:"YA",33152:"PB",33261:"CX",33324:"BP",33333:"TD",33406:"YA",33426:"WM",33432:"PB",33445:"JG",33486:"ZN",33493:"TS",33507:"QJ",33540:"QJ",33544:"ZC",33564:"XQ",33617:"YT",33632:"QJ",33636:"XH",33637:"YX",33694:"WG",33705:"PF",33728:"YW",33882:"SR",34067:"WM",34074:"YW",34121:"QJ",34255:"ZC",34259:"XL",34425:"JH",34430:"XH",34485:"KH",34503:"YS",34532:"HG",34552:"XS",34558:"YE",34593:"ZL",34660:"YQ",34892:"XH",34928:"SC",34999:"QJ",35048:"PB",35059:"SC",35098:"ZC",35203:"TQ",35265:"JX",35299:"JX",35782:"SZ",35828:"YS",35830:"E",35843:"TD",35895:"YG",35977:"MH",36158:"JG",36228:"QJ",36426:"XQ",36466:"DC",36710:"JC",36711:"ZYG",36767:"PB",36866:"SK",36951:"YW",37034:"YX",37063:"XH",37218:"ZC",37325:"ZC",38063:"PB",38079:"TD",38085:"QY",38107:"DC",38116:"TD",38123:"YD",38224:"HG",38241:"XTC",38271:"ZC",38415:"YE",38426:"KH",38461:"YD",38463:"AE",38466:"PB",38477:"XJ",38518:"YT",38551:"WK",38585:"ZC",38704:"XS",38739:"LJ",38761:"GJ",38808:"SQ",39048:"JG",39049:"XJ",39052:"HG",39076:"CZ",39271:"XT",39534:"TD",39552:"TD",39584:"PB",39647:"SB",39730:"LG",39748:"TPB",40109:"ZQ",40479:"ND",40516:"HG",40536:"HG",40583:"QJ",40765:"YQ",40784:"QJ",40840:"YK",40863:"QJG"};return{getCaptial:function(c){if("string"!=typeof c)throw new Error(-1,"函数getCaptial需要字符串类型参数!");for(var d=new Array,e=0,f=c.length;e<f;e++){var g=c.charAt(e);d.push(a(g))}return b(d)[0]}}}),angular.module("channelApp").controller("InvoiceReviewCtrl",["$scope","$http","$filter","$state","user","OrderSearchService","$uibModal",function(a,b,c,d,e,f,g){function h(){b.get("/api/invoice/agent?"+jQuery.param(a.searchParams)).success(function(b){a.paginator.total=b.Count,a.invoices=b.data})}a.user=e.get();var i={options:{formatYear:"yy",maxDate:new Date(2020,5,22),minDate:new Date,startingDay:1},clearText:"清空",currentText:"今天",closeText:"关闭",startFlag:!1,endFlag:!1};a.datepickerConfig=i,a.showDatepicker=function(b){switch(b){case"start":a.datepickerConfig.startFlag=!0;break;case"end":a.datepickerConfig.endFlag=!0}};var j=function(){f.getAgent().then(function(b){a.agentModel=b.data,a.selectedAgent=a.agentModel[0]})};1==a.user.IsCenter&&j(),a.paginator={total:0,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.searchParams={limit:a.paginator.perPage,offset:(a.paginator.currentPage-1)*a.paginator.perPage,status:1,cid:""},a.orderModel=[],a.pageChanged=function(){a.searchParams=angular.extend(a.searchParams,{limit:a.paginator.perPage,offset:(a.paginator.currentPage-1)*a.paginator.perPage}),h()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.search=function(){a.paginator.currentPage=1,a.searchParams=angular.extend(a.searchParams,{limit:a.paginator.perPage,offset:(a.paginator.currentPage-1)*a.paginator.perPage,start:c("date")(a.start,"yyyy-MM-dd"),end:c("date")(a.end,"yyyy-MM-dd"),status:1,cid:a.channel&&a.channel.ChannelId||void 0}),h()},h(),a.accept=function(a){g.open({templateUrl:"views/invoiceAccept.html",controller:["$scope","$http","$filter","$uibModalInstance",function(b,c,d,e){b.invoice={Pass:!0},b.datepickerConfig=i,b.cancel=function(){e.dismiss("")},b.ok=function(){b.invoice.InvoiceDate=d("date")(b.kpdate,"yyyy-MM-dd"),c.put("/api/invoice/agent/audit/"+a.InvoiceId,b.invoice).success(function(){e.close()})}}]}).result.then(function(){h()})},a.reject=function(a){g.open({templateUrl:"views/invoiceReject.html",controller:["$scope","$http","$filter","$uibModalInstance",function(b,c,d,e){b.invoice={Pass:!1},b.title="拒绝发票",b.cancel=function(){e.dismiss("")},b.ok=function(){c.put("/api/invoice/agent/audit/"+a.InvoiceId,b.invoice).success(function(){e.close()})}}]}).result.then(function(){h()})},a.scan=function(a){g.open({templateUrl:"views/invoiceScan.html",controller:"InvoiceScanCtrl",resolve:{SelectedInvoice:function(){return{id:a.InvoiceId}}}})}}]),angular.module("channelApp").filter("filterRole",function(){return function(a){var b="";switch(a){case 1:b="系统管理员";break;case 2:b="总经理";break;case 3:b="财务总监";break;case 4:b="销售总监";break;case 5:b="业务员";break;default:b="其他"}return b}}),angular.module("channelApp").filter("filter1Status",function(){return function(a){var b="";switch(a){case 1:b="未审核";break;case 2:b="通过";break;case 3:b="拒审"}return b}}).filter("filterInvoiceProperty",function(){return function(a){var b="";switch(+a){case 1:b="公司";break;case 2:b="个人"}return b}}).filter("filterInvoiceCategory",function(){return function(a){var b="";switch(+a){case 1:b="专票";break;case 2:b="普票"}return b}}).filter("outWorkStatus",function(){return function(a){var b="";switch(+a){case 1:b="待分配";break;case 2:b="待处理";break;case 3:b="进行中";break;case 4:b="已取消";break;case 5:b="已完成"}return b}}),angular.module("channelApp").filter("filterInvoice",function(){return function(a){var b="";switch(a){case 1:b="非预借发票"}return b}}),angular.module("channelApp").filter("filterCate",function(){return function(a){var b="";switch(a){case 1:b="专票";break;case 2:b="普票"}return b}}),angular.module("channelApp").filter("filterProp",function(){return function(a){var b="";switch(a){case 1:b="公司";break;case 2:b="个人"}return b}}),angular.module("channelApp").filter("filterAddValue",function(){return function(a){return{1:"小规模",2:"一般纳税人"}[a]}}).filter("tDateTime",function(){return function(a){return"0001"==a.substr(0,4)?"":a?a.replace("T"," "):""}}).filter("tDate",function(){return function(a){return a?"0001"==a.substr(0,4)?"":a?a.substring(0,10):"":""}}).filter("fPayType",function(){return function(a){return{1:"半年付",2:"年付",3:"季付",4:"零税(半年)"}[a]}}).filter("cusCategory",function(){return function(a){return a>1?"注+记":"记"}}).filter("fOtType",function(){return function(a){return{1:"税务",2:"工商",3:"其他"}[a]}}).filter("otStatus",function(){var a={1:"待分配",2:"待处理",3:"进行中",4:"已取消",5:"已完成"};return function(b){return a[b]}}).filter("YesOrNo",function(){return function(a){return a?"是":"否"}}).filter("filterNum",function(){return function(a){return a?(100*a).toFixed(2)+"%":""}}).filter("filterStatus",function(){return function(a){return a?"正常":"解约"}}),angular.module("channelApp").controller("User_outworker",["$scope","$http","$state","$uibModal","user",function(a,b,c,d,e){function f(){b.get("/api/outworkers").success(function(b){a.outworkers=b.data})}a.user=e.get(),a.open=function(a){d.open({templateUrl:"views/user_outworker_view.html",controller:"User_outwroker_view",size:"lg",resolve:{customer:a||{}}}).result.then(function(a){f()},function(){})},a.delete=function(a){confirm("您确定要删除？")&&b.delete("/api/outworkers/"+a.Id).success(function(a){a.status&&f()})},f()}]).controller("User_outwroker_view",["$scope","$http","$uibModalInstance","customer",function(a,b,c,d){a.postData=d||{};a.title=d.Name||"新增外勤",a.ok=function(e){var f=angular.copy(a.postData);d.Id?b.put("/api/outworkers/"+d.Id,f).success(function(a){a.status&&(alert("修改成功！"),c.close())}):b.post("/api/outworkers",f).success(function(a){a.status&&c.close()})},a.cancel=function(){c.dismiss()}}]),angular.module("channelApp").controller("Gotaskconfig",["$scope","$http","user","$uibModal",function(a,b,c,d){function e(){b.get("/api/commontask").success(function(b){a.weights=_.uniq(_.pluck(b.data,"CommonWeight")),a.tasksArr=f(b.data)})}function f(a){var b=[],c={};return _.each(a,function(a){c.CommonTaskId!==a.CommonTaskId?(c=_.pick(a,"CommonTaskName","Status","CommonTaskId","CommonWeight"),c.TaskList=[_.pick(a,"TaskName","OuterTaskId","Weight")],b.push(c)):c.TaskList.push(_.pick(a,"TaskName","OuterTaskId","Weight"))}),b}a.user=c.get(),e(),a.add=function(b,c,f){c.stopPropagation(),c.preventDefault(),d.open({templateUrl:"views/go_task_config_view.html",controller:"Gotaskconfig_add",size:"lg",resolve:{increased:function(){return{name:f,weights:a.weights,task:b||{}}}}}).result.then(function(a){e()},function(){})},a.ifuse=function(a,c){a.stopPropagation(),a.preventDefault(),1==c.Status?b.put("/api/commontask/commontaskisstop?isstop=2&id="+c.CommonTaskId).success(function(a){e()}):b.put("/api/commontask/commontaskisstop?isstop=1&id="+c.CommonTaskId).success(function(a){e()})}
}]).controller("Gotaskconfig_add",["$scope","$http","$uibModalInstance","$uibModal","increased","user",function(a,b,c,d,e,f){a.cancel=function(){c.dismiss()},a.title=e.name,a.Math=Math,a.task={Id:e.task.CommonTaskId,CommonTaskName:e.task.CommonTaskName,TaskList:e.task.TaskList,Status:e.task.Status,Weight:e.task.CommonWeight};var g=a.task.Weight;b.get("/api/outertasksub?taskname=&BusinessType=&status=0&offset=0&limit=10000").success(function(b){a.Tasks=_.filter(b.data,{Status:1}),_.each(e.task.TaskList,function(b){var c=_.find(a.Tasks,{Id:b.OuterTaskId});c&&(c._weight=b.Weight,c.checked=!0)})}),a.checkWeight=function(b){var c=_.filter(a.Tasks,{checked:!0});_.uniq(c,function(a){return a.Weight}).length<c.length&&alert("请注意，权重不能重复!")},a.ok=function(){var d=a.task,f=_.filter(a.Tasks,{checked:!0});f=_.map(f,function(b){return a.task.Id?{CommonTaskId:d.Id,Weight:b._weight,OuterTaskId:b.Id}:{Weight:b._weight,OuterTaskId:b.Id}}),d.OutWorkerTasks=f,delete d.TaskList;var h=a.task.Weight,i=e.weights;return h!==g&&i.indexOf(h)>-1?void alert("通办任务权重不能重复！"):_.uniq(f,function(a){return a.Weight}).length!=f.length?void alert("子任务权重不能重复！"):void(a.task.Id?b.put("/api/commontask",d).success(function(a){c.close()}):b.post("/api/commontask",d).success(function(a){c.close()}))}}]),angular.module("channelApp").controller("Outwork_dict",["$scope","$http","$state","$uibModal","user",function(a,b,c,d,e){function f(){var c=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem);b.get("/api/outertasksub?"+$.param(c)).success(function(b){a.paginator.total=b.Count,a.outworkers=b.data})}a.user=e.get(),a.searchData={},a.open=function(a){d.open({templateUrl:"views/outwork_dict_view.html",controller:"Outwork_dict_view",resolve:{customer:a||{Price:0}}}).result.then(function(a){f()},function(){})},a.paginator={total:0,currentPage:1,perPage:15,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.pageChanged=function(){f()},a.setCurrentPage=function(){a.currentPage=Math.abs(Math.floor(a.currentPage))||1,a.paginator.currentPage=a.currentPage,f()},a.searchItem={TaskName:"",BusinessType:"",Status:"0"},a.search={TaskName:"",BusinessType:"",Status:"0"},a.searchFn=function(){a.searchItem.TaskName=a.search.TaskName,a.searchItem.BusinessType=a.search.BusinessType,a.searchItem.Status=a.search.Status,f()},a.delete=function(a){confirm("您确定要删除？")&&b.delete("/api/outworkers/"+a.Id).success(function(a){a.status&&f()})},f(),a.stopOrnot=function(a,c){if(confirm("确定更改吗？")){var d;d=1==a?2:1,b.put("/api/outertask/taskisstop?isstop="+d+"&id="+c,{}).success(function(a){f()})}},a.ifuse="启用"}]).controller("Outwork_dict_view",["$scope","$http","$uibModalInstance","customer",function(a,b,c,d){a.postData=_.clone(d)||{},a.postData.ifuse={use:a.postData.Status||1};a.title=a.postData.TaskName||"新增任务",a.checkPrice=function(){a.postData.Price<0&&(a.postData.Price=0)},a.ok=function(e){var f=angular.copy(a.postData),g={};if(f.Price<0)return void alert("服务费用不能为负！");g.TaskName=f.TaskName?f.TaskName:"",g.BusinessType=f.BusinessType?f.BusinessType:"",g.Price=f.Price?f.Price:0,g.Status=f.ifuse.use,g.Id=d.Id,d.Id?(g.CreateBy=d.CreateBy,g.CreateDate=d.CreateDate,b.put("/api/outertask",g).success(function(a){a.status&&(alert("保存成功！"),c.close())})):b.post("/api/outertask",g).success(function(a){a.status&&(alert("保存成功！"),c.close())})},a.cancel=function(){c.dismiss()}}]),angular.module("channelApp").controller("Order_outworker",["$scope","$http","$state","$uibModal","user","$q",function(a,b,c,d,e,f){function g(){var c;c=a.searchItem;var d=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},c,d);b.get("api/maintask?"+$.param(d)).success(function(b){a.paginator.total=b.Count,a.customers=b.data})}function h(a){var b=[],c={};return _.each(a,function(a){c.CommonTaskId!==a.CommonTaskId?(c=_.pick(a,"CommonTaskName","Status","CommonTaskId","CommonWeight"),c.TaskList=[_.pick(a,"TaskName","OuterTaskId","Weight")],b.push(c)):c.TaskList.push(_.pick(a,"TaskName","OuterTaskId","Weight"))}),b}a.user=e.get(),a.open=function(a){d.open({templateUrl:"views/order_outworker_add.html",controller:"Order_outworker_add",backdrop:"static",size:"hg",resolve:{customer:{}}}).result.then(function(a){g()},function(){})},a.detail=function(a){d.open({templateUrl:"views/order_outworker_detail.html",controller:"Order_outworker_detail",size:"lg",resolve:{taskId:function(){return a.Id}}}).result.then(function(a){g()},function(){})},a.taskStatus={1:"待分配",2:"待处理",3:"进行中",4:"已取消",5:"已完成"},2!==a.user.Category&&8!==a.user.Category&&delete a.taskStatus[1],a.search={Id:"",companyname:"",connector:"",taskname:"",childtaskname:"",currOutworker:"",starttime:"",endtime:"",areacode:"",salesId:"0",taskstatus:""},a.delete=function(a){confirm("确认要取消任务吗？")&&b.put("api/maintask/cancelstatus/"+a.Id).success(function(a){a.status&&g()})},a.clear=function(){a.dt=null},a.changeDate=function(){var b=angular.element($("#date1"))[0].value,c=angular.element($("#date2"))[0].value;if(c){var d=b.replace(/-/gi,"");c.replace(/-/gi,"")-d<0&&(angular.element($("#date1"))[0].value=c)}a.search.starttime=b,a.search.endtime=c},a.paginator={total:0,currentPage:1,perPage:15,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.searchItem={Id:"",companyname:"",connector:"",taskname:"",childtaskname:"",outworkId:"0",starttime:"",endtime:"",areacode:"",salesId:"0",taskstatus:""},a.pageChanged=function(){g()},a.setCurrentPage=function(){a.currentPage=Math.abs(Math.floor(a.currentPage))||1,a.paginator.currentPage=a.currentPage,g()},a.clear=function(){a.dt=null},a.popup1={opened:!1},a.popup2={opened:!1},a.open1=function(){a.popup1.opened=!0},a.open2=function(){a.popup2.opened=!0},a.changeDate=function(){var b=angular.element($("#date1"))[0].value,c=angular.element($("#date2"))[0].value;if(c){var d=b.replace(/-/gi,"");c.replace(/-/gi,"")-d<0&&(angular.element($("#date1"))[0].value=c)}a.search.starttime=b,a.search.endtime=c},a.searchFn=function(){a.searchItem.companyname=a.search.companyname,a.searchItem.Id=a.search.Id,a.searchItem.connector=a.search.connector,a.searchItem.taskname=a.search.taskname,a.searchItem.childtaskname=a.search.childtaskname,a.searchItem.starttime=a.search.starttime,a.searchItem.endtime=a.search.endtime,a.searchItem.areacode=a.search.areacode,a.searchItem.salesId=a.search.salesId||0,a.searchItem.outworkId=a.search.currOutworker||0,a.searchItem.taskstatus=a.search.taskstatus,g(a.searchItem)},g(),b.get("/api/orders/sales").success(function(b){a.users=b.data}),b.get("api/outworkers").success(function(b){a.outworkers=b.data}),b.get("/api/commontask").success(function(b){a.Tasks=h(b.data)}),a.outTasks=[],b.get("/api/code/area").success(function(b){a.areas=b.data}),b.get("/api/outertasksub?offset=0&limit=9999").success(function(b){a.outTasks=_.filter(b.data,{Status:1})})}]).controller("Order_outworker_add",["$scope","$http","$uibModal","$uibModalInstance","customer","user",function(a,b,c,d,e,f){function g(a){var b=[],c={};return _.each(a,function(a){c.CommonTaskId!==a.CommonTaskId?(c=_.pick(a,"CommonTaskName","Status","CommonTaskId","CommonWeight"),c.TaskList=[_.pick(a,"TaskName","OuterTaskId","Weight")],b.push(c)):c.TaskList.push(_.pick(a,"TaskName","OuterTaskId","Weight"))}),b}f.get();b.get("/api/commontask").success(function(b){a.tasksArr=g(_.filter(b.data,{Status:1}))}),a.open1=!1,a.open2=!1,a.checkTB=function(b){b.checked&&_.each(a.tasksArr,function(a){b.CommonTaskId!==a.CommonTaskId&&(a.checked=!1)})},a.tbIsDisable=function(){return!!_.chain(a.tasks).pluck("list").flatten().find({selected:!0}).value()},a.otherIsDisable=function(){return!!_.find(a.tasksArr,{checked:!0})},a.areaSele=0,a.postData={},e.Id&&(a.cus_selected=!0,a.postData.Customer=e),a.title="添加外勤任务",a.ok=function(e){function f(b){_.chain(a.tasks).pluck("list").flatten().filter(function(a){var c=_.find(b,{TaskId:a.Id});return c&&(a.selected=c.selected),!!c}).value()}function g(){b.post("/api/maintask",i).success(function(a){a.status&&(alert("添加成功!"),d.close())})}if(!a.postData.Customer)return void alert("请选择公司！");var h=_.find(a.tasksArr,{checked:!0}),i={CustomerId:a.postData.Customer.CustomerId,AreaCode:a.areaSele,Remark:a.postData.Remark},j=!1;if(h)i.CommonTaskId=h.CommonTaskId,i.ChildTasks=_.map(h.TaskList,function(b){var c=_.chain(a.tasks).pluck("list").flatten().find({Id:b.OuterTaskId}).value(),d=_.pick(c,"TaskName","Price","Weight","Remark");return d.TaskId=b.OuterTaskId,d.Weight=b.Weight,d.CustomerId=i.CustomerId,d}),i.MainTaskName=h.CommonTaskName;else{j=!0;var k=_.chain(a.tasks).pluck("list").flatten().filter({selected:!0}).map(function(a){return a}).value();if(i.ChildTasks=_.map(k,function(a){var b=_.pick(a,"TaskName","Price","Weight","Remark","selected");return b.TaskId=a.Id,b.CustomerId=i.CustomerId,b}),i.MainTaskName="其他",0===i.ChildTasks.length)return void alert("请选择任务！")}if(!a.areaSele)return void alert("请选择区域！");if(j){c.open({templateUrl:"views/outwork_weight_setting.html",controller:"outworkWeightSetting",size:"lg",backdrop:"static",resolve:{tasks:function(){return i.ChildTasks}}}).result.then(function(a){f(a);var b=_.map(_.filter(a,{selected:!0}),function(a){return a.Weight=a._weight,delete a.selected,a});i.ChildTasks=b,g()},function(a){f(a)})}else g()},b.get("/api/outertasksub?taskname=&BusinessType=&status=0&offset=0&limit=10000").success(function(b){var c=_.map(_.groupBy(_.filter(b.data,{Status:1}),"BusinessType"),function(a,b){var c={list:a};return c.Name=1==b?"税务":2==b?"工商":"其他",c});a.tasks=c}),b.get("/api/code/area").success(function(b){a.areaArr=b.data}),a.tbIsDisable=function(){return!!_.chain(a.tasks).pluck("list").flatten().find({selected:!0}).value()},a.otherIsDisable=function(){return!!_.find(a.tasksArr,{checked:!0})},a.cancel=function(){d.dismiss()},a.selectCustomer=function(){c.open({templateUrl:"views/Order_cusSelect.html",controller:"Order_cusSelect",size:"lg"}).result.then(function(b){a.postData.Customer=b,b.AreaCode&&(a.areaSele=b.AreaCode)},function(){})}}]).controller("Order_outworker_detail",["$scope","$http","$uibModalInstance","taskId","$uibModal","user",function(a,b,c,d,e,f){function g(){i++,b.get("/api/maintask/"+d).success(function(b){a.customers=b.data})}function h(){i>0?c.close():c.dismiss()}a.customers=[],a.user=f.get(),a.forwards={forwardUserId:"0",isSelectAll:!1};var i=0;b.get("/api/outworkers").success(function(b){a.outworkers=b.data}),a.cancel=function(){if(8!==a.user.Category&&2!==a.user.Category||_.every(a.customers,function(a){return a.Status>1}))h();else if(confirm("还有任务未分配，确认关闭？"))return void h()},a.forward=function(a){e.open({templateUrl:"views/customer_forword.html",controller:"OutworkForward",backdrop:"static"}).result.then(function(c){b.put("/api/childtask/trans?ids="+a.Id+"&outworkerId="+c).success(function(a){a.status&&g()})},function(){})},a.forwardAll=function(){var c=_.map(_.filter(a.customers,function(a){return a.Status<=3&&a.selected}),function(a){return a.Id}).join(",");if(0===c.length)return a.forwards.isSelectAll=!1,void(a.forwards.forwardUserId="0");b.put("/api/childtask/trans?ids="+c+"&outworkerId="+a.forwards.forwardUserId).success(function(b){b.status&&(g(),a.forwards.isSelectAll=!1,a.forwards.forwardUserId="0")})},a.statusChange=function(a,c,d){confirm("确认要“"+d+"”?")&&b.put("/api/childtask/"+a.Id+"/"+c).success(function(){g()})},a.editCompany=function(a){e.open({templateUrl:"views/companyEdit.html",controller:"CompanyEdit",size:"lg",backdrop:"static",resolve:{companyId:function(){return a.CustomerId}}}).result.then(function(c){b.put("/api/childtask/trans?ids="+a.Id+"&outworkerId="+c).success(function(a){a.status&&g()})},function(){})},a.selectAll=function(){a.forwards.isSelectAll?_.each(a.customers,function(a){a.Status<=3&&(a.selected=!0)}):_.each(a.customers,function(a){a.selected=!1})},g()}]).controller("Order_cusSelect",["$scope","$http","$uibModalInstance",function(a,b,c){function d(){var c=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage},a.searchItem);b.get("/api/order/customer?"+$.param(c)).success(function(b){a.paginator.total=b.Count,a.customers=b.data})}a.search={CompanyName:""},a.paginator={total:0,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.searchParams={limit:10,offset:0,start:"",end:"",status:0,cusname:"",cid:""},a.pageChanged=function(){d()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,d()},a.searchItem={companyname:""},a.search=function(){a.searchItem.companyname=a.search.CompanyName,d()},d(),a.select=function(a){c.close(a)},a.cancel=function(){c.dismiss()}}]).controller("CompanyEdit",["$scope","$uibModalInstance","$http","companyId","FileUploader","$filter",function(a,b,c,d,e,f){function g(b,c,d){var e=h(d,b.file.name);b.formData.push({key:e}),_.each(a.signkey,function(a,c){var d={};d[c]=a,b.formData.push(d)}),a["_key"+c]=e}function h(a,b){var c=function(a){var b="",c=a.lastIndexOf(".");return-1!=c&&(b=a.substring(c)),b},d=function(a){a=a||32;for(var b="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",c=b.length,d="",e=0;e<a;e++)d+=b.charAt(Math.floor(Math.random()*c));return d},e=c(b),g={1:"FileUploads/Order/CardID/",2:"FileUploads/Order/BusinessLicense/",3:"FileUploads/Order/Contract/",4:"FileUploads/Agent/"},h=f("date")(new Date,"yyyyMM");return g[a]+h+"/"+d(10)+e}c.get("/api/code/industry").success(function(b){a.industries=b.data}),c.get("/api/citybychannel").success(function(b){a.cities=b.data,a.postData.CityCode||(a.postData.CityCode=a.cities[0].CityCode)}),c.get("/api/code/area").success(function(b){a.areas=b.data}),a.postData={},c.get("/api/customer/"+d).success(function(b){var c=b.data[0];c.BusnissDeadline&&"0001"===c.BusnissDeadline.substr(0,4)?c.BusnissDeadline="":c.BusnissDeadline=new Date(c.BusnissDeadline),c.RegisterDate&&"0001"===c.RegisterDate.substr(0,4)?c.RegisterDate="":c.RegisterDate=new Date(c.RegisterDate),c.AddedValue=""+c.AddedValue,c.Industry=""+c.Industry,a.postData=c}),a.ok=function(d){var e=a.postData;e.RegisterDate&&(e.RegisterDate=f("date")(a.postData.RegisterDate,"yyyy-MM-dd")),e.NoDeadLine?(e.BusnissDeadline="",e.NoDeadLine=1):e.NoDeadLine=0,c.put("/api/customerdetail",a.postData).success(function(a){a.status&&(alert("保存成功!"),b.dismiss("cancel"))})},a.cancel=function(){b.dismiss("cancel")},c.get("/api/signkey").success(function(b){delete b.data.Filename,delete b.data.key,delete b.data.callback,delete b.data.expire,delete b.data.Host,a.signkey=b.data}),a.uploader2=new e({url:"/api/files/2",autoUpload:!0}),a.uploader2.onCompleteItem=function(b,c,d,e){a.postData.BusinessLicense="https://pilipa.oss-cn-beijing.aliyuncs.com/"+a._key2},a.uploader2.onBeforeUploadItem=function(a){g(a,2,2)},a.uploader2.onErrorItem=function(){alert("上传失败!")}}]).controller("OutworkForward",["$scope","$uibModalInstance","$http","user",function(a,b,c,d){var e=(d.get(),a.vm={});a.title="转接任务",e.model={},e.options={},e.fields=[{key:"SalesId",type:"select",templateOptions:{label:"外勤",options:[],valueProp:"UserId",labelProp:"RealName"},controller:["$scope",function(a){a.to.loading=c.get("/api/outworkers").success(function(b){var c=b.data;return a.to.options=c,b.data})}]}],a.save=function(a){if(!e.model.SalesId)return void alert("请选择外勤人员!");b.close(e.model.SalesId)},a.cancel=function(){b.dismiss("cancel")}}]).controller("outworkWeightSetting",["$scope","$http","$uibModalInstance","tasks",function(a,b,c,d){a.Tasks=d,a.toInt=function(a,b){return Math.floor(Math.abs(a))||""},a.delete=function(a){confirm("确认要删除？")&&(a.selected=!1)},a.cancel=function(){c.dismiss(a.Tasks)},a.ok=function(){var b=_.filter(a.Tasks,{selected:!0});_.uniq(b,function(a){return a._weight}).length<b.length?alert("权重不能重复！"):c.close(a.Tasks)}}]),angular.module("channelApp").controller("RechargeApply",["$scope","$http","$filter","$uibModal",function(a,b,c,d){function e(){a.paginator.currentPage=1,a.paginator.perPage=15}function f(){k.start=c("date")(a.searchParams.startTime,"yyyy-MM-dd"),k.end=c("date")(a.searchParams.endTime,"yyyy-MM-dd"),k.channelname=a.searchParams.channelName,k.type=a.searchParams.status}function g(){var c={offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage,start:k.start,end:k.end,channelname:k.channelname,type:k.type||0};b.get(j+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.data=i(b.data)})}function h(){return l.map(function(a){return a.header})}function i(a){var b={1:"未审核",2:"通过",3:"拒审"};return a.forEach(function(a){var c=[];a.CreateDate=a.CreateDate.substr(0,10),a.StatusStr=b[a.Status],l.forEach(function(b){c.push(a[b.col])}),a.cols=c}),a}a.searchParams={startTime:"",endTime:"",status:"0"},a.datepickerConfig={options:{formatYear:"yy",maxDate:new Date(2020,5,22),minDate:new Date,startingDay:1},clearText:"清空",currentText:"今天",closeText:"关闭",startFlag:!1,endFlag:!1},a.showDatepicker=function(b){switch(b){case"start":a.datepickerConfig.startFlag=!0;break;case"end":a.datepickerConfig.endFlag=!0}},a.apply=function(a){d.open({templateUrl:"views/recharge_apply_modal.html",size:"lg",controller:"RechargeApplyModal",resolve:{item:function(){return a||{}}}}).result.then(function(a){g()},function(){})},a.view=function(a){d.open({templateUrl:"views/recharge_apply_ro_modal.html",size:"lg",controller:"RechargeApplyModal",resolve:{item:function(){return a||{}}}}).result.then(function(a){g()},function(){})},a.delete=function(a){confirm("确认要删除充值申请？")&&b.put("/api/finance/deleteprepai/"+a.Id).success(function(a){a.status&&(g(),alert("删除成功！"))})},a.paginator={total:1,currentPage:1,perPage:10,previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.pageChanged=function(){g()},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},b.get("/api/finance/balance").success(function(b){a.balance=b.data});var j="/api/finance/getprepai/list?",k={};a.search=function(){e(),f(),g()},g();var l=[{header:"一级代理商",col:"ChannelName1"},{header:"二级代理商",col:"ChannelName2"},{header:"充值金额",col:"Amount"},{header:"余额",col:"Balance"},{header:"申请时间",col:"CreateDate"},{header:"审核状态",col:"StatusStr"},{header:"审核意见",col:"AuditOpinion"}];a.rightAlign=[2,3],a.headers=h()}]).controller("RechargeApplyModal",["$scope","$http","$uibModalInstance","FileUploader","item","$filter",function(a,b,c,d,e,f){function g(a){var b=function(a){var b="",c=a.lastIndexOf(".");return-1!=c&&(b=a.substring(c)),b},c=function(a){a=a||32;for(var b="ABCDEFGHJKMNPQRSTWXYZabcdefhijkmnprstwxyz2345678",c=b.length,d="",e=0;e<a;e++)d+=b.charAt(Math.floor(Math.random()*c));return d},d=b(a);return"FileUploads/Recharge/"+f("date")(new Date,"yyyyMM")+"/"+c(10)+d}function h(a){alert("上传失败!")}a.rAmount=5e3,a.Remark="",a.rlist=[{}],e.Id&&b.get("/api/finance/getprepai?id="+e.Id).success(function(b){b.status&&(a.rAmount=b.data.Amount,_.each(b.data.PrepayDetails,function(a){a.PayTime=new Date(a.PayTime)}),a.rlist=b.data.PrepayDetails,a.imgs=JSON.parse(b.data.PhotoPath),a.Remark=b.data.Remark)}),a.cancel=function(){c.dismiss("cancel")},a.Math=Math,a.reduce=function(a){return a.reduce(function(a,b){return a+(b.Amount||0)},0)||0},a.save=function(){if(a.uploader1.isUploading)return void alert("图片正在上传，请稍后尝试保存！");if(a.rAmount<=0||isNaN(a.rAmount))return void alert("充值金额不正确");if(a.rAmount<5e3)return void alert("充值金额最少为5000元！");var d=!0,f="",g=0;if(_.each(a.rlist,function(a){d&&(a.AccountOfPayment?a.PayTime?isNaN(a.Amount)||!a.Amount?(d=!1,f="付款金额必须填写,并且为大于零的数字!"):g+=Number(a.Amount):(d=!1,f="付款时间必须填写!"):(d=!1,f="付款账户必须填写!"))}),!d)return void alert(f);if(0===a.imgs.length)return void alert("请上传充值图片!");if(g!=a.rAmount)return void alert("充值金额与付款金额合计不相等！");var h=_.extend({},e,{Amount:a.rAmount,PhotoPath:JSON.stringify(a.imgs),PrepayDetails:a.rlist,Status:1,Remark:a.Remark});delete h.StatusStr,delete h.cols,e.Id?(console.log(h,"充值申请修改成功！"),b.put("/api/finance/putprepai",h).success(function(a){a.status&&(alert("充值申请修改成功！"),c.close())})):(console.log(h,"充值申请成功！"),b.post("/api/finance/addprepai",h).success(function(a){a.status&&(alert("充值申请成功！"),c.close())}))},a.delete=function(b){a.rlist.splice(b,1)},a.dateOptions={startingDay:1},a.altInputFormats=["M!/d!/yyyy"];var i="https://pilipa.oss-cn-beijing.aliyuncs.com";b.get("/api/signkey").success(function(b){delete b.data.Filename,delete b.data.key,delete b.data.callback,delete b.data.expire,delete b.data.Host,a.signkey=b.data}),a.imgs=[],a.uploader1=new d({autoUpload:!0,url:i}),a.uploader1.onErrorItem=h,a.uploader1.onSuccessItem=function(b,c,d,e){a.imgs.push(i+"/"+b.key)},a.uploader1.onErrorItem=function(a,b,c,d){alert(a.file.name+"上传失败")},a.uploader1.onBeforeUploadItem=function(b){var c=g(b.file.name);b.formData.push({key:c}),_.each(a.signkey,function(a,c){var d={};d[c]=a,b.formData.push(d)}),b.key=c},a.uploader1.filters.push({name:"customFilter",fn:function(a,b){return!!/^.*\.(?:png|jpg|bmp|gif|jpeg)$/.test(a.name.toLowerCase())||(alert("请选择图片"),!1)}})}]),angular.module("channelApp").controller("OperateAccount",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(b){var c=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0;return angular.forEach(b,function(a){c+=+a.AllCusNum,d+=+a.TotalNum,e+=+a.TiDanZero,f+=+a.NoSetUpNum,g+=+a.RingNum,h+=+a.LateNum,i+=+a.UnstartNum,j+=+a.HungNum}),a.aAllCusNum=c,a.aTotalNum=d,a.aTiDanZero=e||"",a.aNoSetUpNum=f,a.aRingNum=g,a.aLateNum=h,a.aUnstartNum=i,a.aHungNum=j,b}a.params={enddate:""},a.enddate=new Date,a.tableData=[],a.search=function(){a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),b.get("/api/dataanalysis/agenttotalcustomer?"+jQuery.param(a.params)).success(function(b){console.log(b,"result"),a.tableData=b.data,a.rows=g(a.tableData)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate},a.url="https://agent.pilipa.cn/api/v1/AgentExport.ashx",a.downloadColumn1=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=totalcustomer&"+$.param(g);window.open(h)},a.downloadColumn2=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=historybusinessdate&"+$.param(g);window.open(h)},a.downloadColumn3=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=totalhung&"+$.param(g);window.open(h)},a.rightAlign=[4,5,6,7,8,9,10,11,12],a.toExcel=function(){e.tableToExcel("div[js-height]>#dataTable","运营会计数据总览")}}]),angular.module("channelApp").controller("WaitSetAccount",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(b){var c=0,d=0,e=0,f=0,g=0;return angular.forEach(b,function(a){c+=+a.TotalNum,d+=+a.UnMakeAccount,e+=+a.UnMakeAccountLess10Day,f+=+a.UnMakeAccountMore10Day,g+=+a.UnBusinessDate}),a.aTotalNum=c||"",a.aUnMakeAccount=d,a.aUnMakeAccountLess10Day=e,a.aUnMakeAccountMore10Day=f,a.aUnBusinessDate=g||"",b}a.params={enddate:""},a.enddate=new Date,a.tableData=[],a.search=function(){a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),b.get("/api/dataanalysis/agentrecallcustomer?"+jQuery.param(a.params)).success(function(b){console.log(b,"result"),a.tableData=b.data,a.rows=g(a.tableData)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate},a.url="https://agent.pilipa.cn/api/v1/AgentExport.ashx",a.downloadColumn1=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=getunaccount&"+$.param(g);window.open(h)},a.downloadColumn2=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=getunaccountmore10day&"+$.param(g);window.open(h)},a.rightAlign=[4,5,6,7,8,9,10,11,12],a.toExcel=function(){e.tableToExcel("div[js-height]>#dataTable","待建账数据统计")}}]),angular.module("channelApp").controller("Receipt",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(b){var c=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0;return angular.forEach(b,function(a){c+=+a.CurrentBusinessDateCompanyCount,d+=+a.TiDanZero,e+=+a.UnUrgeCount,f+=+a.UrgeCount,g+=+a.ConfirmZero,h+=+a.UnMonitionCount,i+=+a.MonitionCount,j+=+a.MonitionCompleteCount,k+=+a.RejectCount}),a.aCurrentBusinessDateCompanyCount=c,a.aTiDanZero=d,a.aUnUrgeCount=e,a.aUrgeCount=f,a.aConfirmZero=g,a.aUnMonitionCount=h,a.aMonitionCount=i,a.aMonitionCompleteCount=j,a.aRejectCount=k,b}a.params={enddate:""},a.enddate=new Date,a.tableData=[],a.search=function(){a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),b.get("/api/dataanalysis/agentreceiptcustomer?"+jQuery.param(a.params)).success(function(b){console.log(b,"result"),a.tableData=b.data,a.rows=g(a.tableData)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate},a.url="https://agent.pilipa.cn/api/v1/AgentExport.ashx",a.downloadColumn1=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=ReceiptDetail&"+$.param(g);window.open(h)},a.downloadColumn2=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=unurge&"+$.param(g);window.open(h)},a.downloadColumn3=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=urge&"+$.param(g);window.open(h)},a.downloadColumn4=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=requirereceipt&"+$.param(g);window.open(h)},a.downloadColumn5=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=rejectreceipt&"+$.param(g);window.open(h)},a.rightAlign=[4,5,6,7,8,9,10,11,12],a.toExcel=function(){e.tableToExcel("div[js-height]>#dataTable","传票数据统计")}}]),angular.module("channelApp").controller("MakeAccount",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(b){var c=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0;return angular.forEach(b,function(a){c+=+a.CurrentBusinessDateCompanyCount,d+=+a.TiDanZero,e+=+a.ConfirmZero,f+=+a.UnMonition,g+=+a.UnMakeAccount,h+=+a.MakeAccountUnConfirm,i+=+a.Confirm,j+=+a.Tax,k+=+a.UnTax}),a.aCurrentBusinessDateCompanyCount=c,a.aTiDanZero=d,a.aConfirmZero=e,a.aUnMonition=f,a.aUnMakeAccount=g,a.aMakeAccountUnConfirm=h,a.aConfirm=i,a.aTax=j,a.aUnTax=k,b}a.params={enddate:""},a.enddate=new Date,a.tableData=[],a.search=function(){a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),b.get("/api/dataanalysis/agentaccountcustomer?"+jQuery.param(a.params)).success(function(b){console.log(b,"result"),a.tableData=b.data,a.rows=g(a.tableData)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate},a.url="https://agent.pilipa.cn/api/v1/AgentExport.ashx",a.downloadColumn1=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=getmonitionandunmakeaccount&"+$.param(g);window.open(h)},a.downloadColumn2=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=getmakeaccountandunconfirm&"+$.param(g);window.open(h)},a.downloadColumn3=function(b){var d=b.AccountId,e=new Date,f=e;f=c("date")(f,"yyyy-MM-dd");var g={};g.accountid=d,g.enddate=f;var h=a.url+"?type=getuntax&"+$.param(g);window.open(h)},a.rightAlign=[4,5,6,7,8,9,10,11,12],a.toExcel=function(){e.tableToExcel("div[js-height]>#dataTable","做账与报税数据统计")}}]),angular.module("channelApp").controller("StatisOrders",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(){var a=new Date;return a.setDate(1),a}function h(){var a=new Date;return a.setMonth(a.getMonth()+1),a.setDate(0),a}function i(b){var c=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0;return angular.forEach(b,function(a){c+=+a.ZeroYearNum,d+=+a.QuarterNum,e+=+a.HalfYearNum,f+=+a.YearNum,g+=+a.ReserveNum,h+=+a.FormalNum,i+=+a.NewNum,j+=+a.ReNum,k+=+a.ZeroNum,l+=+a.SmallNum,m+=+a.NormalNum,n+=+a.TotalNum}),a.aZeroYearNum=c,a.aQuarterNum=d,a.aHalfYearNum=e,a.aYearNum=f,a.aReserveNum=g,a.aFormalNum=h,a.aNewNum=i,a.aReNum=j,a.aZeroNum=k,a.aSmallNum=l,a.aNormalNum=m,a.aTotalNum=n,b}a.params={startdate:"",enddate:"",status:""},a.postData={};var j=g(),k=h();a.startdate=j,a.enddate=k,a.tableData=[],a.search=function(){a.startdate&&(a.params.startdate=c("date")(a.startdate,"yyyy-MM-dd")),a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),a.postData=a.params,b.get("/api/report/getorderstotalnum?"+jQuery.param(a.params)).success(function(b){a.tableData=b.data,a.rows=i(a.tableData)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate},a.downloadColumn1=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/download/getreserveorders?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/download/getreserveorders?"+$.param(f)}window.open(e)},a.downloadColumn2=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/download/getzeroorders?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/download/getzeroorders?"+$.param(f)}window.open(e)},a.toExcel=function(){e.tableToExcel("div[js-height]>#dataTable","订单统计")}}]),angular.module("channelApp").controller("StatisAchieve",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(){var a=new Date;return a.setDate(1),a}function h(){var a=new Date;return a.setMonth(a.getMonth()+1),a.setDate(0),a}function i(b){var c=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0;return angular.forEach(b,function(a){c+=+a.OrderNumZero,d+=+a.YSSmall,e+=+a.YSGeneral,f+=+a.YSHJ,g+=+a.YSZero,h+=+a.SSSmall,i+=+a.SSGeneral,j+=+a.SSHJ,k+=+a.SSZero,l+=+a.OrderNumSmall,m+=+a.OrderNumGeneral,n+=+a.OrderNumHJ}),a.aOrderNumZero=c,a.aYSSmall=d,a.aYSGeneral=e,a.aYSHJ=f,a.aYSZero=g,a.aSSSmall=h,a.aSSGeneral=i,a.aSSHJ=j,a.aSSZero=k,a.aOrderNumSmall=l,a.aOrderNumGeneral=m,a.aOrderNumHJ=n,b}a.params={startdate:"",enddate:"",status:""};var j=g(),k=h();a.startdate=j,a.enddate=k,a.tableData=[],a.search=function(){a.startdate&&(a.params.startdate=c("date")(a.startdate,"yyyy-MM-dd")),a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),b.get("/api/agentsreports?"+jQuery.param(a.params)).success(function(b){a.tableData=b.data,a.rows=i(a.tableData)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate},a.toExcel=function(){e.tableToExcel("div[js-height]>#dataTable","业绩统计")}}]),angular.module("channelApp").controller("StatisNewCustomers",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(){var a=new Date;return a.setDate(1),a}function h(){var a=new Date;return a.setMonth(a.getMonth()+1),a.setDate(0),a}function i(b){var c=0,d=0,e=0,f=0,g=0,h=0;return angular.forEach(b,function(a){c+=+a.ZeroNum,d+=+a.SmallNum,e+=+a.NormalNum,f+=+a.CustomerNum,g+=+a.ContractAmount,h+=+a.ZeroAmount}),a.aZeroNum=c,a.aSmallNum=d,a.aNormalNum=e,a.aCustomerNum=f,a.aContractAmount=g,a.aZeroAmount=h,b}a.params={startdate:"",enddate:"",status:""},a.postData={};var j=g(),k=h();a.startdate=j,a.enddate=k,a.tableData=[],a.search=function(){a.startdate&&(a.params.startdate=c("date")(a.startdate,"yyyy-MM-dd")),a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),a.postData=a.params,b.get("/api/newcustomer?"+jQuery.param(a.params)).success(function(b){console.log(b,"result"),a.tableData=b.data.DataInfo,a.rows=i(a.tableData)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate},a.downloadColumn1=function(b){if(b){var c={iscustomers:1};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/download/getzeroorders?iscustomers=1&"+$.param(c)}else{var f={iscustomers:1};f=angular.copy(a.postData)
;var e="/api/download/getzeroorders?iscustomers=1&"+$.param(f)}window.open(e)},a.toExcel=function(){e.tableToExcel("div[js-height]>#dataTable","新增客户统计")}}]),angular.module("channelApp").controller("StatisRenew",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(b){var c=0,d=0,e=0;return angular.forEach(b,function(a){c+=+a.ExpireNum,d+=+a.NoReNum,e+=+a.ReNum}),a.aExpireNum=c,a.aNoReNum=d,a.aReNum=e,b}a.params={year:"",months:"",status:""},a.postData={};var h=new Date,i=(h.setMonth(-1),h.getMonth()+1),j=h.getFullYear();console.log(i,j),a.params.months=i<10?"0"+i:i,a.params.year=j+"",a.months=[];for(var k=1;k<13;k++)a.months.push({label:k+"月",value:k<10?"0"+k:k});a.tableData=[],a.search=function(){console.log(a.params),a.postData=a.params,b.get("/api/report/getreordersnum?"+jQuery.param(a.params)).success(function(b){a.tableData=b.data,a.rows=g(a.tableData)})},a.search(),a.postData={},a.postData.year=a.params.year,a.postData.months=a.params.months,a.downloadColumn1=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/download/getexpireorderdetails?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/download/getexpireorderdetails?"+$.param(f)}window.open(e)},a.downloadColumn2=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/download/getnoreorderdetails?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/download/getnoreorderdetails?"+$.param(f)}window.open(e)},a.downloadColumn3=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/download/getreorderdetails?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/download/getreorderdetails?"+$.param(f)}window.open(e)},a.toExcel=function(){e.tableToExcel("div[js-height]>#dataTable","续费订单统计")}}]),angular.module("channelApp").controller("StatisYtOdersTozsOders",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(){var a=new Date;return a.setDate(1),a}function h(){var a=new Date;return a.setMonth(a.getMonth()+1),a.setDate(0),a}function i(b){var c=0,d=0;return angular.forEach(b,function(a){c+=+a.ytdcount,d+=+a.zzscount}),a.aytdcount=c,a.azzscount=d,b}a.params={startdate:"",enddate:"",status:""},a.postData={};var j=g(),k=h();a.startdate=j,a.enddate=k,a.tableData=[],a.search=function(){a.startdate&&(a.params.startdate=c("date")(a.startdate,"yyyy-MM-dd")),a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),a.postData=a.params,b.get("/api/dataanalysis/beforetoformalsearch?"+jQuery.param(a.params)).success(function(b){a.tableData=b.data,a.rows=i(a.tableData)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate},a.downloadColumn1=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/dataanalysis/exportbeforehandlist?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/dataanalysis/exportbeforehandlist?"+$.param(f)}window.open(e)},a.downloadColumn2=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/dataanalysis/exporttoformallist?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/dataanalysis/exporttoformallist?"+$.param(f)}window.open(e)},a.toExcel=function(){e.tableToExcel("div[js-height]>#dataTable","预提单转正式订单统计")}}]),angular.module("channelApp").controller("StatisZeroTonoZero",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(){var a=new Date;return a.setDate(1),a}function h(){var a=new Date;return a.setMonth(a.getMonth()+1),a.setDate(0),a}function i(b){var c=0,d=0,e=0;return angular.forEach(b,function(a){c+=+a.zeronum,d+=+a.littlenum,e+=+a.formalnum}),a.azeronum=c,a.alittlenum=d,a.aformalnum=e,b}a.params={startdate:"",enddate:"",status:""},a.postData={};var j=g(),k=h();a.startdate=j,a.enddate=k,a.tableData=[],a.search=function(){a.startdate&&(a.params.startdate=c("date")(a.startdate,"yyyy-MM-dd")),a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),a.postData=a.params,b.get("/api/dataanalysis/Iszerostatistics?"+jQuery.param(a.params)).success(function(b){a.tableData=b.data,a.rows=i(a.tableData)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate},a.downloadColumn1=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/dataanalysis/exportzerolist?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/dataanalysis/exportzerolist?"+$.param(f)}window.open(e)},a.downloadColumn2=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/dataanalysis/exporttolittlelist?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/dataanalysis/exporttolittlelist?"+$.param(f)}window.open(e)},a.downloadColumn3=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/dataanalysis/exportzerotoformallist?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/dataanalysis/exportzerotoformallist?"+$.param(f)}window.open(e)},a.toExcel=function(){e.tableToExcel("div[js-height]>#dataTable","零申报转非零申报统计")}}]),angular.module("channelApp").controller("StatisCompanyType",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(){var a=new Date;return a.setDate(1),a}function h(){var a=new Date;return a.setMonth(a.getMonth()+1),a.setDate(0),a}function i(b){var c=0,d=0;return angular.forEach(b,function(a){c+=+a.littlenum,d+=+a.formalnum}),a.alittlenum=c,a.aformalnum=d,b}a.params={startdate:"",enddate:"",status:""},a.postData={};var j=g(),k=h();a.startdate=j,a.enddate=k,a.tableData=[],a.search=function(){a.startdate&&(a.params.startdate=c("date")(a.startdate,"yyyy-MM-dd")),a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),a.postData=a.params,b.get("/api/dataanalysis/littletoformal?"+jQuery.param(a.params)).success(function(b){a.tableData=b.data,a.rows=i(a.tableData)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate},a.downloadColumn1=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/dataanalysis/exportlittlelist?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/dataanalysis/exportlittlelist?"+$.param(f)}window.open(e)},a.downloadColumn2=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/dataanalysis/exportlittletoformallist?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/dataanalysis/exportlittletoformallist?"+$.param(f)}window.open(e)},a.toExcel=function(){e.tableToExcel("div[js-height]>#dataTable","小规模转为一般纳税人统计")}}]),angular.module("channelApp").controller("StatisOutworks",["$scope","$http","$filter","user","Excel","$timeout",function(a,b,c,d,e,f){function g(){var a=new Date;return a.setDate(1),a}function h(){var a=new Date;return a.setMonth(a.getMonth()+1),a.setDate(0),a}function i(b){var c=0,d=0,e=0,f=0,g=0,h=0,i=0,j=0,k=0,l=0,m=0,n=0,o=0;return angular.forEach(b,function(a){c+=+a.ordernum,d+=+a.allmainnum,e+=+a.mainnum1,f+=+a.mainnum2,g+=+a.mainnum3,h+=+a.mainnum4,i+=+a.mainnum5,j+=+a.allchildnum,k+=+a.childnum1,l+=+a.childnum2,m+=+a.childnum3,n+=+a.childnum4,o+=+a.childnum5}),a.aordernum=c,a.aallmainnum=d,a.amainnum1=e,a.amainnum2=f,a.amainnum3=g,a.amainnum4=h,a.amainnum5=i,a.aallchildnum=j,a.achildnum1=k,a.achildnum2=l,a.achildnum3=m,a.achildnum4=n,a.achildnum5=o,b}a.params={startdate:"",enddate:"",status:""},a.postData={};var j=g(),k=h();a.startdate=j,a.enddate=k,a.tableData=[],a.search=function(){a.startdate&&(a.params.startdate=c("date")(a.startdate,"yyyy-MM-dd")),a.enddate&&(a.params.enddate=c("date")(a.enddate,"yyyy-MM-dd")),a.postData=a.params,b.get("/api/dataanalysis/gettasknum?"+jQuery.param(a.params)).success(function(b){a.tableData=b.data,a.rows=i(a.tableData)})},a.search(),a.startChange=function(){a.dateOptions2.minDate=a.startdate},a.downloadColumn1=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/download/getmaintaskdetails?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/download/getmaintaskdetails?"+$.param(f)}window.open(e)},a.downloadColumn2=function(b){if(b){var c={};c=angular.copy(a.postData);var d=b.ChannelId;c.channelid=d;var e="/api/download/getchildtaskdetails?"+$.param(c)}else{var f={};f=angular.copy(a.postData);var e="/api/download/getchildtaskdetails?"+$.param(f)}window.open(e)},a.toExcel=function(){e.tableToExcel("div[js-height]>#dataTable","外勤情况统计")}}]),angular.module("channelApp").controller("NoticeList",["$scope","$http","$filter","$state",function(a,b,c,d){function e(){var c=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage,title:"",type:1},c);b.get("/api/notice/getnoticelist?"+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.noticelists=b.data,console.log(a.noticelists)})}a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.pageChanged=function(){e()},e(),a.goBackHome=function(){d.go("main"),console.log(d)},a.noticeDetail=function(a){d.go("main.noticeDetail",{id:a})}}]).controller("NoticeDetail",["$scope","$stateParams","$http","$filter","$state",function(a,b,c,d,e){function f(){c.get("api/notice/getnotice?id="+a.id).success(function(b){a.detailData=b.data[0]})}a.id=b.id,a.detailData="",console.log(a.id,"$scope.id"),a.goBackLast=function(){console.log(e),history.back()},f()}]),angular.module("channelApp").controller("Doclist",["$scope","$http","$filter","$state",function(a,b,c,d){a.filename="",a.type=2,a.types=[{type:1,name:"按上传日期倒序"},{type:2,name:"按文件名称升序"}],a.paginator={total:0,currentPage:1,perPage:10,userName:"",previousText:"上一页",nextText:"下一页",lastText:"最后一页",firstText:"首页"},a.setCurrentPage=function(){a.paginator.currentPage=a.currentPage,a.pageChanged()},a.pageChanged=function(){getFileList()},a.getFileList=function(){var c=angular.extend({offset:(a.paginator.currentPage-1)*a.paginator.perPage,limit:a.paginator.perPage,filename:a.filename,type:a.type},c);b.get("/api/doc/getdoclist?"+jQuery.param(c)).success(function(b){a.paginator.total=b.Count,a.doclists=b.data})},a.getFileList(),a.goBackHome=function(){d.go("main")},a.download=function(a){var b="api/doc/downloadfile?id="+a;window.open(b)}}]),angular.module("channelApp").run(["$templateCache",function(a){a.put("views/Order_cusSelect.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">选择客户</h3> </div> <div class="modal-body"> <form class="form-inline"> <div class="form-group"> <label>公司名称/联系人</label>： <input flex ng-model="search.CompanyName" class="form-control"> </div> <button class="btn btn-primary" type="button" ng-disabled="cusform.$invalid" ng-click="search()">查询</button> </form> <table class="table table-striped table-hover table-bordered" style="margin: 12px 0"> <thead> <tr class="info"> <th>公司名称</th> <th>联系人</th> <th>联系人电话</th> </tr> </thead> <tbody> <tr ng-repeat="customer in customers"> <td><a href="javascript:;" ng-click="select(customer)">{{::customer.Name}}</a></td> <td><a href="javascript:;" ng-click="select(customer)">{{::customer.Contacts}}</a></td> <td>{{::customer.Mobile}}</td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> <span>合计:{{paginator.total}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"><button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> <div class="modal-footer"> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/achieve.html",'<div class="m-achieve"> <h2> 业绩统计 </h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> \x3c!--<span class="date_sel">\n                        <input type="text"  uib-datepicker-popup ng-model="params.startdate" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly  ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"/>\n                        <button type="button"  ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button>\n                    </span> —--\x3e <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> \x3c!--<span class="date_sel">\n                        <input type="text"  uib-datepicker-popup ng-model="params.enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly  ng-click="dateIsOpenedE = !dateIsOpenedE"/>\n                        <button type="button"  ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button>\n                    </span>--\x3e <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> \x3c!-- <div class="btn-group" uib-dropdown ng-if="isCenter">\n                    <button id="single-button" type="button" class="btn btn-default" uib-dropdown-toggle ng-disabled="disabled">\n                        <span ng-bind="params.selectedText"></span> <span class="caret"></span>\n                    </button>\n                    <ul class="dropdown-menu dropdown-menu-multiselect" uib-dropdown-menu  role="menu" aria-labelledby="single-button"  ng-click=" $event.stopPropagation();">\n                        <li role="menuitem"> <button class="btn btn-default" ng-click="params.selectedAll(true)">全选</button> <button class="btn btn-default"  ng-click="params.selectedAll(false)">取消</button></li>\n                        <li role="menuitem" ng-repeat="city in cities"><label ng-click="params.setSelectedText()"><input type="checkbox"  ng-model="city.selected" ng-value="true">{{::city.Name}}</label></li>\n                    </ul>\n                </div> --\x3e <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> <th rowspan="2">省</th> <th rowspan="2">市</th> <th rowspan="2">一级代理商</th> <th rowspan="2">二级代理商</th> <th colspan="3" class="text-center">应收</th> <th colspan="3" class="text-center">实收</th> <th colspan="3" class="text-center">订单数量</th> </tr> <tr class="info"> <th>小规模</th> <th>一般纳税人</th> <th>合计</th> <th>小规模</th> <th>一般纳税人</th> <th>合计</th> <th>小规模</th> <th>一般纳税人</th> <th>合计</th> </tr> <tr> <th colspan="4">合计</th> <th class="text-right">{{aYSSmall.toFixed(2)}}</th> <th class="text-right">{{aYSGeneral.toFixed(2)}}</th> <th class="text-right">{{aYSHJ.toFixed(2)}}</th> <th class="text-right">{{aSSSmall.toFixed(2)}}</th> <th class="text-right">{{aSSGeneral.toFixed(2)}}</th> <th class="text-right">{{aSSHJ.toFixed(2)}}</th> <th class="text-right">{{aOrderNumSmall}}</th> <th class="text-right">{{aOrderNumGeneral}}</th> <th class="text-right">{{aOrderNumHJ}}</th> </tr> </thead> <tbody> <tr ng-repeat="row in rows track by row.ChannelId"> <td ng-repeat="col in row.cols  track by $index" ng-class="{\'text-right\': rightAlign && rightAlign.indexOf($index)>-1}" ng-bind-html="col"></td> </tr> </tbody> </table> </div> </div> </div>'),a.put("views/addCustomers.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">{{::title}}</h3> </div> <div class="modal-body clearfix"> <form name="vm.form" novalidate class="form-inline"> <formly-form model="vm.model" fields="vm.fields" options="vm.options" form="vm.form"> </formly-form> </form>  </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="save()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/addMoney.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">充值金额</h3> </div> <div class="modal-body clearfix"> <div>{{::channel.ChannelName1}}<span ng-if="channel.ChannelName2">&gt;{{::channel.ChannelName2}}</span></div> <div>余额：{{::channel.Balance}}</div> <br><br> <form class="agform"> <span for="">充值金额</span> <input type="text" ng-model="money"> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">添加</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/addMoneyDetail.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">充值明细</h3> </div> <div class="modal-body"> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th>序号</th> <th ng-repeat="head in headers" ng-bind="head"></th> </tr> </thead> <tbody> <tr ng-repeat="row in data"> <td ng-bind="$index+1"></td> <td ng-repeat="col in row.cols  track by $index" ng-class="{\'text-right\': rightAlign && rightAlign.indexOf($index)>-1}" ng-bind-html="col"></td> </tr> </tbody> </table> <div class="u-paginator form-inline"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> <div class="modal-footer"> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),
a.put("views/addOrder.html",'<div class="order"> <form class="form-horizontal" name="myForm" ng-submit="save()" novalidate ng-controller="AddOrderCtrl" ng-class="{readonly:isReadOnly,submited:submited}"> <p ng-if="hasBalance" class="u-balance">账户余额:<span style="color: red">{{::balance}}</span> </p> <p> <label>销售员：</label> <span ng-if="postData.OrderId" ng-bind="postData.SalerName"></span> <select ng-if="!postData.OrderId" ng-model="postData.SalesId"> <option value="{{::sale.UserId}}" ng-repeat="sale in sales" ng-bind="sale.RealName"></option> </select> <span ng-if="postData.OrderId">订单号:{{::postData.OrderId}} ,&nbsp;所属公司:{{::postData.ChannelName}},&nbsp;提单人:{{::postData.BillName}}</span> </p> <p> <label style="font-size: 1.5em;color: red"> <input type="checkbox" ng-model="isNewCompany" ng-value="true" ng-disabled="postData.OrderId" ng-change="setCategory()" style="vertical-align: initial; height:22px; width:22px"> 预提单</label> </p> <div ng-if="category==1"> <div bu-group="客户信息"> <table class="table table-bordered"> <tbody> <tr> <th colspan="4" style="text-align:left"> <span class="t_header">客户基本信息</span> </th> </tr> <tr> <td class="required">公司名称</td> <td> <input type="text" typeahead-min-length="3" ng-if="(!isReadOnly) && (!postData.CustomerId) || isCenter" ng-model="postData.Name" uib-typeahead="item.Name for item in getCompanyName($viewValue)" typeahead-loading="loadingLocations" required typeahead-on-select="companySelect($item, $model, $label, $event)"><i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i> <span ng-bind="postData.Name" ng-if="isReadOnly|| postData.CustomerId && !isCenter"></span> </td> <td class="required">所在城市</td> <td> <select ng-model="postData.CityCode" ng-disabled="isReadOnly" required> <option ng-repeat="city in cities" ng-selected="postData.CityCode == city.CityCode" value="{{city.CityCode}}">{{::city.CityName}}</option> </select> </td> </tr> <tr> <td class="required">公司地址</td> <td> <input type="text" ng-model="postData.Address" ng-if="!isReadOnly" maxlength="100" required> <span ng-bind="postData.Address" ng-if="isReadOnly"></span> </td> <td class="required">所属行业</td> <td> <select ng-model="postData.Industry" ng-disabled="isReadOnly" required> <option ng-repeat="item in industries" value="{{item.IndustryId}}" ng-bind="item.IndustryName"></option> </select> </td> </tr> <tr> <td class="required">公司性质</td> <td> <select ng-model="postData.AddedValue" ng-disabled="isReadOnly" ng-change="clearPaytype()" required> <option value="1">小规模</option> <option value="2">一般纳税人</option> </select> </td> <td class="required">联系人</td> <td> <input type="text" ng-model="postData.Contacts" ng-if="!isReadOnly" maxlength="10" required> <span ng-bind="postData.Contacts" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">手机</td> <td> <input type="text" ng-model="postData.Mobile" ng-if="!isReadOnly" maxlength="11" required> <span ng-bind="postData.Mobile" ng-if="isReadOnly"></span> </td> <td></td> <td></td> </tr> </tbody> </table> <table class="table table-bordered"> <thead> <th colspan="4" style="text-align:left"> <span class="t_header">营业执照信息</span> </th> </thead> <tbody> <tr> <td class="required">注册号</td> <td> <input type="text" ng-model="postData.RegNO" ng-if="!isReadOnly" maxlength="20" required> <span ng-bind="postData.RegNO" ng-if="isReadOnly"></span> </td> <td class="required">法人</td> <td> <input type="text" ng-model="postData.LegalPerson" ng-if="!isReadOnly" maxlength="20" required> <span ng-bind="postData.LegalPerson" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">国税登记号</td> <td> <input type="text" ng-model="postData.NationalTaxNO" ng-if="!isReadOnly" maxlength="20" required> <span ng-bind="postData.NationalTaxNO" ng-if="isReadOnly"></span> </td> <td class="required">地税登记号</td> <td> <input type="text" ng-model="postData.LocalTaxNO" ng-if="!isReadOnly" maxlength="20" required> <span ng-bind="postData.LocalTaxNO" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">营业期限</td> <td> <span class="date_sel"> <input type="text" uib-datepicker-popup ng-model="postData.RegisterDate" is-open="dateIsOpened11" datepicker-options="dateOptions" close-text="关闭" current-text="今天" clear-text="清空" ng-click="dateIsOpened11 = !dateIsOpened11" ng-disabled="isReadOnly" required> <button type="button" ng-click="dateIsOpened11 = !dateIsOpened11" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span>- <span class="date_sel" ng-hide="isReadOnly && (postData.NoDeadLine == 1)"> <input type="text" uib-datepicker-popup ng-model="postData.BusnissDeadline" is-open="dateIsOpened1" datepicker-options="dateOptions" close-text="关闭" current-text="今天" clear-text="清空" ng-click="dateIsOpened1 = !dateIsOpened1" ng-disabled="isReadOnly || postData.NoDeadLine"> <button type="button" ng-click="dateIsOpened1 = !dateIsOpened1" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> <label ng-hide="isReadOnly && (postData.NoDeadLine == 0)"> <input ng-hide="isReadOnly && (postData.NoDeadLine == 1)" type="checkbox" name="noLimitDate" ng-readonly="isReadOnly" value="1" ng-click="postData.NoDeadLine = !postData.NoDeadLine; " ng-checked="postData.NoDeadLine == 1"> 无期限 </label> </td> <td class="required">注册资金</td> <td> <input type="text" ng-model="postData.RegisteredCapital" ng-if="!isReadOnly" maxlength="15" required> <span ng-bind="postData.RegisteredCapital" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">经营范围</td> <td> <textarea ng-model="postData.BusinessScope" ng-if="!isReadOnly" style="width:80%" rows="5" required></textarea> <pre class="order_pre" ng-bind="postData.BusinessScope" ng-if="isReadOnly"></pre> </td> <td class="required">上传营业执照</td> <td> <img ng-src="{{postData.BusinessLicense}}" ng-if="postData.BusinessLicense" class="order-img" alt="" pic-view> <input type="file" nv-file-select="" uploader="uploader2" ng-show="!isReadOnly"> <div class="progress" style="width:80%;margin-left:90px" ng-if="uploader2.isUploading"> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': uploader2.progress + \'%\' }" style="width: 100%"></div> </div> <span>上传的图片大小请不要超过1M。</span> </td> </tr> </tbody> </table> </div> <div bu-group="合同信息"> <table class="table table-bordered"> <tbody> <tr> <td class="required">合同编号</td> <td> <input type="text" ng-model="postData.ContractNO" ng-if="!isReadOnly" required> <span ng-bind="postData.ContractNO" ng-if="isReadOnly"></span> </td> <td class="required">付款方式</td> <td> <div ng-if="!postData.FreChangeOrderId"> <select ng-model="postData.PayType" ng-disabled="isReadOnly" required ng-change="getPayType()"> <option ng-repeat="pt in payTypes" ng-if="postData.AddedValue == pt.AddedValue" value="{{pt.Id}}">{{pt.PriceName}}</option> </select> <select ng-model="postData.gift" ng-if="showGift && !isReadOnly" ng-change="setgift();"> <option value="">不使用礼包</option> <option ng-repeat="item in gifts" value="{{item.Id}}" ng-selected="postData.gift == item.Id" ng-disabled="{{item.Num ===0}}">{{::item.GiftTypeName}}(￥{{::item.Price}})</option> </select> <span ng-if="isReadOnly && postData.GiftStr">礼包:{{::postData.GiftStr}}</span> <label style="color: red" ng-if="showProm"> <input type="checkbox" ng-model="postData.IsPromotion" ng-disabled="IsPromotionValid()||isReadOnly">{{::promotion.PromotionName}}<span ng-if="promotion.Num<20"> (剩余{{::promotion.Num}})</span> </label> <label style="color: red" ng-if="postData.IsPromotion && !showProm">{{::promotion.PromotionName}}</label> <br> <small style="color:red">注:零税指零报税并且零票据。</small> </div> <div ng-if="postData.FreChangeOrderId">企业性质变更</div> </td> </tr> <tr> <td class="required">签订日期</td> <td> <span class="date_sel"> <input type="text" uib-datepicker-popup ng-model="postData.ContractDate" is-open="dateIsOpened" datepicker-options="dateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpened = !dateIsOpened" ng-disabled="isReadOnly" required> <button type="button" ng-click="dateIsOpened = !dateIsOpened" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> </td> <td class="required">开始账期</td> <td> <span class="date_sel"> <input type="text" uib-datepicker-popup="yyyy-MM" ng-model="postData.ServiceStart" is-open="dateIsOpened3" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpened3 = !dateIsOpened3" ng-disabled="isReadOnly" required> <button type="button" ng-click="dateIsOpened3 = !dateIsOpened3" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> <small style="color:red">注:以实际账期为准。</small> </td> </tr> <tr> <td class="required">结束账期</td> <td> <span class="date_sel" ng-if="!isReadOnly"> <input type="text" ng-if="!isReadOnly" ng-model="postData.ServiceEnd" disabled ng-value="setEndDate()"> <button type="button" ng-click="dateIsOpened4 = !dateIsOpened4" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> <span ng-if="isReadOnly">{{postData.ServiceEnd}}</span> <small style="color:red">注:以实际账期为准。</small> </td> <td class="required">合同金额</td> <td style="min-width:400px;width:45%"> <input type="text" ng-model="postData.ContractAmount" ng-if="!isReadOnly" ng-readonly="true" ng-value="setprice()" required><span ng-bind="postData.ContractAmount" ng-if="isReadOnly"></span> <br> <small style="color:red">注:合同金额根据所属城市、公司性质和付款方式自动计算，不包含礼包价格。</small> </td> </tr> <tr> <td>备注</td> <td colspan="3"> <input type="text" ng-model="postData.ContractDescription" ng-if="!isReadOnly" style="width:90%"> <span ng-bind="postData.ContractDescription" ng-if="isReadOnly"> </span></td> </tr> <tr> <td>合同照片</td> <td colspan="3" height="60"> <img ng-cloak ng-repeat="path in postData.ContractPath" ng-src="{{path}}" class="order-img" alt="" pic-view> <input type="file" nv-file-select="" uploader="uploader3" ng-show="!isReadOnly" style="display: block; margin: 20px 0"> <div class="progress" style="width:80%;margin-left:90px" ng-if="uploader3.isUploading"> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': uploader3.progress + \'%\' }" style="width: 100%; text-align: center">{{uploader3.progress}}%</div> </div> <span>上传的图片大小请不要超过1M。</span> </td> </tr> </tbody> </table> </div> </div> <div ng-if="category==2"> <div bu-group="客户信息"> <table class="table table-bordered"> <tbody> <tr> <th colspan="4" style="text-align:left"> <span class="t_header">客户基本信息</span> </th> </tr> <tr> <td class="required">联系人</td> <td> <input type="text" ng-model="postData.Contacts" ng-if="!isReadOnly" maxlength="10" required> <span ng-bind="postData.Contacts" ng-if="isReadOnly"></span> </td> <td class="required">手机</td> <td> <input type="text" ng-model="postData.Mobile" ng-if="!isReadOnly" maxlength="11" required> <span ng-bind="postData.Mobile" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">所在城市</td> <td> <select ng-model="postData.CityCode" ng-disabled="isReadOnly" required> <option ng-repeat="city in cities" ng-selected="postData.CityCode == city.CityCode" value="{{city.CityCode}}">{{::city.CityName}}</option> </select> </td> <td class="required">公司性质</td> <td> <select ng-model="postData.AddedValue" ng-disabled="isReadOnly" required> <option value="1">小规模</option> <option value="2">一般纳税人</option> </select> </td> </tr> <tr> <td class="required">法人</td> <td> <input type="text" ng-model="postData.LegalPerson" ng-if="!isReadOnly" maxlength="20" required> <span ng-bind="postData.LegalPerson" ng-if="isReadOnly"></span> </td> <td class="required">上传法人身份证照片</td> <td> <img ng-src="{{postData.PersonCardPath}}" ng-if="postData.PersonCardPath" class="order-img" alt="" pic-view> <input type="file" nv-file-select="" uploader="uploader1" ng-show="!isReadOnly"> <div class="progress" style="width:80%" ng-if="uploader1.isUploading"> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': uploader1.progress + \'%\' }" style="width: 100%"></div> </div> </td> </tr> </tbody> </table> </div> <div bu-group="合同信息"> <table class="table table-bordered"> <tbody> <tr> <td class="required">合同编号</td> <td> <input type="text" ng-model="postData.ContractNO" ng-if="!isReadOnly" required> <span ng-bind="postData.ContractNO" ng-if="isReadOnly"></span> </td> <td class="required">付款方式</td> <td> <select ng-model="postData.PayType" ng-disabled="isReadOnly" required ng-change="getPayType()"> <option ng-repeat="pt in payTypes" ng-if="postData.AddedValue == pt.AddedValue" value="{{pt.Id}}">{{pt.PriceName}}</option> </select> <select ng-model="postData.gift" ng-if="showGift && !isReadOnly" ng-change="setgift();"> <option value="">不使用礼包</option> <option ng-repeat="item in gifts" value="{{item.Id}}" ng-disabled="{{item.Num ===0}}" ng-disabled="{{item.Num ===0}}">{{::item.GiftTypeName}}(￥{{::item.Price}})</option> </select> <span ng-if="isReadOnly && postData.GiftStr">礼包:{{::postData.GiftStr}}</span> <label style="color: red" ng-if="showProm"> <input type="checkbox" ng-model="postData.IsPromotion" ng-disabled="IsPromotionValid()||isReadOnly">{{::promotion.PromotionName}}<span ng-if="promotion.Num<20"> (剩余{{::promotion.Num}})</span> </label> <label style="color: red" ng-if="postData.IsPromotion && !showProm">{{::promotion.PromotionName}}</label> \x3c!-- <label style="color: red" ng-if="showProm">\n                                    <input type="checkbox" ng-model="postData.IsPromotion" ng-disabled="IsPromotionValid()||isReadOnly">{{::promotion.ProName}}:{{::promotion.Description}}\n                                    <span ng-if="promotion.PromNum<20">(剩余{{::promotion.PromNum}})</span>\n                                  </label> --\x3e \x3c!-- <label style="color: red" ng-if="postData.IsPromotion && !showProm">{{::postData.Promotion.PromotionName}}:{{::postData.Promotion.Description}}</label> --\x3e <br> <small style="color:red">注:零税指零报税并且零票据。</small> </td> </tr> <tr> <td class="required">签订日期</td> <td> <span class="date_sel"> <input type="text" uib-datepicker-popup ng-model="postData.ContractDate" is-open="dateIsOpened" datepicker-options="dateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpened = !dateIsOpened" ng-disabled="isReadOnly" required> <button type="button" ng-click="dateIsOpened = !dateIsOpened" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> </td> <td class="required">合同金额</td> <td style="min-width:400px;width:45%"> <span><input type="text" ng-model="postData.ContractAmount" ng-if="!isReadOnly" ng-readonly="true" ng-value="setprice()" required><span ng-bind="postData.ContractAmount" ng-if="isReadOnly"></span> <br> <small style="color:red">注:合同金额根据所属城市、公司性质和付款方式自动计算，不包含礼包价格。</small> </span></td> </tr> <tr> <td>备注</td> <td colspan="3"> <input type="text" ng-model="postData.ContractDescription" ng-if="!isReadOnly" style="width:90%"> <span ng-bind="postData.ContractDescription" ng-if="isReadOnly"></span> </td> </tr> <tr> <td>合同照片</td> <td colspan="3" height="60"> <img ng-cloak ng-repeat="path in postData.ContractPath" ng-src="{{path}}" class="order-img" alt="" pic-view> <input type="file" nv-file-select="" uploader="uploader3" ng-show="!isReadOnly" style="display: block; margin: 20px 0"> <div class="progress" style="width:80%;margin-left:90px" ng-if="uploader3.isUploading"> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': uploader3.progress + \'%\' }" style="width: 100%; text-align: center">{{uploader3.progress}}%</div> </div> </td> </tr> </tbody> </table> </div> </div> <div ng-if="category==3"> <div bu-group="客户信息"> <table class="table table-bordered"> <tbody> <tr> <th colspan="4" style="text-align:left"> <span class="t_header">客户基本信息</span> </th> </tr> <tr> <td class="required">公司名称</td> <td> <input type="text" ng-if="!isReadOnly" ng-model="postData.Name" required> <span ng-bind="postData.Name" ng-if="isReadOnly"></span> </td> <td class="required">所在城市</td> <td> <select ng-model="postData.CityCode" required disabled> <option ng-repeat="city in cities" ng-selected="postData.CityCode == city.CityCode" value="{{city.CityCode}}">{{::city.CityName}}</option> </select> </td> </tr> <tr> <td class="required">公司地址</td> <td> <input type="text" ng-model="postData.Address" ng-if="!isReadOnly" maxlength="100" required> <span ng-bind="postData.Address" ng-if="isReadOnly"></span> </td> <td class="required">所属行业</td> <td> <select ng-model="postData.Industry" ng-disabled="isReadOnly" required> <option ng-repeat="item in industries" value="{{item.IndustryId}}" ng-bind="item.IndustryName"></option> </select> </td> </tr> <tr> <td class="required">公司性质</td> <td> <select ng-model="postData.AddedValue" disabled required> <option value="1">小规模</option> <option value="2">一般纳税人</option> </select> </td> <td class="required">联系人</td> <td> <input type="text" ng-model="postData.Contacts" ng-if="!isReadOnly" maxlength="10" required> <span ng-bind="postData.Contacts" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">手机</td> <td> <input type="text" ng-model="postData.Mobile" ng-if="!isReadOnly" maxlength="11" required> <span ng-bind="postData.Mobile" ng-if="isReadOnly"></span> </td> <td></td> <td></td> </tr> </tbody> </table> <table class="table table-bordered"> <thead> <th colspan="4" style="text-align:left"> <span class="t_header">营业执照信息</span> </th> </thead> <tbody> <tr> <td class="required">注册号</td> <td> <input type="text" ng-model="postData.RegNO" ng-if="!isReadOnly" maxlength="20" required> <span ng-bind="postData.RegNO" ng-if="isReadOnly"></span> </td> <td class="required">法人</td> <td> <span ng-bind="postData.LegalPerson"></span> </td> </tr> <tr> <td class="required">国税登记号</td> <td> <input type="text" ng-model="postData.NationalTaxNO" ng-if="!isReadOnly" maxlength="20" required> <span ng-bind="postData.NationalTaxNO" ng-if="isReadOnly"></span> </td> <td class="required">地税登记号</td> <td> <input type="text" ng-model="postData.LocalTaxNO" ng-if="!isReadOnly" maxlength="20" required> <span ng-bind="postData.LocalTaxNO" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">营业期限</td> <td> <span class="date_sel"> <input type="text" uib-datepicker-popup ng-model="postData.RegisterDate" is-open="dateIsOpened11" datepicker-options="dateOptions" close-text="关闭" current-text="今天" clear-text="清空" ng-click="dateIsOpened11 = !dateIsOpened11" ng-disabled="isReadOnly" required> <button type="button" ng-click="dateIsOpened11 = !dateIsOpened11" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span>- <span class="date_sel" ng-hide="isReadOnly && (postData.NoDeadLine == 1)"> <input type="text" uib-datepicker-popup ng-model="postData.BusnissDeadline" is-open="dateIsOpened1" datepicker-options="dateOptions" close-text="关闭" current-text="今天" clear-text="清空" ng-click="dateIsOpened1 = !dateIsOpened1" ng-disabled="isReadOnly || postData.NoDeadLine"> <button type="button" ng-click="dateIsOpened1 = !dateIsOpened1" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> <label ng-hide="isReadOnly && (postData.NoDeadLine == 0)"> <input ng-hide="isReadOnly && (postData.NoDeadLine == 1)" type="checkbox" name="noLimitDate" ng-readonly="isReadOnly" value="1" ng-click="postData.NoDeadLine = !postData.NoDeadLine; " ng-checked="postData.NoDeadLine == 1"> 无期限 </label> </td> <td class="required">注册资金</td> <td> <input type="text" ng-model="postData.RegisteredCapital" ng-if="!isReadOnly" maxlength="15" required> <span ng-bind="postData.RegisteredCapital" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">经营范围</td> <td> <textarea ng-model="postData.BusinessScope" ng-if="!isReadOnly" style="width:80%" rows="5" required></textarea> <pre class="order_pre" ng-bind="postData.BusinessScope" ng-if="isReadOnly"></pre> </td> <td class="required">上传营业执照</td> <td> <img ng-src="{{postData.BusinessLicense}}" ng-if="postData.BusinessLicense" class="order-img" alt="" pic-view> <input type="file" nv-file-select="" uploader="uploader2" ng-show="!isReadOnly" style="display: block; margin: 20px 0 0 0"> <div class="progress" style="width:80%" ng-if="uploader2.isUploading"> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': uploader2.progress + \'%\' }" style="width: 100%"></div> </div> <span>上传的图片大小请不要超过1M。</span> </td> </tr> </tbody> </table> </div> <div bu-group="合同信息"> <table class="table table-bordered"> <tbody> <tr> <td class="required">合同编号</td> <td> <input type="text" ng-model="postData.ContractNO" ng-if="!isReadOnly" disabled required> <span ng-bind="postData.ContractNO" ng-if="isReadOnly"></span> </td> <td class="required">付款方式</td> <td> <select ng-model="postData.PayType" disabled required> <option ng-repeat="pt in payTypes" ng-if="postData.AddedValue == pt.AddedValue" value="{{pt.Id}}">{{pt.PriceName}}</option> </select> <span ng-if="postData.GiftTypeName">礼包:{{::postData.GiftTypeName}}</span> <label style="color: red" ng-if="showProm"> <input type="checkbox" ng-model="postData.IsPromotion" ng-disabled="IsPromotionValid()||isReadOnly">{{::promotion.PromotionName}}<span ng-if="promotion.Num<20"> (剩余{{::promotion.Num}})</span> </label> <label style="color: red" ng-if="postData.IsPromotion && !showProm">{{::promotion.PromotionName}}</label> \x3c!-- <label style="color: red" ng-if="showProm">\n                                    <input type="checkbox" ng-model="postData.IsPromotion" ng-disabled="IsPromotionValid() ||isReadOnly">{{::promotion.ProName}}:{{::promotion.Description}}\n                                    <span ng-if="promotion.PromNum<20">(剩余{{::promotion.PromNum}})</span>\n                                  </label> --\x3e \x3c!-- <label style="color: red" ng-if="postData.IsPromotion && !showProm">{{::postData.Promotion.PromotionName}}:{{::postData.Promotion.Description}}</label> --\x3e <br> <small style="color:red">注:零税指零报税并且零票据。</small> </td> </tr> <tr> <td class="required">签订日期</td> <td> <span class="date_sel"> <input type="text" uib-datepicker-popup ng-model="postData.ContractDate" is-open="dateIsOpened" datepicker-options="dateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpened = !dateIsOpened" disabled required> <button type="button" disabled ng-click="dateIsOpened = !dateIsOpened" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> </td> <td class="required">开始账期</td> <td> <span class="date_sel"> <input type="text" uib-datepicker-popup="yyyy-MM" ng-model="postData.ServiceStart" is-open="dateIsOpened3" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpened3 = !dateIsOpened3" ng-disabled="isReadOnly" required> <button type="button" ng-click="dateIsOpened3 = !dateIsOpened3" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> <small style="color:red">注:以实际账期为准。</small> </td> </tr> <tr> <td class="required">结束账期</td> <td> <span class="date_sel"> <input type="text" ng-model="postData.ServiceEnd" disabled ng-value="setEndDate()"> <button type="button" ng-click="dateIsOpened4 = !dateIsOpened4" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> <small style="color:red">注:以实际账期为准。</small> </td> <td class="required">合同金额</td> <td style="min-width:400px;width:45%"> <input type="text" ng-model="postData.ContractAmount" ng-if="!isReadOnly" ng-readonly="true" required><span ng-bind="postData.ContractAmount" ng-if="isReadOnly"></span> <br> <small style="color:red">注:合同金额根据所属城市、公司性质和付款方式自动计算，不包含礼包价格。</small> </td> </tr> <tr> <td>备注</td> <td colspan="3"> <span ng-bind="postData.ContractDescription"> </span></td> </tr> <tr> <td>合同照片</td> <td colspan="3" height="60"> <img ng-cloak ng-repeat="path in postData.ContractPath" ng-src="{{path}}" class="order-img" alt="" pic-view> </td> </tr> </tbody> </table> </div> </div> <div bu-group="提单备注"> <div>提单特殊备注信息</div> <textarea name="" id="" cols="100" rows="3" ng-model="postData.Remark" ng-if="!isReadOnly"></textarea> <pre ng-bind="postData.Remark" ng-if="isReadOnly"></pre> </div> <div bu-group="拒审原因" ng-if="postData.Status === 3"> <span ng-bind="postData.BackReason" style="color:red"></span> </div> <div class="text-center container-fluid"> <button ng-show="!isReadOnly" type="submit" class="btn btn-primary save">保存</button> <button ng-if="postData.Status === 3 && !isReadOnly" type="button" class="btn btn-primary save" ng-click="save(true)">提交</button> <a ng-if="showClose" class="btn btn-primary" ng-click="close();">关闭</a> </div> </form> </div>'),
a.put("views/addOrder2.html",'<form class="form-horizontal add-order-container" name="myForm" novalidate ng-submit="save()" ng-controller="AddOrderCtrl2" ng-class="{submited:submited}"> <div> <div> <p class="form-control-static">账户余额：<span class="amount-balance">￥{{balance}}</span></p> </div> <div> <p ng-if="!postData.OrderId" class="form-control-static"> <span><span class="red">*</span>销售：</span> <select class="select-style c" ng-model="postData.SalesId"> <option value="">请选择销售</option> <option value="{{::sale.UserId}}" ng-repeat="sale in sales" ng-bind="sale.RealName"></option> </select> </p> <p ng-if="postData.OrderId" class="form-control-static">销售：{{postData.SalerName}} 订单号：{{postData.OrderId}} 所属公司：{{postData.ChannelName}} 提单员：{{postData.BillName}}</p> </div> <div> <p class="form-control-static"> <label class="present-bill"> <input type="checkbox" ng-model="isNewCompany" ng-disabled="postData.OrderId || xfReadonly" ng-change="setCategory()"> <span>预提单</span> </label> </p> </div> <div class="gray-line"></div> \x3c!-- 标题 --\x3e \x3c!-- 新增 --\x3e <div ng-if="category==1"> <div class="add-order-title"> <span>基本信息</span> </div> <div class="custom-tips"> \x3c!-- <i class="fa fa-exclamation-circle" aria-hidden="true"></i> --\x3e <span>【温馨提示】可通过“检索”或“快速录入”按钮，帮您完成工商信息的快速录入。</span> </div> <div class="row mt-20" style="position:relative"> <div class="col-md-6"> <label class="col-md-3 control-label"><span class="required"></span>公司名称：</label> <div class="col-md-8"> \x3c!-- <div ng-if="!orderId"> --\x3e <div> <input type="text" class="form-control" placeholder="请输入准确完整的公司名称" ng-model="postData.Name" ng-keyup="clearCompanyInfo()" ng-disabled="nameReadonly || orderId" style="width: 85%" ng-blur="closeList()" required> <div ng-show="!isReadOnly" ng-click="toCheck()" id="exampleInputAmount" aria-haspopup="true" aria-expanded="false" class="input-group-addon input-group-addon-bg-blue add-order2-button-toCheck-style">检索</div> \x3c!-- <div ng-click="fastCheck()"  id="exampleInputAmount" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="input-group-addon input-group-addon-bg-blue add-order2-button-style">快速录入</div> --\x3e <ul class="dropdown-menu dropdown-company-list" aria-labelledby="exampleInputAmount"> <li ng-repeat="item in companyList" ng-click="companySelect(item.Name, item.id)"><a href="javascript:void(0)">{{item.Name}}</a></li> </ul> </div> \x3c!-- <div ng-if="orderId" class="input-group" style="width:100%"> --\x3e \x3c!-- <span style="display: inline-block;height: 32px;line-height: 32px;">{{postData.Name}}</span> --\x3e \x3c!-- <input type="text" class="form-control" ng-model="postData.Name" disabled required> --\x3e \x3c!-- </div> --\x3e <span style="color: red; font-size: 12px" ng-if="searchError" ng-bind="searchError"></span> </div> <div ng-show="!isReadOnly" ng-click="fastCheck()" id="exampleInputAmount" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="input-group-addon input-group-addon-bg-blue add-order2-button-style">快速录入</div> <div class="clearfix mb-20"></div> <label class="col-md-3 control-label"><span class="required"></span>联系人：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.Contacts" maxlength="10" ng-disabled="isReadOnly" required> </div> </div> <div class="col-md-6"> <ul class="business-license-right"> <li> <label class="col-md-3 control-label"><span class="required"></span>所在城市：</label> <div class="col-md-3"> <select class="form-control" ng-model="postData.CityCode" ng-disabled="isReadOnly" style="width:112%"> <option ng-repeat="city in cities" ng-selected="postData.CityCode == city.CityCode" value="{{city.CityCode}}">{{::city.CityName}}</option> </select> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>手机号：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.Mobile" maxlength="11" ng-disabled="isReadOnly" required> </div> </li> </ul> </div> </div> <div class="add-order-title"> <span>工商信息</span> </div> <div class="row"> <div class="col-md-6"> <custom-file-uploader class="ml-20" ng-model="postData.PersonCardPath" uploader="ImgUploader" title="请上传清晰的身份证人像面，图片大小不要超过3M" ng-disabled="isReadOnly"></custom-file-uploader> <custom-file-uploader ng-model="postData.BusinessLicense" uploader="ImgUploader1" class="mt-40 ml-20" title="请上传清晰的营业执照，图片大小不要超过3M" ng-disabled="isReadOnly"></custom-file-uploader> </div> <div class="col-md-6"> <ul class="business-license-right"> <li> <label class="col-md-3 control-label"><span class="required"></span>法人姓名：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.LegalPerson" maxlength="20" ng-disabled="isLegalPersonReadonly || isReadOnly" required> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>法人身份证号：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.PersonCardID" maxlength="18" ng-disabled="isReadOnly" required> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>公司住所：</label> <div class="col-md-8"> <textarea class="form-control" ng-model="postData.Address" maxlength="100" ng-disabled="isAddressReadonly || isReadOnly" required></textarea> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>统一信用代码：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.RegNO" maxlength="18" ng-disabled="isRegNOReadonly || isReadOnly" required> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>营业期限：</label> <div class="col-md-8"> <div class="input-group" style="width:120%"> <input type="text" class="date-input" uib-datepicker-popup ng-model="postData.RegisterDate" is-open="startDateIsOpened" datepicker-options="startDateOptions" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="startDateIsOpened = !startDateIsOpened" ng-change="setMinDate()" ng-disabled="isCompanyReadonly || isReadOnly" required> <span class="input-group-date">-</span> <input ng-hide="isReadOnly && postData.NoDeadLine" type="text" class="date-input" uib-datepicker-popup ng-model="postData.BusnissDeadline" is-open="endDateIsOpened" datepicker-options="endDateOptions" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-disabled="postData.NoDeadLine || isCompanyReadonly || isReadOnly" ng-click="endDateIsOpened = !endDateIsOpened" ng-change="setMinDate()"> <label class="date-deadline" ng-hide="isReadOnly && !postData.NoDeadLine"> <input ng-hide="isReadOnly && postData.NoDeadLine" type="checkbox" name="noLimitDate" ng-readonly="isReadOnly" value="1" ng-click="clearEndDate()" ng-checked="postData.NoDeadLine == 1" ng-disabled="isCompanyReadonly || isReadOnly"> 无期限 </label> </div> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>注册资金：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.RegisteredCapital" ng-disabled="isRegisteredCapitalReadonly || isReadOnly" required> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>经营范围：</label> <div class="col-md-8"> <textarea type="text" class="form-control" rows="9" ng-model="postData.BusinessScope" ng-disabled="isBusinessScopeReadonly || isReadOnly" required></textarea> </div> </li> </ul> </div> </div> <div class="add-order-title"> <span>合同信息</span> </div> <div> <div class="form-group"> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>合同编号： </label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.ContractNO" ng-disabled="isReadOnly" required> </div> </div> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>纳税人类别： </label> <div class="col-md-8"> <label class="radio-inline"> <input type="radio" name="inlineRadioOptions" id="inlineRadio1" ng-model="postData.AddedValue" ng-disabled="isReadOnly" ng-click="clearPaytype()" value="1"> 小规模 </label> <label class="radio-inline"> <input type="radio" name="inlineRadioOptions" id="inlineRadio2" ng-model="postData.AddedValue" ng-disabled="isReadOnly" ng-click="clearPaytype()" value="2"> 一般纳税人 </label> </div> </div> </div> <div class="form-group"> <div class="col-md-9" style="margin-left:-3px"> <label class="col-md-2 control-label" for=""> <span class="required"></span>套餐类型： </label> <div class="col-md-8"> <custom-radio ng-show="!isReadOnly" ng-model="postData.payType" options="payTypes[postData.AddedValue]" ng-click="promitionCanChoose()" ng-disabled="isReadOnly"></custom-radio> <custom-radio ng-show="isReadOnly" ng-model="payTypeReadonly[0]" options="payTypeReadonly" ng-disabled="isReadOnly"></custom-radio> </div> </div> </div> <div class="form-group"> <div class="col-md-9" style="margin-left:-3px"> <div class="col-md-2"></div> <select class="form-control gift-select" ng-model="postData.gift" ng-disabled="isReadOnly"> <option value="">不使用礼包</option> <option ng-repeat="item in gifts[postData.AddedValue]" ng-selected="postData.gift == item.Id" value="{{item.Id}}">{{::item.GiftTypeName}}</option> </select> <div ng-if="!isReadOnly" class="promition-style"> <input ng-show="promotion.PromotionName" type="checkbox" ng-model="postData.IsPromotion" ng-disabled="IsPromotionValid()"> <span>{{promotion.PromotionName}}</span> <span ng-if="promotion.Num<20">(剩余{{::promotion.Num}})</span> </div> <div ng-if="isReadOnly && !promotionShow" class="promition-style"> <span>{{promotion.PromotionName}}</span> </div> </div> </div> <div class="form-group"> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>开始账期： </label> <div class="col-md-8"> <input type="text" class="date-input" uib-datepicker-popup="yyyy-MM" ng-model="postData.ServiceStart" is-open="serviceStartIsOpened" datepicker-options="serviceStartOptions" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="serviceStartIsOpened = !serviceStartIsOpened" ng-disabled="isReadOnly" required> </div> </div> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>结束账期： </label> <div class="col-md-8"> <input ng-if="!isReadOnly" type="text" class="date-input" ng-model="postData.ServiceEnd" ng-value="setEndDate()" disabled> <input ng-if="isReadOnly" type="text" class="date-input" ng-model="postData.ServiceEnd" disabled> </div> </div> </div> <div class="form-group"> <div class="col-md-6"> <label for="" class="col-md-3 control-label"> <span class="required"></span>合同金额： </label> <div class="col-md-6"> <input type="number" class="form-control" ng-model="postData.ContractAmount" ng-value="setprice()" ng-disabled="true"> </div> </div> <div class="col-md-offset-1 col-sm-10 clearfix mt-5"> <p class="red" style="margin-left: 45px">合同金额根据所属城市、纳税人类别、套餐类型自动计算，不包含礼包价格</p> </div> </div> </div> </div> \x3c!-- 预提单 --\x3e <div ng-if="category==2"> <div class="add-order-title"> <span>基本信息</span> </div> <div class="custom-tips"> \x3c!-- <i class="fa fa-exclamation-circle" aria-hidden="true"></i> --\x3e <span>【温馨提示】支持对二代居民身份证的关键字段识别。上传身份证后，即可自动读取并带出姓名、身份证号等信息。</span> </div> <div class="row mt-20"> <div class="col-md-6"> <custom-file-uploader class="ml-20" ng-model="postData.PersonCardPath" uploader="ImgUploader" title="请上传清晰的身份证人像面，图片大小不要超过3M" ng-disabled="isReadOnly"></custom-file-uploader> </div> <div class="col-md-6"> <ul class="business-license-right"> <li> <label class="col-md-3 control-label"><span class="required"></span>所在城市：</label> <div class="col-md-8"> <select class="form-control" ng-model="postData.CityCode" ng-disabled="isReadOnly"> <option ng-repeat="city in cities" ng-selected="postData.CityCode == city.CityCode" value="{{city.CityCode}}">{{::city.CityName}}</option> </select> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>法人姓名：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.LegalPerson" maxlength="20" ng-disabled="isCompanyReadonly || isReadOnly" required> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>法人身份证号：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.PersonCardID" maxlength="18" required ng-disabled="isReadOnly"> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>联系人：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.Contacts" maxlength="10" required ng-disabled="isReadOnly"> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>手机号：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.Mobile" maxlength="11" required ng-disabled="isReadOnly"> </div> </li> </ul> </div> </div> <div> <div class="add-order-title"> <span>合同信息</span> </div> <div class="form-group"> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>合同编号： </label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.ContractNO" required ng-disabled="isReadOnly"> </div> </div> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>纳税人类别： </label> <div class="col-md-8"> <label class="radio-inline"> <input type="radio" name="inlineRadioOptions" id="inlineRadio1" ng-model="postData.AddedValue" ng-click="clearPaytype()" value="1" ng-disabled="isReadOnly"> 小规模 </label> <label class="radio-inline"> <input type="radio" name="inlineRadioOptions" id="inlineRadio2" ng-model="postData.AddedValue" ng-click="clearPaytype()" value="2" ng-disabled="isReadOnly"> 一般纳税人 </label> </div> </div> </div> <div class="form-group"> <div class="col-md-9" style="margin-left:-3px"> <label class="col-md-2 control-label" for=""> <span class="required"></span>套餐类型： </label> <div class="col-md-8"> <custom-radio ng-show="!isReadOnly" ng-model="postData.payType" options="payTypes[postData.AddedValue]" ng-click="promitionCanChoose()" ng-disabled="isReadOnly"></custom-radio> <custom-radio ng-show="isReadOnly" ng-model="payTypeReadonly[0]" options="payTypeReadonly" ng-disabled="isReadOnly"></custom-radio> </div> </div> </div> <div class="form-group"> <div class="col-md-9" style="margin-left:-3px"> <div class="col-md-2"></div> <select class="form-control gift-select" ng-model="postData.gift" ng-disabled="isReadOnly"> <option value="">不使用礼包</option> <option ng-repeat="item in gifts[postData.AddedValue]" ng-selected="postData.gift == item.Id" value="{{item.Id}}">{{::item.GiftTypeName}}</option> </select> <div class="promition-style"> <input ng-show="promotion.PromotionName" type="checkbox" ng-model="postData.IsPromotion" ng-disabled="IsPromotionValid()" ng-change="getChoosePromiton()"> <span>{{promotion.PromotionName}}</span> <span ng-if="promotion.Num<20">(剩余{{::promotion.Num}})</span> </div> </div> </div> <div class="form-group"> <div class="col-md-6"> <label for="" class="col-md-3 control-label"> <span class="required"></span>合同金额： </label> <div class="col-md-6"> <input type="number" class="form-control" ng-model="postData.ContractAmount" ng-value="setprice()" ng-disabled="true"> </div> </div> <div class="col-md-offset-1 col-sm-10 clearfix mt-5"> <p class="red" style="margin-left: 45px">合同金额根据所属城市、纳税人类别、套餐类型自动计算，不包含礼包价格</p> </div> </div> </div> </div> <div ng-if="category==3"> <div class="add-order-title"> <span>基本信息</span> </div> <div class="custom-tips"> \x3c!-- <i class="fa fa-exclamation-circle" aria-hidden="true"></i> --\x3e <span>【温馨提示】可通过“检索”或“快速录入”按钮，帮您完成工商信息的快速录入。</span> </div> <div class="row mt-20" style="position:relative"> <div class="col-md-6"> <label class="col-md-3 control-label"><span class="required"></span>公司名称：</label> <div class="col-md-8"> \x3c!-- <div ng-if="!isChangeCompanyName"> --\x3e <div> <input type="text" class="form-control" placeholder="请输入准确完整的公司名称" ng-model="postData.Name" ng-keyup="clearCompanyInfo()" ng-disabled="nameReadonly || isReadOnly || isChangeCompanyName" required> <div ng-click="toCheck()" id="exampleInputAmount" aria-haspopup="true" aria-expanded="false" class="input-group-addon input-group-addon-bg-blue add-order2-button-toCheck-style">检索</div> \x3c!-- <div ng-click="fastCheck()"  id="exampleInputAmount" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="input-group-addon input-group-addon-bg-blue">快速录入</div> --\x3e <ul class="dropdown-menu dropdown-company-list" aria-labelledby="exampleInputAmount"> <li ng-repeat="item in companyList" ng-click="companySelect(item.Name, item.id)"><a href="javascript:void(0)">{{item.Name}}</a></li> </ul> </div> \x3c!-- <div ng-if="isChangeCompanyName" class="input-group" style="width:100%"> --\x3e \x3c!-- <span style="display: inline-block;height: 32px;line-height: 32px;">{{postData.Name}}</span> --\x3e \x3c!-- <input type="text" class="form-control" ng-model="postData.Name" disabled required> --\x3e \x3c!-- </div> --\x3e <span style="color: red; font-size: 12px" ng-if="searchError" ng-bind="searchError"></span> </div> <div ng-click="fastCheck()" id="exampleInputAmount" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" class="input-group-addon input-group-addon-bg-blue add-order2-button-style">快速录入</div> <div class="clearfix mb-20"></div> <label class="col-md-3 control-label"><span class="required"></span>联系人：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.Contacts" maxlength="10" ng-disabled="isReadOnly" required> </div> </div> <div class="col-md-6"> <ul class="business-license-right"> <li> <label class="col-md-3 control-label"><span class="required"></span>所在城市：</label> <div class="col-md-3"> <select class="form-control" ng-model="postData.CityCode" ng-disabled="complementCompanyInfo || isReadOnly" style="width:112%"> <option ng-repeat="city in cities" ng-selected="postData.CityCode == city.CityCode" value="{{city.CityCode}}">{{::city.CityName}}</option> </select> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>手机号：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.Mobile" maxlength="11" ng-disabled="isReadOnly" required> </div> </li> </ul> </div> </div> <div class="add-order-title"> <span>工商信息</span> </div> <div class="row"> <div class="col-md-6"> <custom-file-uploader class="ml-20" ng-model="postData.PersonCardPath" uploader="ImgUploader" title="请上传清晰的身份证人像面，图片大小不要超过3M" ng-disabled="isReadOnly"></custom-file-uploader> <custom-file-uploader ng-model="postData.BusinessLicense" uploader="ImgUploader1" class="mt-40 ml-20" title="请上传清晰的营业执照，图片大小不要超过3M" ng-disabled="isReadOnly"></custom-file-uploader> </div> <div class="col-md-6"> <ul class="business-license-right"> <li> <label class="col-md-3 control-label"><span class="required"></span>法人姓名：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.LegalPerson" maxlength="20" ng-disabled="isLegalPersonReadonly || isReadOnly" required> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>法人身份证号：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.PersonCardID" maxlength="18" ng-disabled="isReadOnly" required> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>公司住所：</label> <div class="col-md-8"> <textarea class="form-control" ng-model="postData.Address" maxlength="100" ng-disabled="isAddressReadonly || isReadOnly" required></textarea> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>统一信用代码：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.RegNO" maxlength="18" ng-disabled="isRegNOReadonly || isReadOnly" required> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>营业期限：</label> <div class="col-md-8"> <div class="input-group" style="width:120%"> <input type="text" class="date-input" uib-datepicker-popup ng-model="postData.RegisterDate" is-open="startDateIsOpened" datepicker-options="startDateOptions" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="startDateIsOpened = !startDateIsOpened" ng-change="setMinDate()" ng-disabled="isCompanyReadonly || isReadOnly" required> <span class="input-group-date">-</span> <input ng-hide="isReadOnly && postData.NoDeadLine" type="text" class="date-input" uib-datepicker-popup ng-model="postData.BusnissDeadline" is-open="endDateIsOpened" datepicker-options="endDateOptions" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-disabled="postData.NoDeadLine || isCompanyReadonly || isReadOnly" ng-click="endDateIsOpened = !endDateIsOpened" ng-change="setMinDate()"> <label class="date-deadline" ng-hide="isReadOnly && !postData.NoDeadLine"> <input ng-hide="isReadOnly && postData.NoDeadLine" type="checkbox" name="noLimitDate" ng-readonly="isReadOnly" value="1" ng-click="clearEndDate()" ng-checked="postData.NoDeadLine == 1" ng-disabled="isCompanyReadonly || isReadOnly"> 无期限 </label> </div> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>注册资金：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.RegisteredCapital" ng-disabled="isRegisteredCapitalReadonly || isReadOnly" required> </div> </li> <li> <label class="col-md-3 control-label"><span class="required"></span>经营范围：</label> <div class="col-md-8"> <textarea type="text" class="form-control" rows="9" ng-model="postData.BusinessScope" ng-disabled="isBusinessScopeReadonly || isReadOnly" required></textarea> </div> </li> </ul> </div> </div> <div> <div class="add-order-title"> <span>合同信息</span> </div> <div class="form-group"> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>合同编号： </label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.ContractNO" ng-disabled="complementCompanyInfo || isReadOnly" required> </div> </div> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>纳税人类别： </label> <div class="col-md-8"> <label class="radio-inline"> <input type="radio" name="inlineRadioOptions" id="inlineRadio1" ng-model="postData.AddedValue" value="1" ng-disabled="complementCompanyInfo || isReadOnly"> 小规模 </label> <label class="radio-inline"> <input type="radio" name="inlineRadioOptions" id="inlineRadio2" ng-model="postData.AddedValue" value="2" ng-disabled="complementCompanyInfo || isReadOnly"> 一般纳税人 </label> </div> </div> </div> <div class="form-group"> <div class="col-md-9" style="margin-left:-3px"> <label class="col-md-2 control-label" for=""> <span class="required"></span>套餐类型： </label> <div class="col-md-9"> <custom-radio ng-show="!isReadOnly" ng-model="postData.payType" options="payTypes[postData.AddedValue]" ng-click="promitionCanChoose()" ng-disabled="complementCompanyInfo"></custom-radio> <custom-radio ng-show="isReadOnly" ng-model="payTypeReadonly[0]" options="payTypeReadonly" ng-disabled="isReadOnly"></custom-radio> </div> </div> </div> <div class="form-group"> <div class="col-md-9" style="margin-left:-3px"> <div class="col-md-2"></div> <div class="col-md-8"> <select class="form-control gift-select" ng-model="postData.gift" ng-disabled="complementCompanyInfo || isReadOnly"> <option value="">不使用礼包</option> <option ng-repeat="item in gifts[postData.AddedValue]" ng-selected="postData.gift == item.Id" value="{{item.Id}}">{{::item.GiftTypeName}}</option> </select> \x3c!-- <select class="form-control gift-select" ng-model="postData.gift">\n                <option value="">不使用礼包</option>\n                <option ng-repeat="item in gifts[postData.AddedValue]" ng-selected="postData.gift == item.Id" value="{{item.Id}}">{{::item.GiftTypeName}}</option>\n              </select> --\x3e <div class="promition-style"> <input ng-show="promotion.PromotionName" type="checkbox" ng-model="postData.IsPromotion" ng-disabled="complementCompanyInfo"> <span>{{promotion.PromotionName}}</span> <span ng-if="promotion.Num<20">(剩余{{::promotion.Num}})</span> </div> </div> </div> </div> <div class="form-group"> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>开始账期： </label> <div class="col-md-8"> <input type="text" class="date-input" uib-datepicker-popup="yyyy-MM" ng-model="postData.ServiceStart" is-open="serviceStartIsOpened" datepicker-options="serviceStartOptions" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="serviceStartIsOpened = !serviceStartIsOpened" required ng-disabled="isReadOnly"> </div> </div> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>结束账期： </label> <div class="col-md-8"> <input ng-if="!isReadOnly" type="text" class="date-input" ng-model="postData.ServiceEnd" ng-value="setEndDate()" disabled> <input ng-if="isReadOnly" type="text" class="date-input" ng-model="postData.ServiceEnd" disabled> </div> </div> </div> <div class="form-group"> <div class="col-md-6"> <label for="" class="col-md-3 control-label"> <span class="required"></span>合同金额： </label> <div class="col-md-8"> <input type="number" class="form-control" ng-model="postData.ContractAmount" ng-value="setprice()" ng-disabled="true"> </div> </div> <div class="col-md-offset-1 col-sm-10 clearfix mt-5"> <p class="red" style="margin-left: 45px">合同金额根据所属城市、纳税人类别、套餐类型自动计算，不包含礼包价格</p> </div> </div> </div> </div> <div class="form-group"> <div class="col-md-6"> <label for="" class="col-md-3 control-label"> <span></span>合同照片： </label> <div class="col-md-8"> <div class="upload-file-btn pull-left mr-20"> <span>上传文件</span> <input type="file" nv-file-select="" uploader="uploader1" title="上传文件" multiple style="position: absolute;top: 0;left: 0;bottom: 0;right: 0;opacity: 0;width: 130px;margin-left:20px" ng-disabled="isReadOnly"> </div> </div> </div> <div class="col-md-offset-1 col-sm-10 clearfix mt-5"> <p style="margin-left: 45px">请上传清晰的合同照片，图片大小不要超过1M</p> </div> </div> <div class="form-group"> <div class="col-md-1" style="margin-left:45px"></div> <div ng-if="!isReadOnly" class="col-sm-10 img-container clearfix"> <img ng-repeat="img in imgs" ng-src="{{img}}" additional="?x-oss-process=image/resize,m_lfit,h_75,w_100" alt="" pic-view pic-delete="imgs.splice({{$index}},1)"> </div> <div ng-if="isReadOnly" class="col-sm-10 img-container clearfix"> <img ng-repeat="img in imgs" ng-src="{{img}}" additional="?x-oss-process=image/resize,m_lfit,h_75,w_100" alt="" pic-view> </div> </div> <div class="form-group"> <div class="col-md-12"> <label for="" class="col-md-1 control-label" style="margin-left:45px"> <span></span>备注： </label> <div class="col-md-9"> <textarea style="overflow:hidden" class="form-control" id="" rows="4" ng-model="postData.Remark" ng-disabled="isReadOnly"></textarea> </div> </div> </div> <div ng-if="postData.Status === 3"> <div class="add-order-title"> <span>拒审原因</span> </div> <div class="form-group" ng-if="postData.Status === 3"> <div class="col-md-9"> <label for="" class="col-md-2 control-label"> <span></span>驳回原因： </label> <div class="col-md-10" style="margin-top: 8px;color:red">{{postData.BackReason}}</div> </div> </div> </div> <div class="form-group"> <div class="col-sm-offset-10 col-sm-2" style="margin-left: 45%"> <button ng-if="showClose" type="button" class="btn" ng-click="close()">关闭</button> <button ng-show="postData.Status != 3 && !isReadOnly" type="submit" class="btn btn-primary">保存</button> <button ng-if="postData.Status === 3 && !isReadOnly" type="button" class="btn btn-primary" ng-click="save(true)">保存</button> </div> </div> </div> </form>'),
a.put("views/addOrder_cus.html",'<div class="order"> <form class="form-horizontal" name="myForm" ng-submit="save()" novalidate ng-controller="AddOrderCtrl" ng-class="{readonly:isReadOnly,submited:submited}"> <p ng-if="hasBalance" class="u-balance">账户余额:<span style="color: red">{{::balance}}</span> </p> <p> <label>销售员：</label> <span ng-if="postData.OrderId" ng-bind="postData.SalerName"></span> <select ng-if="!postData.OrderId" ng-model="postData.SalesId"> <option value="{{::sale.UserId}}" ng-repeat="sale in sales" ng-bind="sale.RealName"></option> </select> <span ng-if="postData.OrderId">订单号:{{::postData.OrderId}} ,&nbsp;所属公司:{{::postData.ChannelName}},&nbsp;提单人:{{::postData.BillName}}</span> </p> <div bu-group="客户信息"> <table class="table table-bordered"> <tbody> <tr> <th colspan="4" style="text-align:left"> <span class="t_header">客户基本信息</span> </th> </tr> <tr> <td class="required">联系人</td> <td> <input type="text" ng-model="postData.Contacts" ng-if="!isReadOnly" maxlength="10" required> <span ng-bind="postData.Contacts" ng-if="isReadOnly"></span> </td> <td class="required">手机</td> <td> <input type="text" ng-model="postData.Mobile" ng-if="!isReadOnly" maxlength="11" required> <span ng-bind="postData.Mobile" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">所在城市</td> <td> <select ng-model="postData.CityCode" ng-disabled="isReadOnly" ng-change="setprice(true);" required> <option ng-repeat="city in cities" ng-selected="postData.CityCode == city.CityCode" value="{{city.CityCode}}">{{::city.CityName}}</option> </select> </td> <td class="required">公司性质</td> <td> <select ng-model="postData.AddedValue" ng-disabled="isReadOnly" required ng-change="setprice();"> <option value="1">小规模</option> <option value="2">一般纳税人</option> </select> </td> </tr> <tr> <td class="required">联系人</td> <td> <input type="text" ng-model="postData.Contacts" ng-if="!isReadOnly" maxlength="10" required> <span ng-bind="postData.Contacts" ng-if="isReadOnly"></span> </td> <td class="required">手机</td> <td> <input type="text" ng-model="postData.Mobile" ng-if="!isReadOnly" maxlength="11" required> <span ng-bind="postData.Mobile" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">法人</td> <td> <input type="text" ng-model="postData.LegalPerson" ng-if="!isReadOnly" maxlength="20" required> <span ng-bind="postData.LegalPerson" ng-if="isReadOnly"></span> </td> <td class="required">上传法人身份证照片</td> <td> <img ng-src="{{postData.BusinessLicense}}" ng-if="postData.BusinessLicense" class="order-img" alt="" pic-view> <input type="file" nv-file-select="" uploader="uploader2" ng-show="!isReadOnly"> <div class="progress" style="width:80%" ng-if="uploader2.isUploading"> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': uploader2.progress + \'%\' }" style="width: 100%"></div> </div> </td> </tr> </tbody> </table> </div> <div bu-group="合同信息"> <table class="table table-bordered"> <tbody> <tr> <td class="required">合同编号</td> <td> <input type="text" ng-model="postData.ContractNO" ng-if="!isReadOnly" required> <span ng-bind="postData.ContractNO" ng-if="isReadOnly"></span> </td> \x3c!-- <td class="required">保密手机</td>\r\n                    <td>\r\n                        <input type="text" ng-model="postData.ContractMobile" ng-readonly="isReadOnly" required/>\r\n                    </td> --\x3e <td class="required">付款方式</td> <td> <select ng-model="postData.PayType" ng-disabled="isReadOnly" required ng-change="setprice();setEndDate();"> <option value="3">季付</option> <option value="1">半年付</option> <option value="2">年付</option> <option value="4" ng-if="postData.AddedValue==1">零税(半年)</option> </select> <select ng-model="postData.gift" ng-if="showGift && !isReadOnly" ng-change="setgift();setEndDate();"> <option value="">不使用礼包</option> <option ng-repeat="item in gifts" value="{{item.Id}}" ng-disabled="{{item.Num ===0}}">{{::item.GiftTypeName}}(￥{{::item.Price}})</option> </select> <span ng-if="isReadOnly && postData.GiftStr">礼包:{{::postData.GiftStr}}</span> <br> <small style="color:red">注:零税指零报税并且零票据。</small> </td> </tr> <tr> <td class="required">签订日期</td> <td> <span class="date_sel"> <input type="text" uib-datepicker-popup ng-model="postData.ContractDate" is-open="dateIsOpened" datepicker-options="dateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpened = !dateIsOpened" ng-disabled="isReadOnly" required> <button type="button" ng-click="dateIsOpened = !dateIsOpened" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> </td> <td class="required">合同金额</td> <td style="min-width:400px;width:45%"> <input type="text" ng-model="postData.ContractAmount" ng-if="!isReadOnly" ng-readonly="true" disabled required><span ng-bind="postData.ContractAmount" ng-if="isReadOnly"></span> <br> <small style="color:red">注:合同金额根据所属城市、公司性质和付款方式自动计算，不包含礼包价格。</small> </td> </tr> <tr> <td>备注</td> <td colspan="3"> <input type="text" ng-model="postData.ContractDescription" ng-if="!isReadOnly" style="width:90%"> <span ng-bind="postData.ContractDescription" ng-if="isReadOnly"> </span></td> </tr> </tbody> </table> </div> <div bu-group="提单备注"> <div>提单特殊备注信息</div> <textarea name="" id="" cols="100" rows="3" ng-model="postData.Remark" ng-if="!isReadOnly"></textarea> <pre ng-bind="postData.Remark" ng-if="isReadOnly"></pre> </div> <div bu-group="拒审原因" ng-if="postData.Status === 3"> <span ng-bind="postData.BackReason" style="color:red"></span> </div> <div class="text-center container-fluid"> <button ng-show="!isReadOnly" type="submit" class="btn btn-primary save">保存</button> <button ng-if="postData.Status === 3 && !isReadOnly" type="button" class="btn btn-primary save" ng-click="save(true)">提交</button> <a ng-if="showClose" class="btn btn-primary" ng-click="close();">关闭</a> </div> </form> </div>'),a.put("views/addOrganize.html",'<div class="m-organize"> <div class="panel panel-primary"> <div class="panel-heading">新增机构</div> <div class="panel-body"> <form class="form-horizontal" name="addForm" ng-submit="addOragnize()"> <div class="form-group"> <label for="inputName" class="col-sm-2 control-label"><span class="text-danger">*</span>机构名称</label> <div class="col-sm-7"> <input type="text" name="name" required ng-maxlength="20" class="form-control" id="inputName" ng-model="addParams.DepartmentName"> </div> <div class="col-sm-3"> <div class="text-danger" ng-messages="addForm.name.$error" ng-if="interacted(addForm.name)"> <span ng-message="required"> 请输入用户名 </span> <span ng-message="maxlength"> 最大长度为20 </span> </div> </div> </div> <div class="form-group"> <label for="inputDesc" class="col-sm-2 control-label">机构描述</label> <div class="col-sm-7"> <textarea class="form-control" id="inputDesc" name="desc" maxlength="50" ng-model="addParams.Description"></textarea> </div> <div class="col-sm-3"> <div class="text-danger" ng-messages="addForm.desc.$error" ng-if="interacted(addForm.desc)"> <span ng-message="maxlength"> 最大长度为50 </span> </div> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-sm-10"> <button type="submit" class="btn btn-primary" ng-disabled="addForm.$invalid">新增</button> <button type="button" class="btn btn-link" ng-click="dismiss();">取消</button> </div> </div> </form> </div> </div> </div>'),a.put("views/addUser.html",'<div class="m-addUser"> <h2> 新增员工 </h2> <form class="form-horizontal" name="addForm" ng-submit="addUser()" novalidate> <div class="form-group"> <label for="inputUserName" class="col-sm-2 control-label"><span class="text-danger">*</span>用户名</label> <div class="col-sm-2"> <input type="text" class="form-control" name="userName" ng-maxlength="20" ng-model="addParams.UserName" required id="inputUserName"> </div> <div class="col-sm-2"> <div class="text-danger" ng-messages="addForm.userName.$error" ng-if="interacted(addForm.userName)"> <span ng-message="required"> 请输入用户名 </span> <span ng-message="maxlength"> 最大长度为20 </span> </div> </div> <label for="inputRealName" class="col-sm-2 control-label"><span class="text-danger">*</span>真实姓名</label> <div class="col-sm-2"> <input type="text" class="form-control" name="realName" ng-model="addParams.RealName" id="inputRealName"> </div> <div class="col-sm-2"> <div class="text-danger" ng-messages="addForm.realName.$error" ng-if="interacted(addForm.realName)"> <span ng-message="required"> 请输入真实姓名 </span> </div> </div> </div> <div class="form-group"> <label for="inputEmail" class="col-sm-2 control-label"><span class="text-danger">*</span>邮箱</label> <div class="col-sm-2"> <input type="text" class="form-control" name="email" ng-model="addParams.Email" ng-pattern="/^[^\\s@]+@[^\\s@]+\\.[^\\s@]{2,}$/" required id="inputEmail"> </div> <div class="col-sm-2"> <div class="text-danger" ng-messages="addForm.email.$error" ng-if="interacted(addForm.email)"> <span ng-message="required"> 请输入邮箱 </span> <span ng-message="pattern"> 邮箱格式错误 </span> </div> </div> <label for="inputPswd" class="col-sm-2 control-label"><span class="text-danger">*</span>密码</label> <div class="col-sm-2"> <input type="text" class="form-control" name="password" ng-model="addParams.Password" required ng-minlength="6" id="inputPswd"> </div> <div class="col-sm-2"> <div class="text-danger" ng-messages="addForm.password.$error" ng-if="interacted(addForm.password)"> <span ng-message="required"> 请输入密码 </span> <span ng-message="minlength"> 密码最小长度为6位 </span> </div> </div> </div> <div class="form-group"> <label for="inputTel" class="col-sm-2 control-label"><span class="text-danger">*</span>电话</label> <div class="col-sm-2"> <input type="text" class="form-control" name="mobile" ng-model="addParams.Mobile" ng-pattern="/(^(13\\d|14[57]|15[^4,\\D]|17[135678]|18\\d)\\d{8}|170[^346,\\D]\\d{7})$/" required id="inputTel"> </div> <div class="col-sm-2"> <div class="text-danger" ng-messages="addForm.mobile.$error" ng-if="interacted(addForm.mobile)"> <span ng-message="required"> 请输入手机号 </span> <span ng-message="pattern"> 手机格式不正确 </span> </div> </div> <label for="inputRole" class="col-sm-2 control-label"><span class="text-danger">*</span>角色</label> <div class="col-sm-2"> <select class="form-control" id="inputRole" ng-change="setAddParams(\'role\')" ng-model="selectedRole" ng-options="role.RoleName for role in rolesModel "> </select> </div> <div class="col-sm-2"> </div> </div> <div class="form-group"> <label for="inputDep" class="col-sm-2 control-label"><span class="text-danger">*</span>部门</label> <div class="col-sm-2"> <input type="text" class="form-control" ng-model="seletedParent.DepartmentName" id="inputDep" disabled> </div> <div class="col-sm-2"> </div> <label ng-if="selectedRole.RoleName === \'渠道经理\'" class="col-sm-2 control-label"><span class="text-danger">*</span>负责大区</label> <div class="col-sm-2" ng-if="selectedRole.RoleName === \'渠道经理\'"> <select class="form-control" ng-model="addParams.ChannelPartitionId"> <option ng-repeat="fq in fqs" ng-value="fq.Id" ng-bind="fq.PartitionName"></option> </select> </div> \x3c!--<label for="inputCenter" class="col-sm-2 control-label">是否中心</label>\n            <div class="col-sm-2">\n                <select class="form-control" id="inputCenter" ng-change="setAddParams(\'center\')" ng-model="selectedCenter" ng-options="center.name for center in centerModel ">\n                </select>\n            </div>\n            <div class="col-sm-2">\n\n            </div>--\x3e </div> <div class="form-group"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>选择模块</label> <div class="col-sm-10"> <div class="tree-container"> <treecontrol class="tree-light" tree-model="functionModel" options="functionTreeOptions" on-selection="setSelectedTree(node)" selected-nodes="selectedFunction"> <span ng-class="{\'selectd\': node.selectd}">{{::node.name}}</span> </treecontrol> </div> </div> </div> <div class="form-group text-center"> <button type="submit" ng-disabled="addForm.$invalid" class="btn btn-primary">新增</button> <button type="reset" class="btn btn-default">重置</button> <a class="btn btn-default" ui-sref="main.users.usersList">返回</a> </div> </form> </div>'),a.put("views/addorder_company_modal.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">快速录入工商信息</h3> </div> <div class="modal-body form-inline addorder2-modal"> <form name="applyForm"> <div class="row"> <input class="form-control" style="width:100%" type="text" ng-model="httpWord" placeholder="请输入该公司在国家企业信息公示系统的链接地址" required> </div> </form> <div class="row"> <span class="href-style">打开链接：</span> <a class="href-style" href="http://www.gsxt.gov.cn/index.html" target="view_window">http://www.gsxt.gov.cn/index.html</a> </div> </div> <div class="modal-footer"> <button class="btn" type="button" ng-click="cancel()">取消</button> <button class="btn btn-primary" type="button" ng-disabled="applyForm.$invalid" ng-click="save()">确定</button> </div>'),a.put("views/addressList.html",'<div class="m-invoice"> <h2>发票地址管理</h2> <div class="o-search well well-sm"> <button class="btn btn-primary" ng-click="open()">新增</button> </div> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th ng-repeat="head in headers" ng-bind="head"></th> <th>操作</th> </tr> </thead>  <tbody> <tr ng-repeat="row in data"> <td ng-repeat="col in row.cols  track by $index" ng-bind="col"></td> <td><a href="javascript:;" title="查看/修改" ng-click="open(row)">查看/修改</a> \x3c!-- <a href="javascript:;" title="删除" ng-click="remove(row)">删除</a> --\x3e </td> </tr> </tbody> </table> </div>'),a.put("views/agent.html",'<div class="m-agent"> <h2 class="title">代理商申请</h2> <form class="form-inline agform" ng-class="{submited:submited}" name="agForm" novalidate ng-submit="ok()" ng-init="$parent.agForm = agForm"> <div class="clearfix" style="width:80%"> <div class="form-group col-md-6"> <label for="" class="required">代理商名称</label> <input type="text" class="form-control" ng-model="item.ChannelName" required> </div> <div class="form-group col-md-6"> <label for="" class="required">城市</label> <select ng-model="item.CityCode" class="form-control" required> <option ng-repeat="city in cities" ng-selected="item.CityCode == city.Code" value="{{::city.Code}}">{{::city.Name}}</option> </select> </div> <div class="form-group col-md-6"> <label for="">负责人</label> <input type="text" class="form-control" ng-model="item.Principal"> </div> <div class="form-group col-md-6"> <label for="">手机</label> <input type="text" class="form-control" ng-model="item.Mobile"> </div> <div class="form-group col-md-6"> <label for="">固定电话</label> <input type="text" class="form-control" ng-model="item.Tel"> </div> <div class="form-group col-md-6"> <label for="">传真</label> <input type="text" class="form-control" ng-model="item.Fax"> </div> <div class="form-group col-md-6"> <label for="">地址</label> <input type="text" class="form-control" ng-model="item.Address"> </div> <div class="form-group col-md-6"> <label for="">邮政编码</label> <input type="text" class="form-control" ng-model="item.Postcode"> </div> <div class="form-group col-md-6"> <label for="">法人</label> <input type="text" class="form-control" ng-model="item.LegalPerson"> </div> <div class="form-group col-md-6"> <label for="">开户行</label> <input type="text" class="form-control" ng-model="item.DepositBank"> </div> <div class="form-group col-md-6"> <label for="">开户行支行</label> <input type="text" class="form-control" ng-model="item.BranchBank"> </div> <div class="form-group col-md-6"> <label for="">开户名</label> <input type="text" class="form-control" ng-model="item.AccountName"> </div> <div class="form-group col-md-6"> <label for="">银行账号</label> <input type="text" class="form-control" ng-model="item.BankAccount"> </div> <div class="form-group col-md-6" ng-if="(!item.ChannelId) && isCenter"> <label for="" class="required">总经理用户名</label> <input type="text" class="form-control" name="userName" ng-pattern="/^[@a-zA-Z0-9_\\u4e00-\\u9fa5]+$/" ng-model="item.UserName" required> <span class="text-danger" ng-messages="agForm.userName.$error"> <i ng-message="pattern"> 请输入汉字数字字母或者下划线的任意组合 </i> </span> </div> <div class="form-group col-md-6" ng-if="(!item.ChannelId) && isCenter"> <label for="" class="required">总经理密码</label> <input type="text" class="form-control" ng-model="item.PassWrod" required> </div> </div> <hr class="col-md-12"> <div class="clearfix" style="width:80%"> <div class="col-sm-6 col-md-4"> <div class="thumbnail"> <div class="caption"> <h4 class="text-center"><span class="upload_btn pull-right"><a href="javascript:;" class="btn btn-primary btn-sm" role="button">上传</a><input style="font-size:12px" type="file" nv-file-select="" uploader="uploader1"></span><span style="font-weight:700">上传身份证 </span> </h4> <div class="progress" style=""> <div class="progress-bar progress-bar-striped" role="progressbar" ng-style="{ \'width\': uploader1.progress + \'%\' }" style="width: 100%"></div> </div> </div> <a href="{{item.IdCard}}" target="_blank" ng-if="item.IdCard"> <img class="order-img thumbnail" ng-src="{{item.IdCard}}" alt="" style="width:240px; height:190px"></a>  <div class="thumbnail noImg" ng-if="!item.IdCard"></div> </div> </div> <div class="col-sm-6 col-md-4"> <div class="thumbnail"> <div class="caption"> <h4 class="text-center"><span class="upload_btn pull-right"><a href="javascript:;" class="btn btn-primary btn-sm" role="button">上传</a><input style="font-size:12px" type="file" nv-file-select="" uploader="uploader2"></span><span style="font-weight:700">代帐资质 </span> </h4> <div class="progress" style=""> <div class="progress-bar progress-bar-striped" role="progressbar" ng-style="{ \'width\': uploader2.progress + \'%\' }" style="width: 100%"></div> </div> </div> <a href="{{item.Aptitude}}" target="_blank" ng-if="item.Aptitude"> <img class="order-img thumbnail" ng-src="{{item.Aptitude}}" alt="" style="width:240px; height:190px"></a>  <div class="thumbnail noImg" ng-if="!item.Aptitude"></div> </div> </div> <div class="col-sm-6 col-md-4"> <div class="thumbnail"> <div class="caption"> <h4 class="text-center"><span class="upload_btn pull-right"><a href="javascript:;" class="btn btn-primary btn-sm" role="button">上传</a><input style="font-size:12px" type="file" nv-file-select="" uploader="uploader3"></span><span style="font-weight:700">营业执照(三证合一) </span> </h4> <div class="progress" style=""> <div class="progress-bar progress-bar-striped" role="progressbar" ng-style="{ \'width\': uploader3.progress + \'%\' }" style="width: 100%"></div> </div> </div> <a href="{{item.Documents}}" target="_blank" ng-if="item.Documents"> <img class="order-img thumbnail" ng-src="{{item.Documents}}" alt="" style="width:240px; height:190px"></a>  <div class="thumbnail noImg" ng-if="!item.Documents"></div> </div> </div> <div class="col-sm-6 col-md-4"> <div class="thumbnail"> <div class="caption"> <h4 class="text-center"><span class="upload_btn pull-right"><a href="javascript:;" class="btn btn-primary btn-sm" role="button">上传</a><input style="font-size:12px" type="file" nv-file-select="" uploader="uploader4"></span><span style="font-weight:700">税务登记证 </span> </h4> <div class="progress" style=""> <div class="progress-bar progress-bar-striped" role="progressbar" ng-style="{ \'width\': uploader4.progress + \'%\' }" style="width: 100%"></div> </div> </div> <a href="{{item.Documents2}}" target="_blank" ng-if="item.Documents2"> <img class="order-img thumbnail" ng-src="{{item.Documents2}}" alt="" style="width:240px; height:190px"></a>  <div class="thumbnail noImg" ng-if="!item.Documents2"></div> </div> </div> <div class="col-sm-6 col-md-4"> <div class="thumbnail"> <div class="caption"> <h4 class="text-center"><span class="upload_btn pull-right"><a href="javascript:;" class="btn btn-primary btn-sm" role="button">上传</a><input style="font-size:12px" type="file" nv-file-select="" uploader="uploader5"></span><span style="font-weight:700">组织机构代码证 </span> </h4> <div class="progress" style=""> <div class="progress-bar progress-bar-striped" role="progressbar" ng-style="{ \'width\': uploader5.progress + \'%\' }" style="width: 100%"></div> </div> </div> <a href="{{item.Documents3}}" target="_blank" ng-if="item.Documents3"> <img class="order-img thumbnail" ng-src="{{item.Documents3}}" alt="" style="width:240px; height:190px"></a>  <div class="thumbnail noImg" ng-if="!item.Documents3"></div> </div> </div> </div> <div class="form-group col-md-12 text-center" ng-if="!isModal"> <button class="btn btn-primary" type="submit">添加</button> <button class="btn btn-default" type="reset">重置</button> </div> </form> </div>'),a.put("views/agentList.html",'<div class="recharge"> <h2 class="clearfix"> 下级代理商管理 </h2> <div class="well well-sm u-search form-inline"> <div class="form-group"> <label>代理商</label>： <input type="text" ng-model="channelname" class="form-control" tabindex="1"> </div> <div class="form-group"> <label>状态</label>： <select ng-model="status" class="form-control"> <option ng-value="0" ng-selected="+status==0">全部</option> <option ng-value="1">正常</option> <option ng-value="2">未审核</option> <option ng-value="3">拒审</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="pageChanged()" tabindex="2">查询</button> <button class="btn btn-primary" ng-click="addAgent()" tabindex="3">申请下级代理商</button> </div> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th>省</th> <th>市</th> <th>一级代理</th> <th>二级代理</th> <th>状态</th> <th>入驻日期</th> <th>余额</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="row in data"> <td ng-repeat="col in row.cols  track by $index" ng-class="{\'text-right\': rightAlign && rightAlign.indexOf($index)>-1}" ng-bind-html="col"></td> <td>{{row.ProvinceName}}</td> <td>{{row.CityName}}</td> <td>{{row.ChannelName1}}</td> <td>{{row.ChannelName2}}</td> <td>{{row.StatusText}}</td> <td>{{row.CreateDate}}</td> <td>{{row.Balance}}</td> <td> <div class="operate"> <a href="javascript:;" ng-click="modify(row)">修改</a> <a href="javascript:;" ng-if="row.Status != 1" ng-click="remove(row.ChannelId)">删除</a> </div> </td> </tr> </tbody> </table> <div class="u-paginator form-inline"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div>'),a.put("views/agentModal.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">{{title}}</h3> </div> <div class="modal-body clearfix"> <div ng-class="{padding:!isModal}"> <form class="form-inline agform" ng-class="{submited:submited}" name="agForm" novalidate ng-submit="ok()" ng-init="$parent.agForm = agForm"> <div class="clearfix"> <div class="form-group col-md-6"> <label for="" class="required">代理商名称</label> <input type="text" class="form-control" ng-model="item.ChannelName" required> </div> <div class="form-group col-md-6"> <label for="" class="required">城市</label> <select ng-model="item.CityCode" class="form-control" required> <option ng-repeat="city in cities" ng-selected="item.CityCode == city.Code" value="{{::city.Code}}">{{::city.Name}}</option> </select> </div> <div class="form-group col-md-6"> <label for="" class="required">负责人</label> <input type="text" class="form-control" ng-model="item.Principal" required> </div> <div class="form-group col-md-6"> <label for="" class="required">手机</label> <input type="text" class="form-control" ng-model="item.Mobile" required> </div> <div class="form-group col-md-6"> <label for="" class="required">邮箱</label> <input type="text" class="form-control" ng-model="item.Email" required> </div> <div class="form-group col-md-6"> <label for="" class="required">地址</label> <input type="text" class="form-control" ng-model="item.Address" required> </div> <div class="form-group col-md-6"> <label for="">法人</label> <input type="text" class="form-control" ng-model="item.LegalPerson"> </div> <div class="form-group col-md-6"> <label for="">开户行</label> <input type="text" class="form-control" ng-model="item.DepositBank"> </div> <div class="form-group col-md-6"> <label for="">开户行支行</label> <input type="text" class="form-control" ng-model="item.BranchBank"> </div> <div class="form-group col-md-6"> <label for="">开户名</label> <input type="text" class="form-control" ng-model="item.AccountName"> </div> <div class="form-group col-md-6"> <label for="">银行账号</label> <input type="text" class="form-control" ng-model="item.BankAccount"> </div> </div> <hr class="col-md-12"> <div class="clearfix"> <div class="col-sm-6 col-md-4"> <div class="thumbnail"> <div class="caption"> <h4 class="text-center"><span class="upload_btn pull-right"><a href="javascript:;" class="btn btn-primary btn-sm" role="button">上传</a><input style="font-size:12px" type="file" nv-file-select="" uploader="uploader1"></span><span style="font-weight:700">上传身份证 </span> </h4> <div class="progress" style=""> <div class="progress-bar progress-bar-striped" role="progressbar" ng-style="{ \'width\': uploader1.progress + \'%\' }" style="width: 100%"></div> </div> </div> <img class="order-img thumbnail" ng-if="item.IdCard" ng-src="{{item.IdCard}}" alt="" style="width:240px; height:190px" pic-view> <div class="thumbnail noImg" ng-if="!item.IdCard"></div> </div> </div> <div class="col-sm-6 col-md-4"> <div class="thumbnail"> <div class="caption"> <h4 class="text-center"><span class="upload_btn pull-right"><a href="javascript:;" class="btn btn-primary btn-sm" role="button">上传</a><input style="font-size:12px" type="file" nv-file-select="" uploader="uploader2"></span><span style="font-weight:700">代帐资质 </span> </h4> <div class="progress" style=""> <div class="progress-bar progress-bar-striped" role="progressbar" ng-style="{ \'width\': uploader2.progress + \'%\' }" style="width: 100%"></div> </div> </div> <img class="order-img thumbnail" ng-if="item.Aptitude" ng-src="{{item.Aptitude}}" alt="" style="width:240px; height:190px" pic-view> <div class="thumbnail noImg" ng-if="!item.Aptitude"></div> </div> </div> <div class="col-sm-6 col-md-4"> <div class="thumbnail"> <div class="caption"> <h4 class="text-center"><span class="upload_btn pull-right"><a href="javascript:;" class="btn btn-primary btn-sm" role="button">上传</a><input style="font-size:12px" type="file" nv-file-select="" uploader="uploader3"></span><span style="font-weight:700">营业执照(三证合一) </span> </h4> <div class="progress" style=""> <div class="progress-bar progress-bar-striped" role="progressbar" ng-style="{ \'width\': uploader3.progress + \'%\' }" style="width: 100%"></div> </div> </div> <img class="order-img thumbnail" ng-src="{{item.Documents}}" ng-if="item.Documents" alt="" style="width:240px; height:190px" pic-view> <div class="thumbnail noImg" ng-if="!item.Documents"></div> </div> </div> </div> <div ng-if="item.Status == 3" class="form-group col-md-12"> <label style="width: auto">驳回原因</label> <span style="color: red">{{item.BackReason}}</span> </div> <div class="form-group col-md-12 text-center" ng-if="!isModal"> <button class="btn btn-primary" type="submit">添加</button> <button class="btn btn-default" type="reset">重置</button> </div> </form> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),
a.put("views/balance.html",'<div class="m-balance"> <div class="balance-content"> <h2> 代理商余额(会员)管理 </h2> <div class="panel panel-default"> \x3c!-- <div class="panel-heading">\n                用户账号：<span>1045442564@qq.com</span> (<span>绍兴临沂黄页</span>)\n            </div> --\x3e <div class="panel-body"> <div class="u-account"> <h4> 账户余额 </h4> <div class="account-detail"> <p> 可用余额：<strong class="text-warning">{{::balance}}元</strong> </p> <p> 冻结余额：<span>0.00元</span> </p> </div> </div> </div> </div> <div class="panel panel-default"> <div class="panel-heading">收支明细</div> <div class="panel-body"> <div class="well well-sm u-search"> <div class="clearfix search-item"> <span class="navbar-text navbar-left"> 交易类型： </span> <ul class="nav nav-pills"> <li role="presentation" ng-class="{active:curType ===0}"><a href="javascript: void(0)" ng-click="showDetail(0)">全部</a></li> <li role="presentation" ng-class="{active:curType ===1}"><a href="javascript: void(0)" ng-click="showDetail(1)">支付明细</a></li> <li role="presentation" ng-class="{active:curType ===2}"><a href="javascript: void(0)" ng-click="showDetail(2)">充值明细</a></li> </ul> </div> <div class="clearfix search-item"> <span class="navbar-text navbar-left"> 起至日期： </span> <form class="form-inline"> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" ng-model="searchParams.startTime" uib-datepicker-popup="yyyy/MM/dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.startFlag" ng-click="showDatepicker(\'start\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'start\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" ng-model="searchParams.endTime" uib-datepicker-popup="yyyy/MM/dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.endFlag" ng-click="showDatepicker(\'end\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'end\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> </form> </div> </div> <div class="table-container"> <table class="table table-striped table-hover"> <thead> <tr class="info"> <th>序号</th> \x3c!-- <th ng-repeat="head in headers" ng-bind="head"></th> --\x3e <th>账单编号</th> <th ng-show="curType == 1">支出</th> <th ng-show="curType != 1">充值金额</th> <th>余额</th> <th>类型</th> <th>备注</th> <th>操作时间</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="row in data"> <td ng-bind="$index+1"></td> <td>{{row.BillId}}</td> <td>{{row.Amount}}</td> <td>{{row.Balance}}</td> <td>{{row.CategoryStr}}</td> <td>{{row.Description}}</td> <td style="width:150px">{{row.BillTime}}</td> \x3c!-- <td ng-repeat="col in row.cols  track by $index" ng-class="{\'text-right\': rightAlign && rightAlign.indexOf($index)>-1}" ng-bind-html="col"></td> --\x3e <td style="width:90px"> \x3c!-- Category == 1支付 2充值 --\x3e <a href="#/main/addOrder2/{{::row.OrderId}}/1" ng-show="row.Category == 1 && row.OrderCategory != 2 && row.Status">查看订单</a> <a href="#/main/addOrder2/{{::row.OrderId}}/1" ng-show="row.Category == 1 && row.OrderCategory == 2 && row.Status">查看订单</a> <a ng-click="msgAlert()" ng-show="row.Category == 1 && !row.Status">查看订单</a> <a ng-show="row.Category != 1"></a> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div> </div> </div> </div>'),a.put("views/buGroup.html",'<div class="buGroup"> <div class="header"> <span class="title" ng-bind="title"></span> <span class="toggle" ng-click="toggle()"> <i class="glyphicon" ng-class="{\'glyphicon-minus\':!isHide,\'glyphicon-plus\':isHide}"></i> {{toggleMsg}} </span> </div> <div class="body" ng-transclude ng-show="!isHide"></div> </div>'),a.put("views/change.html",'<div class="order"> <form class="form-horizontal" name="myForm" ng-submit="save()" novalidate ng-class="{readonly:isReadOnly,submited:submited}"> <p ng-if="hasBalance" class="u-balance">账户余额:<span style="color: red">{{::balance}}</span> </p> <p> <label>销售员：</label> <span ng-if="postData.OrderId" ng-bind="postData.SalerName"></span> <select ng-if="!postData.OrderId" ng-model="postData.SalesId"> <option value="{{::sale.UserId}}" ng-repeat="sale in sales" ng-bind="sale.RealName"></option> </select> <span ng-if="postData.OrderId">订单号:{{::postData.OrderId}} ,&nbsp;所属公司:{{::postData.ChannelName}},&nbsp;提单人:{{::postData.BillName}}</span> </p> <div bu-group="客户信息"> <table class="table table-bordered"> <tbody> <tr> <th colspan="4" style="text-align:left"> <span class="t_header">客户基本信息</span> </th> </tr> <tr> <td class="required">公司名称</td> <td> <input type="text" typeahead-min-length="3" ng-if="!isReadOnly" ng-model="postData.Name" uib-typeahead="item.Name for item in getCompanyName($viewValue)" typeahead-loading="loadingLocations" required typeahead-on-select="companySelect($item, $model, $label, $event)"><i ng-show="loadingLocations" class="glyphicon glyphicon-refresh"></i> <span ng-bind="postData.Name" ng-if="isReadOnly"></span> </td> <td class="required">所在城市</td> <td> <select ng-model="postData.CityCode" ng-disabled="isReadOnly" ng-change="setprice(true);" required> <option ng-repeat="city in cities" ng-selected="postData.CityCode == city.CityCode" value="{{city.CityCode}}">{{::city.CityName}}</option> </select> </td> </tr> <tr> <td class="required">公司地址</td> <td> <input type="text" ng-model="postData.Address" ng-if="!isReadOnly" maxlength="100" required> <span ng-bind="postData.Address" ng-if="isReadOnly"></span> </td> <td class="required">所属行业</td> <td> <select ng-model="postData.Industry" ng-disabled="isReadOnly" required> <option ng-repeat="item in industries" value="{{item.IndustryId}}" ng-bind="item.IndustryName"></option> </select> </td> </tr> <tr> <td class="required">公司性质</td> <td> <select ng-model="postData.AddedValue" ng-disabled="isReadOnly" required ng-change="setprice();"> <option value="1">小规模</option> <option value="2">一般纳税人</option> </select> </td> <td class="required">联系人</td> <td> <input type="text" ng-model="postData.Contacts" ng-if="!isReadOnly" maxlength="10" required> <span ng-bind="postData.Contacts" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">手机</td> <td> <input type="text" ng-model="postData.Mobile" ng-if="!isReadOnly" maxlength="11" required> <span ng-bind="postData.Mobile" ng-if="isReadOnly"></span> </td> <td></td> <td></td> </tr> </tbody> </table> <table class="table table-bordered"> <thead> <th colspan="4" style="text-align:left"> <span class="t_header">营业执照信息</span> </th> </thead> <tbody> <tr> <td class="required">注册号</td> <td> <input type="text" ng-model="postData.RegNO" ng-if="!isReadOnly" maxlength="20" required> <span ng-bind="postData.RegNO" ng-if="isReadOnly"></span> </td> <td class="required">法人</td> <td> <input type="text" ng-model="postData.LegalPerson" ng-if="!isReadOnly" maxlength="10" required> <span ng-bind="postData.LegalPerson" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">国税登记号</td> <td> <input type="text" ng-model="postData.NationalTaxNO" ng-if="!isReadOnly" maxlength="20" required> <span ng-bind="postData.NationalTaxNO" ng-if="isReadOnly"></span> </td> <td class="required">地税登记号</td> <td> <input type="text" ng-model="postData.LocalTaxNO" ng-if="!isReadOnly" maxlength="20" required> <span ng-bind="postData.LocalTaxNO" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">营业期限</td> <td> <span class="date_sel"> <input type="text" uib-datepicker-popup ng-model="postData.RegisterDate" is-open="dateIsOpened11" datepicker-options="dateOptions" close-text="关闭" current-text="今天" clear-text="清空" ng-click="dateIsOpened11 = !dateIsOpened11" ng-disabled="isReadOnly" required> <button type="button" ng-click="dateIsOpened11 = !dateIsOpened11" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span>- <span class="date_sel" ng-hide="isReadOnly && (postData.NoDeadLine == 1)"> <input type="text" uib-datepicker-popup ng-model="postData.BusnissDeadline" is-open="dateIsOpened1" datepicker-options="dateOptions" close-text="关闭" current-text="今天" clear-text="清空" ng-click="dateIsOpened1 = !dateIsOpened1" ng-disabled="isReadOnly || postData.NoDeadLine"> <button type="button" ng-click="dateIsOpened1 = !dateIsOpened1" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> <label ng-hide="isReadOnly && (postData.NoDeadLine == 0)"> <input ng-hide="isReadOnly && (postData.NoDeadLine == 1)" type="checkbox" name="noLimitDate" ng-readonly="isReadOnly" value="1" ng-click="postData.NoDeadLine = !postData.NoDeadLine; " ng-checked="postData.NoDeadLine == 1"> 无期限 </label> </td> <td class="required">注册资金</td> <td> <input type="text" ng-model="postData.RegisteredCapital" ng-if="!isReadOnly" maxlength="15" required> <span ng-bind="postData.RegisteredCapital" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">经营范围</td> <td> <textarea ng-model="postData.BusinessScope" ng-if="!isReadOnly" style="width:80%" rows="5" required></textarea> <pre class="order_pre" ng-bind="postData.BusinessScope" ng-if="isReadOnly"></pre> </td> <td class="required">上传营业执照</td> <td> <img ng-src="{{postData.BusinessLicense}}" ng-if="postData.BusinessLicense" class="order-img" alt="" pic-view> </td> </tr> </tbody> </table> </div> <div bu-group="合同信息"> <table class="table table-bordered"> <tbody> <tr> <td class="required">合同编号</td> <td> <input type="text" ng-model="postData.ContractNO" ng-if="!isReadOnly" required> <span ng-bind="postData.ContractNO" ng-if="isReadOnly"></span> </td> <td class="required">付款方式</td> <td> <span>产品变更</span> </td> </tr> <tr> <td class="required">签订日期</td> <td> <span class="date_sel"> <input type="text" uib-datepicker-popup ng-model="postData.ContractDate" is-open="dateIsOpened" datepicker-options="dateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpened = !dateIsOpened" ng-disabled="isReadOnly" required> <button type="button" ng-click="dateIsOpened = !dateIsOpened" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> </td> <td class="required">开始账期</td> <td> <span class="date_sel"> <input type="text" uib-datepicker-popup="yyyy-MM" ng-model="postData.ServiceStart" is-open="dateIsOpened3" datepicker-options="dateOptions2" ng-required="true" ng-disabled="readonly" close-text="关闭" current-text="今天" clear-text="清空" ng-click="dateIsOpened3 = !dateIsOpened3" ng-change="setprice()" required> <button type="button" ng-disabled="readonly" ng-click="dateIsOpened3 = !dateIsOpened3"><i class="glyphicon glyphicon-calendar"></i></button> </span> <small style="color:red">注:以实际账期为准。</small> </td> </tr> <tr> <td class="required">结束账期</td> <td> <span class="date_sel"> <input type="text" ng-model="postData.ServiceEnd" disabled> <button type="button" ng-click="dateIsOpened4 = !dateIsOpened4" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> <small style="color:red">注:以实际账期为准。</small> </td> <td class="required">合同金额</td> <td style="min-width:400px;width:45%"> <input type="text" ng-model="postData.ContractAmount" ng-if="!isReadOnly" ng-readonly="true" disabled required><span ng-bind="postData.ContractAmount" ng-if="isReadOnly"></span> <br> <small style="color:red">注:合同金额根据所属城市、公司性质和付款方式自动计算，不包含礼包价格。</small> </td> </tr> <tr> <td>备注</td> <td colspan="3"> <input type="text" ng-model="postData.ContractDescription" ng-if="!isReadOnly" style="width:90%"> <span ng-bind="postData.ContractDescription" ng-if="isReadOnly"> </span></td> </tr> </tbody> </table> </div> <div bu-group="提单备注"> <div>提单特殊备注信息</div> <textarea name="" id="" cols="100" rows="3" ng-model="postData.Remark" ng-if="!isReadOnly"></textarea> <pre ng-bind="postData.Remark" ng-if="isReadOnly"></pre> </div> <div bu-group="拒审原因" ng-if="postData.Status === 3"> <span ng-bind="postData.BackReason" style="color:red"></span> </div> <div class="text-center container-fluid"> <button ng-if="!readonly" type="submit" class="btn btn-primary save">变更</button> <a ng-if="showClose" class="btn btn-primary" ng-click="close();">关闭</a> </div> </form> </div>'),a.put("views/change2.html",'<form class="form-horizontal add-order-container"> <div> <div> <p class="form-control-static">账户余额：<span class="amount-balance">￥{{balance}}</span></p> </div> <div> <p class="form-control-static">销售：{{postData.SalerName}} 订单号：{{postData.OrderId}} 所属公司：{{postData.ChannelName}} 提单员：{{postData.BillName}}</p> </div> <div class="gray-line"></div> \x3c!-- 标题 --\x3e \x3c!-- 新增 --\x3e <div class="add-order-title"> <span>基本信息</span> </div> <div class="custom-tips"> \x3c!-- <i class="fa fa-exclamation-circle" aria-hidden="true"></i> --\x3e <span>【温馨提示】可通过“检索”或“快速录入”按钮，帮您完成工商信息的快速录入。</span> </div> <div class="row mt-20"> <div class="col-md-6"> <label class="col-md-3 control-label"><span class="required"></span>公司名称：</label> <div class="col-md-8"> <div class="input-group" style="width:100%"> <span style="display: inline-block;height: 32px;line-height: 32px">{{postData.Name}}</span> \x3c!-- <input type="text" class="form-control" ng-model="postData.Name" disabled required> --\x3e </div> </div> <div class="clearfix mb-20"></div> <label class="col-md-3 control-label"><span class="required"></span>联系人：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.Contacts" maxlength="10" disabled required> </div> </div> <div class="col-md-6"> <ul class="business-license-right"> <li> <label class="col-md-4 control-label"><span class="required"></span>所在城市：</label> <div class="col-md-8"> <select class="form-control" ng-model="postData.CityCode" disabled> <option ng-repeat="city in cities" ng-selected="postData.CityCode == city.CityCode" value="{{city.CityCode}}">{{::city.CityName}}</option> </select> </div> </li> <li> <label class="col-md-4 control-label"><span class="required"></span>手机号：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.Mobile" maxlength="11" disabled required> </div> </li> </ul> </div> </div> <div class="add-order-title"> <span>工商信息</span> </div> <div class="row"> <div class="col-md-6"> <custom-file-uploader class="ml-20" ng-model="postData.PersonCardPath" title="请上传清晰的身份证人像面，图片大小不要超过3M" ng-disabled="true"></custom-file-uploader> <custom-file-uploader ng-model="postData.BusinessLicense" class="mt-40 ml-20" title="请上传清晰的营业执照，图片大小不要超过3M" ng-disabled="true"></custom-file-uploader> </div> <div class="col-md-6"> <ul class="business-license-right"> <li> <label class="col-md-4 control-label"><span class="required"></span>法人姓名：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.LegalPerson" maxlength="20" disabled required> </div> </li> <li> <label class="col-md-4 control-label"><span class="required"></span>法人身份证号：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.PersonCardID" maxlength="18" disabled required> </div> </li> <li> <label class="col-md-4 control-label"><span class="required"></span>公司住所：</label> <div class="col-md-8"> <textarea type="text" class="form-control" ng-model="postData.Address" maxlength="100" disabled required></textarea> </div> </li> <li> <label class="col-md-4 control-label"><span class="required"></span>统一信用代码：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.RegNO" maxlength="18" disabled required> </div> </li> <li> <label class="col-md-4 control-label"><span class="required"></span>营业期限：</label> <div class="col-md-8"> <div class="input-group" style="width:120%"> <input type="text" class="date-input" uib-datepicker-popup ng-model="postData.RegisterDate" is-open="startDateIsOpened" datepicker-options="startDateOptions" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="startDateIsOpened = !startDateIsOpened" ng-change="setMinDate()" disabled required> <span class="input-group-date">-</span> <input ng-hide="postData.NoDeadLine" type="text" class="date-input" uib-datepicker-popup ng-model="postData.BusnissDeadline" is-open="endDateIsOpened" datepicker-options="endDateOptions" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-disabled="!postData.NoDeadLine" ng-click="endDateIsOpened = !endDateIsOpened" ng-change="setMinDate()"> <label class="date-deadline" ng-hide="!postData.NoDeadLine"> <input ng-hide="isReadOnly && postData.NoDeadLine" type="checkbox" name="noLimitDate" disabled value="1" ng-click="postData.NoDeadLine = !postData.NoDeadLine; " ng-checked="postData.NoDeadLine == 1"> 无期限 </label> </div> </div> </li> <li> <label class="col-md-4 control-label"><span class="required"></span>注册资金：</label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.RegisteredCapital" disabled required> </div> </li> <li> <label class="col-md-4 control-label"><span class="required"></span>经营范围：</label> <div class="col-md-8"> <textarea type="text" class="form-control" rows="9" ng-model="postData.BusinessScope" disabled required></textarea> </div> </li> </ul> </div> </div> <div class="add-order-title"> <span>合同信息</span> </div> <div class="form-group"> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>合同编号： </label> <div class="col-md-8"> <input type="text" class="form-control" ng-model="postData.ContractNO" disabled required> </div> </div> <div class="col-md-6"> <label class="col-md-4 control-label" for=""> <span class="required"></span>纳税人类别： </label> <div class="col-md-8"> <label class="radio-inline"> <input type="radio" name="inlineRadioOptions" id="inlineRadio1" ng-model="postData.AddedValue" disabled value="1"> 小规模 </label> <label class="radio-inline"> <input type="radio" name="inlineRadioOptions" id="inlineRadio2" ng-model="postData.AddedValue" disabled value="2"> 一般纳税人 </label> </div> </div> </div> <div class="form-group"> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>套餐类型： </label> <div class="col-md-8" style="height:34px;line-height:34px"> <span>产品变更</span> </div> </div> </div> \x3c!-- <div ng-if="postData.GiftTypeName || promotion.PromotionName" class="form-group">\r\n      <div class="col-sm-2"></div>\r\n      <div class="col-sm-10">\r\n        <span ng-if="postData.GiftTypeName">{{postData.GiftTypeName + \'(￥\' + postData.GiftPrice + \')\'}}</span>\r\n        <div class="promition-style">\r\n          <span>{{promotion.PromotionName}}</span>\r\n        </div>\r\n      </div>\r\n    </div> --\x3e <div class="form-group"> <div class="col-md-6"> <label class="col-md-3 control-label" for=""> <span class="required"></span>开始账期： </label> <div class="col-md-8"> <input type="text" class="date-input" uib-datepicker-popup="yyyy-MM" ng-model="postData.ServiceStart" is-open="serviceStartIsOpened" datepicker-options="serviceStartOptions" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="serviceStartIsOpened = !serviceStartIsOpened" ng-change="setprice()" required ng-disabled="readonly"> </div> </div> <div class="col-md-6"> <label class="col-md-4 control-label" for=""> <span class="required"></span>结束账期： </label> <div class="col-md-8"> <input type="text" class="date-input" ng-model="postData.ServiceEnd" disabled> </div> </div> </div> <div class="form-group"> <div class="col-md-6"> <label for="" class="col-md-3 control-label"> <span class="required"></span>合同金额： </label> <div class="col-md-8"> <input type="number" class="form-control" ng-model="postData.ContractAmount" disabled> </div> </div> <div class="col-md-offset-1 col-sm-10 clearfix mt-5" style="padding-left:42px"> <p class="red">合同金额根据所属城市、纳税人类别、套餐类型自动计算，不包含礼包价格</p> </div> </div> <div class="form-group"> <div class="col-md-6"> <label for="" class="col-md-3 control-label"> <span></span>合同照片： </label> <div class="col-md-8"> <div class="upload-file-btn pull-left mr-20"> <span>上传文件</span> \x3c!-- <input type="file" nv-file-select="" title="上传文件" multiple style="position: absolute;top: 0;left: 0;bottom: 0;right: 0;opacity: 0;width: 130px;margin-left:20px" ng-disabled="isReadOnly">\r\n          </div> --\x3e </div> </div> <div class="col-md-10 clearfix mt-5" style="padding-left:130px"> <p>请上传清晰的合同照片，图片大小不要超过1M</p> </div> </div> <div class="form-group"> <div class="col-md-12"> <div class="col-md-1"></div> <div class="col-md-8 img-container clearfix" style="padding-left:50px"> <img ng-repeat="img in imgs" ng-src="{{img}}" additional="?x-oss-process=image/resize,m_lfit,h_75,w_100" alt="" pic-view> </div> </div> </div> <div class="form-group"> <div class="col-md-9"> <label for="" class="col-md-2 control-label"> <span></span>备注： </label> <div class="col-md-10" style="padding-left:10px"> <textarea class="form-control" id="" rows="4" ng-model="postData.Remark" disabled></textarea> </div> </div> </div> <div ng-if="postData.Status === 3"> <div class="add-order-title"> <span>拒审原因</span> </div> <div class="form-group" ng-if="postData.Status === 3"> <div class="col-md-9"> <label for="" class="col-md-2 control-label"> <span></span>驳回原因： </label> <div class="col-md-10" style="margin-top: 8px;color:red">{{postData.BackReason}}</div> </div> </div> </div> <div class="form-group"> <div class="col-sm-offset-10 col-sm-2 text-right"> <button ng-if="showClose" type="button" class="btn" ng-click="close()">关闭</button> <button ng-if="!readonly" type="submit" class="btn btn-primary" ng-click="save()">变更</button> </div> </div> </div> </div></form>'),a.put("views/cmForm.html",'<form class="form-horizontal" name="agform" ng-submit="save()" novalidate ng-class="{readonly:isReadOnly,submited:submited}"> <div class="container-fluid"> <div class="form-group col-md-6" ng-repeat="setting in settings"> <label ng-class="{required:setting.required}">{{::setting.header}}</label> <input type="text" class="form-control" ng-model="item[setting.col]" ng-if="setting.type==\'text\'" ng-required="setting.required"> <select class="form-control" ng-model="item[setting.col]" ng-if="setting.type==\'select\'" ng-required="setting.required"> <option ng-repeat="option in setting.options" ng-value="option.value" ng-selected="option.value == item[setting.col]" ng-bind="option.label"></option> </select> <span ng-if="setting.type==\'date\'"> <p class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="item[setting.col]" ng-model-options="dateOptions" is-open="dateIsOpened" datepicker-options="dateOptions" ng-required="setting.required" close-text="关闭" current-text="今天" clear-text="清空"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpened = !dateIsOpened"><i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </span> <select class="form-control" ng-required="setting.required" ng-model="item[setting.realCol]" has-default="true" ac-model="item" ac-select="setting" ng-if="setting.type==\'acSelect\'"></select> </div> <div class="col-md-12 text-center"> <button class="btn btn-primary" ng-click="save()">保存</button> </div> </div> </form>'),a.put("views/cmFormModal.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">{{::title}}</h3> </div> <div class="modal-body"> <form class="form-inline agform-sm" name="agform" ng-submit="save()" novalidate ng-class="{readonly:isReadOnly,submited:submited}"> <div class="container-fluid"> <div class="form-group col-md-6" ng-repeat="setting in settings"> <label ng-class="{required:setting.required}">{{::setting.header}}</label> <input type="text" class="form-control" ng-model="item[setting.col]" ng-if="setting.type==\'text\'" ng-required="setting.required"> <select class="form-control" ng-model="item[setting.col]" ng-if="setting.type==\'select\'" ng-required="setting.required"> <option ng-repeat="option in setting.options" ng-value="option.value" ng-selected="option.value == item[setting.col]" ng-bind="option.label"></option> </select> <span ng-if="setting.type==\'date\'"> <p class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="item[setting.col]" ng-model-options="dateOptions" is-open="dateIsOpened" datepicker-options="dateOptions" ng-required="setting.required" close-text="关闭" current-text="今天" clear-text="清空"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpened = !dateIsOpened"><i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </span> <select class="form-control" ng-required="setting.required" ng-model="item[setting.realCol]" has-default="true" ac-model="item" ac-select="setting" ng-if="setting.type==\'acSelect\'"></select> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-disabled="agform.$invalid" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/companyEdit.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">公司信息修改</h3> </div> <div class="modal-body"> <table class="table table-bordered"> <tbody> <tr> <th colspan="4" style="text-align:left"> <span class="t_header">客户基本信息</span> </th> </tr> <tr> <td class="">公司名称</td> <td> <input type="text" ng-model="postData.Name"> </td> <td class="">所在城市</td> <td> <select ng-model="postData.CityCode"> <option ng-repeat="city in cities" ng-selected="postData.CityCode == city.CityCode" value="{{city.CityCode}}">{{::city.CityName}}</option> </select> </td> </tr> <tr> <td>区域</td> <td> <select ng-model="postData.AreaCode" ng-disabled="isReadOnly"> <option ng-repeat="item in areas" value="{{item.AreaCode}}" ng-bind="item.AreaName"></option> </select> </td> <td class="">公司地址</td> <td> <input type="text" ng-model="postData.Address" ng-if="!isReadOnly" maxlength="100"> </td> </tr> <tr> <td class="">公司性质</td> <td> <select ng-model="postData.AddedValue" ng-disabled="isReadOnly"> <option value="1">小规模</option> <option value="2">一般纳税人</option> </select> </td> <td class="">所属行业</td> <td> <select ng-model="postData.Industry" ng-disabled="isReadOnly"> <option ng-repeat="item in industries" value="{{item.IndustryId}}" ng-bind="item.IndustryName"></option> </select> </td> </tr> <tr> <td class="">联系人</td> <td> <input type="text" ng-model="postData.Contacts" ng-if="!isReadOnly" maxlength="10"> </td> <td class="">手机</td> <td> <input type="text" ng-model="postData.Mobile" ng-if="!isReadOnly" maxlength="11"> </td> </tr> </tbody> </table> <table class="table table-bordered"> <thead> <th colspan="4" style="text-align:left"> <span class="t_header">营业执照信息</span> </th> </thead> <tbody> <tr> <td class="">注册号</td> <td> <input type="text" ng-model="postData.RegNO" ng-if="!isReadOnly" maxlength="20"> </td> <td class="">法人</td> <td> <input type="text" ng-model="postData.LegalPerson" ng-if="!isReadOnly" maxlength="10"> </td> </tr> <tr> <td class="">国税登记号</td> <td> <input type="text" ng-model="postData.NationalTaxNO" ng-if="!isReadOnly" maxlength="20"> </td> <td class="">地税登记号</td> <td> <input type="text" ng-model="postData.LocalTaxNO" ng-if="!isReadOnly" maxlength="20"> </td> </tr> <tr> <td class="">营业期限</td> <td> <span class="date_sel"> <input type="text" uib-datepicker-popup ng-model="postData.RegisterDate" is-open="dateIsOpened11" datepicker-options="dateOptions" close-text="关闭" current-text="今天" clear-text="清空" ng-click="dateIsOpened11 = !dateIsOpened11" ng-disabled="isReadOnly"> <button type="button" ng-click="dateIsOpened11 = !dateIsOpened11" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span>- <span class="date_sel"> <input type="text" uib-datepicker-popup ng-model="postData.BusnissDeadline" is-open="dateIsOpened1" datepicker-options="dateOptions" close-text="关闭" current-text="今天" clear-text="清空" ng-click="dateIsOpened1 = !dateIsOpened1" ng-disabled="isReadOnly || postData.NoDeadLine"> <button type="button" ng-click="dateIsOpened1 = !dateIsOpened1" ng-show="!isReadOnly"><i class="glyphicon glyphicon-calendar"></i></button> </span> <input type="checkbox" name="noLimitDate" value="1" ng-click="postData.NoDeadLine = !postData.NoDeadLine; " ng-checked="postData.NoDeadLine == 1"> 无期限  </td> <td class="">注册资金</td> <td> <input type="text" ng-model="postData.RegisteredCapital" ng-if="!isReadOnly" maxlength="15"> </td> </tr> <tr> <td class="">经营范围</td> <td> <textarea ng-model="postData.BusinessScope" ng-if="!isReadOnly" style="width:80%" rows="5"></textarea> </td> <td class="">上传营业执照</td> <td> <img ng-src="{{postData.BusinessLicense}}" ng-if="postData.BusinessLicense" class="order-img" alt="" pic-view> <input type="file" nv-file-select="" uploader="uploader2" ng-show="!isReadOnly"> <div class="progress" style="width:80%;margin-left:90px" ng-if="uploader2.isUploading"> <div class="progress-bar" role="progressbar" ng-style="{ \'width\': uploader2.progress + \'%\' }" style="width: 100%"></div> </div> <span>上传的图片大小请不要超过1M。</span> </td> </tr> </tbody> </table> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),
a.put("views/conchange.html",'<div class="o-list ng-scope"> <div><h2>纳税人类别变更</h2></div> <div class="o-search well well-sm"> <form class="form-inline"> <div class="form-group"> <label> 公司名称：</label> <input type="text" ng-model="cusname" class="form-control"> </div> <button class="btn btn-primary" ng-click="search()">搜索</button> </form> </div> <div class="o-body"> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>城市</th> <th>公司名称</th> \x3c!-- <th>合同签订日期</th> --\x3e <th>套餐类型</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="customer in customers"> <td>{{::customer.CityName}}</td> <td>{{::customer.Name}}</td> \x3c!-- <td>{{::customer.ContractDate|tDate}}</td> --\x3e <td>{{::customer.PriceName}}</td> <td class="table-opt" ng-show="{{customer.IsChanging == 0}}"> <a href="javascript:;" ng-click="view(customer.OrderId)">变更</a> </td> <td class="table-opt" style="color:#ccc" ng-show="{{customer.IsChanging == 1}}"> <span>变更</span> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/cusReview.html",'<div class="o-list"> <h2> 订单审核 </h2> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <label>代理商</label>： <select ng-model="channelId" class="form-control"> <option ng-value="undefined" ng-selected="true">全部</option> <option ng-repeat="item in agents" ng-value="item.ChannelId" ng-selected="false" ng-bind="item.ChannelName"></option> </select> </div> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="sdateIsOpened" datepicker-options="sdateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="sdateIsOpened = !sdateIsOpened" ng-change="setMinDate()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="sdateIsOpened = !sdateIsOpened"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="enddate" is-open="edateIsOpened" datepicker-options="edateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="edateIsOpened = !edateIsOpened"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="edateIsOpened = !edateIsOpened"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <button type="button" class="btn btn-primary" ng-click="searchFn()">查询</button> <button class="btn btn-default" ng-click="reset()">重置</button> </form> </div> <div class="o-body"> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th>序号</th> <th ng-repeat="head in headers" ng-bind="head"></th> <th>礼包</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="row in data"> <td ng-bind="$index+1"></td> <td ng-repeat="col in row.cols  track by $index" ng-bind-html="col"></td> <td> <span ng-if="order.GiftTypeId">{{::(row.GiftTypeName + \'(￥\' + row.GiftPrice + \')\') }}</span></td> <td> <div class="operate" ng-if="row.Status == 1"><a href="javascript:;" ng-click="view(row.OrderId)">查看</a> <a href="javascript:;" ng-click="audit(row.OrderId)">通过</a> <a href="javascript:;" ng-click="back(row.OrderId)">驳回</a></div> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/customer_forword.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">{{title||\'客户转出\'}}</h3> </div> <div class="modal-body clearfix"> <form name="vm.form" novalidate class="form-inline"> <formly-form model="vm.model" fields="vm.fields" options="vm.options" form="vm.form"> </formly-form> </form>  </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="save()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/customer_pub.html",'<div class="o-list ng-scope"> <div> <h2>公海客户</h2></div> <div class="o-search well well-sm"> <form class="form-inline"> <div class="form-group" ng-show="user.IsCenter == 0"> <label for="cusname">公司名称</label>： <input type="text" class="form-control" id="cusname" ng-model="search.companyName"> </div> <div class="form-group" ng-show="user.IsCenter == 0"> <label for="cusname">联系电话</label>： <input type="text" class="form-control" id="cusname" ng-model="search.mobile"> </div> <div class="form-group"> <label for="cusname">客户类型</label>： <select type="text" class="form-control" ng-model="search.cusType"> <option ng-value="0">请选择</option> <option value="{{::ctype.CustomerTypeId}}" ng-repeat="ctype in ctypes">{{::ctype.Name}}</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="searchFn()">查询</button> <button class="btn btn-primary" ng-click="open()">增加客户</button> <div class="btn btn-primary btn-upload">导入 <input type="file" nv-file-select="" uploader="uploader"> </div> </form> </div> <div class="o-body"> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>城市</th> <th>公司名称</th> <th>联系人</th> <th>联系人电话</th> <th>历史客户类型</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="customer in customers"> <td>{{::customer.cityName}}</td> <td>{{::customer.Name}}</td> <td>{{::customer.Contacts}}</td> <td>{{::customer.Mobile}}</td> <td>{{::customer.HisCusTypeName}}</td> <td class="table-opt"><a href="javascript:;" ng-click="open(customer)">查看</a> <a href="javascript:;" ng-click="rob(customer)">抢客户</a> <a href="javascript:;" ng-click="track(customer)">跟踪记录</a> <a href="javascript:;" ng-if="user.Category == 2 || user.Category == 4" ng-click="delete(customer)">删除</a> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/customer_rob.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">抢客户</h3> </div> <div class="modal-body clearfix"> <form name="vm.form" novalidate class="form-inline"> <formly-form model="vm.model" fields="vm.fields" options="vm.options" form="vm.form"> </formly-form> </form>  </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="save()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/customer_setting.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">客户设置</h3> </div> <div class="modal-body clearfix"> <div class="o-body cussetting"> <br> <div class="row form-group"> <div class="col-md-3">客户类型</div> <div class="col-md-3">库容（/个）</div> <div class="col-md-3">跟进期限（/天）</div> <div class="col-md-3">最大保护期（/天）</div> </div> <div class="row form-group" ng-repeat="setting in settings"> <label class="col-md-3 control-label">{{::setting.Name}}</label> <div class="col-md-3"> <input ng-if="$index<4" type="text" class="form-control" ng-model="setting.Repertory"> </div> <div class="col-md-3"> <input ng-if="$index<4" type="text" class="form-control" ng-model="setting.NoTrackDate"> </div> <div class="col-md-3"> <input ng-if="$index<4" type="text" class="form-control" ng-model="setting.LongestData"> </div> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="save()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/customer_signed.html",'<div class="o-list ng-scope"> <div> <h2>签单的客户</h2></div> <div class="o-search well well-sm"> <form class="form-inline"> <div class="form-group" ng-show="user.IsCenter == 0"> <label for="cusname">公司名称</label>： <input type="text" class="form-control" ng-model="companyName"> </div> <div class="form-group" ng-show="user.IsCenter == 0"> <label for="cusname">联系电话</label>： <input type="text" class="form-control" id="cusname" ng-model="mobile"> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> </form> </div> <div class="o-body"> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>城市</th> <th>公司名称</th> <th>联系人</th> <th>联系人电话</th> <th>销售</th> <th>签单时间</th> </tr> </thead> <tbody> <tr ng-repeat="customer in customers"> <td>{{::customer.CityName}}</td> <td>{{::customer.Name}}</td> <td>{{::customer.Contacts}}</td> <td>{{::customer.Mobile}}</td> <td>{{::customer.RealName}}</td> <td>{{::customer.ContractDate.substr(0,10)}}</td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/customer_total.html",'<div class="o-list ng-scope"> <div> <h2>客户情况统计</h2> </div> <div class="o-body"> <table class="table table-striped table-hover table-bordered" style="max-width:800px; margin-top:15px"> <thead> <tr class="info"> <th>姓名</th> <th>已签单</th> <th>准签约(A)</th> <th>重点跟进(B)</th> <th>可跟进(C)</th> <th>有效(D)</th> </tr> </thead> <tbody> <tr ng-repeat="customer in customers"> <td>{{::customer.RealName}}</td> <td class="text-right"><span ng-if="customer.BillType==0">{{::customer.BillType}}</span><a href="javascript:;" ng-click="viewDetail(customer.UserId,\'\')" ng-if="customer.BillType>0">{{::customer.BillType}}</a></td> <td class="text-right"><span ng-if="customer.AType==0">{{::customer.AType}}</span><a href="javascript:;" ng-click="viewDetail(customer.UserId,1)" ng-if="customer.AType>0">{{::customer.AType}}</a></td> <td class="text-right"><span ng-if="customer.BType==0">{{::customer.BType}}</span><a href="javascript:;" ng-click="viewDetail(customer.UserId,2)" ng-if="customer.BType>0">{{::customer.BType}}</a></td> <td class="text-right"><span ng-if="customer.CType==0">{{::customer.CType}}</span><a href="javascript:;" ng-click="viewDetail(customer.UserId,3)" ng-if="customer.CType>0">{{::customer.CType}}</a></td> <td class="text-right"><span ng-if="customer.DType==0">{{::customer.DType}}</span><a href="javascript:;" ng-click="viewDetail(customer.UserId,4)" ng-if="customer.DType>0">{{::customer.DType}}</a></td> </tr> <tr> <td>合计</td> <td class="text-right">{{::aBillType}}</td> <td class="text-right">{{::aAType}}</td> <td class="text-right">{{::aBType}}</td> <td class="text-right">{{::aCType}}</td> <td class="text-right">{{::aDType}}</td> </tr> </tbody> </table> </div> </div>'),a.put("views/customer_totaltoc.html",'<div class="recharge"> <h2 class="clearfix ng-binding">客户统计</h2> <uib-tabset active="active" style="margin-top: 6px"> <uib-tab index="0" heading="新增客户统计"> <div style="padding: 6px 12px"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="search1.starttime" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="search1.endtime" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <button type="button" class="btn btn-primary" ng-click="tab1Search()" style="margin-left:20px">查询</button> <button type="button" class="btn btn-primary" ng-click="dataExport1()" style="margin-left:20px">导出</button> </form> </div> <table class="table table-striped table-hover table-bordered" id="table1"> <thead> <tr class="info"> <th>大区</th> <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>新增客户数量</th> <th>新增客户合同金额</th> </tr> </thead> <tbody> <tr ng-repeat="item in data1"> <td>{{::item.PartitionName}}</td> <td>{{::item.ProvinceName}}</td> <td>{{::item.CityName}}</td> <td>{{::item.ChannelName1}}</td> <td>{{::item.ChannelName2}}</td> <td>{{::item.CustomerNum}}</td> <td>{{::item.ContractAmount}}</td> </tr> </tbody> <tfoot ng-if="data1.length != 0"> <tr> <td colspan="5">合计</td> <td>{{total1.SumCustomerNum}}</td> <td>{{total1.SumContractAmount||0}}</td> </tr> </tfoot> </table> </div> </uib-tab> <uib-tab index="1" heading="到期未续费客户统计"> <div style="padding: 6px 12px"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="search2.starttime" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="search2.endtime" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <button type="button" class="btn btn-primary" ng-click="tab2Search()" style="margin-left:20px">查询</button> <button type="button" class="btn btn-primary" ng-click="dataExport2()" style="margin-left:20px">导出</button> <button type="button" class="btn btn-primary" ng-click="export()" style="margin-left:20px">未续费明细下载</button> </form> </div> <table class="table table-striped table-hover table-bordered" id="table2"> <thead> <tr class="info"> <th>大区</th> <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>未续费客户数量</th> </tr> </thead> <tbody> <tr ng-repeat="item in data2"> <td>{{::item.PartitionName}}</td> <td>{{::item.ProvinceName}}</td> <td>{{::item.CityName}}</td> <td>{{::item.ChannelName1}}</td> <td>{{::item.ChannelName2}}</td> <td>{{::item.NotReFeeNum}}</td> </tr> </tbody> <tfoot ng-if="data2.length != 0"> <tr> <td colspan="5">合计</td> <td>{{total2.SumNotReFee}}</td> </tr> </tfoot> </table> </div> </uib-tab> </uib-tabset> </div>'),a.put("views/customer_track.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">{{::title}}</h3> </div> <div class="modal-body clearfix"> <div class="trackblock"> <div ng-repeat="track in tracks" class="trackItem"> <div class="pull-right saler">{{::track.RealName}}</div> <div class="date">{{::track.TrackDate.substr(0,10)}}</div> <div class="pull-right" ng-if="user.UserId == track.SalesId && track.TrackDate.substr(0,10)==today"><a href="javascript:;" ng-click="delete(track)"><i class="glyphicon glyphicon-trash" aria-hidden="true"></i></a></div> <pre class="description">{{::track.Description}}</pre> </div> <div ng-if="!tracks || tracks.length === 0" class="trackItem">暂无跟踪记录</div> </div> <div class="addtrack well-sm"> <div class="container-fluid form-group"> <label for="">跟踪日期</label> <span class="date_sel" class="col-md-4"> <input type="text" uib-datepicker-popup ng-model="TrackDate " is-open="dateIsOpened1" datepicker-options="dateOptions" close-text="关闭" current-text="今天" clear-text="清空" ng-click="dateIsOpened1 = !dateIsOpened1"> <button type="button" ng-click="dateIsOpened1 = !dateIsOpened1"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> <div class="container-fluid"> <label for="">跟踪记录</label> <textarea class="col-md-8" ng-model="content"></textarea> <button class="btn btn-primary save" type="button" ng-click="save()">添加</button> </div> </div> </div> <div class="modal-footer"> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/customers.html",'<div class="o-list ng-scope"> <div> <h2>我的客户</h2></div> <div class="o-search well well-sm"> <form class="form-inline"> <div class="form-group" ng-show="user.IsCenter == 0"> <label for="cusname">公司名称</label>： <input type="text" class="form-control" ng-model="companyName"> </div> <div class="form-group" ng-show="user.IsCenter == 0"> <label for="cusname">联系电话</label>： <input type="text" class="form-control" id="cusname" ng-model="mobile"> </div> <div class="form-group"> <label for="cusname">客户类型</label>： <select type="text" class="form-control" ng-model="cusType"> <option value="">请选择</option> <option value="{{::ctype.CustomerTypeId}}" ng-repeat="ctype in ctypes">{{::ctype.Name}}</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button class="btn btn-primary" ng-click="open()">增加客户</button> </form> </div> <div class="o-body"> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>城市</th> <th>公司名称</th> <th>联系人</th> <th>联系人电话</th> <th>客户类型</th> <th>最后跟踪时间</th> <th>销售</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="customer in customers"> <td>{{::customer.cityName}}</td> <td>{{::customer.Name}}</td> <td>{{::customer.Contacts}}</td> <td>{{::customer.Mobile}}</td> <td>{{::customer.cusTypeName}}</td> <td>{{::customer.RealLastTrackTime.substr(0,10)}}</td> <td>{{::customer.RealName}}</td> <td class="table-opt"><a href="javascript:;" ng-click="open(customer)">查看</a> <a href="javascript:;" ng-click="track(customer)">跟踪</a> <a href="javascript:;" ng-click="forward(customer)">客户转出</a> \x3c!--  <a href="javascript:;" ng-click="delete(customer)">删除</a> --\x3e </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/customers_modal.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">{{::title}}</h3> </div> <div class="modal-body"> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>城市</th> <th>公司名称</th> <th>联系人</th> <th>联系人电话</th> <th>客户类型</th> <th>最后跟踪时间</th> <th>销售</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="customer in customers"> <td>{{::customer.cityName}}</td> <td>{{::customer.Name}}</td> <td>{{::customer.Contacts}}</td> <td>{{::customer.Mobile}}</td> <td>{{::customer.cusTypeName||"已签单"}}</td> <td>{{::customer.RealLastTrackTime.substr(0,10)}}</td> <td>{{::customer.RealName}}</td> <td class="table-opt"><a href="javascript:;" ng-click="open(customer)">查看</a> <a href="javascript:;" ng-click="track(customer)">跟踪</a> <a href="javascript:;" ng-click="forward(customer)">客户转出</a> \x3c!--  <a href="javascript:;" ng-click="delete(customer)">删除</a> --\x3e </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/dateremind.html",'<div class="o-list ng-scope"> <div><h2>到期提醒</h2></div> <div class="o-search well well-sm"> <form class="form-inline"> <div class="form-group" ng-show="user.IsCenter == 0"> <label for="cusname">距离到期时间</label>： <select ng-model="limit" class="form-control"> <option value="1">一个月</option> <option value="2">两个月</option> <option value="3">三个月</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> </form> </div> <div class="o-body"> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>公司名称</th> <th>联系人</th> <th>联系人电话</th> <th>合同结束日期</th> <th>销售</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="customer in customers"> <td>{{::customer.Name}}</td> <td>{{::customer.Contacts}}</td> <td>{{::customer.Mobile}}</td> <td>{{::customer.ServiceEnd|tDate}}</td> <td>{{::customer.SaleName}}</td> <td class="table-opt"> <a href="javascript:;" ng-click="view(customer.OrderId)">查看</a> <a href="javascript:;" ng-click="add(customer.Name,customer.ServiceEnd.substr(0,10))">续费</a> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/delOrganize.html",'<div class="m-organize"> <div class="panel panel-danger"> <div class="panel-heading">删除机构</div> <div class="panel-body"> <form class="form-horizontal" ng-submit="delOragnize()"> <div class="form-group"> <label class="col-sm-3 control-label">移入新机构</label> <div class="col-sm-9"> <input type="text" class="form-control" id="inputName" disabled ng-model="selectedNode.DepartmentName"> </div> </div> <div class="form-group"> <label class="col-sm-3 control-label"></label> <div class="col-sm-9"> <div class="u-group-container"> <treecontrol class="tree-light" tree-model="treeModel" options="treeOptions" on-selection="selectedNodeChange(node)" selected-node="selectedNode"> <span>{{::node.DepartmentName}}</span> </treecontrol> </div> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-sm-10"> <button type="submit" class="btn btn-primary">删除</button> <button type="button" class="btn btn-link" ng-click="dismiss();">取消</button> </div> </div> </form> </div> </div> </div>'),a.put("views/details.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">{{::title}}</h3> </div> <div class="modal-body clearfix"> <p class="detail-list" ng-bind-html="message"></p> </div> <div class="modal-footer"> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/doclist.html",'<div class="doc-list notice-list"> <div class="vheader"> <h2> 文档列表 <span class="back-last" ng-click="goBackHome()">&lt&lt返回首页</span> </h2> </div> <div class="search"> <div class="form-group"> <input type="text" ng-model="filename" class="form-control" placeholder="搜索文件名"> <div class="form-group"> <select ng-model="type" class="form-control"> <option ng-repeat="item in types" value="{{item.type}}" ng-selected="type == item.type">{{item.name}}</option> </select> </div> <button class="btn btn-primary" ng-click="getFileList()">查询</button> </div> </div> <div class="list-con"> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th>文件名</th> <th>大小</th> <th>上传日期</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="row in doclists"> <td>{{::row.FileName}}</td> <td>{{::row.FileSize}}</td> <td>{{::row.CreateDate}}</td> <td> <div class="operate"> <a href="javascript:;" ng-click="download(row.Id)">下载</a> </div> </td> </tr> </tbody> </table> <div class="u-paginator form-inline paga-size"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/employee.html",'<div class="m-employee"> m-employee </div>'),
a.put("views/fd_aglist.html",'<div class="recharge"> <h2 class="clearfix"> 渠道返点 </h2> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <label>代理商</label>： <input type="text" ng-model="channelname" class="form-control"> </div> <button type="button" class="btn btn-primary" ng-click="pageChanged()">查询</button> <button class="btn btn-primary pull-right" ng-if="isCenter" ng-hide="isHide" ng-click="addAgent()">添加代理商</button> </form> </div> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th>序号</th> <th ng-repeat="head in headers" ng-bind="head"></th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="row in data"> <td ng-bind="$index+1"></td> <td ng-repeat="col in row.cols  track by $index" ng-class="{\'text-right\': rightAlign && rightAlign.indexOf($index)>-1}" ng-bind-html="col"></td> <td> <div class="operate"> <a href="javascript:;" ng-if="isCenter &&(row.Status == 1)" ng-click="setTask(row)">设置任务</a> <a href="javascript:;" ng-if="isCenter &&(row.Status == 1)" ng-click="fandian(row)">返点</a> </div> </td> </tr> </tbody> </table> <div class="u-paginator form-inline"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div>'),a.put("views/fd_fd.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">代理商返点({{year}}年)情况</h3> </div> <div class="modal-body clearfix"> <table class="table table-striped table-hover table-bordered" style="max-width:800px; margin-top:15px"> <thead> <tr class="info"> <th>月份</th> <th>目标数</th> <th>完成数</th> <th>完成比率</th> <th>返点比率</th> <th>返点金额</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="customer in tasks"> <td class="text-right">{{customer.Name}}</td> <td class="text-right">{{customer.TaskNumMonth}}</td> <td class="text-right">{{customer.CompleteNum}}</td> <td class="text-right">{{customer.GoalRate}}</td> <td class="text-right">{{customer.RebatesRatio}}</td> <td class="text-right">{{customer.RewardsMoney}}</td> <td class="text-center"><a href="javascript:;" ng-if="customer.access" ng-click="fetch(customer)">计算</a>&nbsp; <a ng-if="customer.RebatesRatio && customer.fdStatus<2" ng-click="fandian(customer.fd)" href="javascript:;">返点</a></td> </tr> </tbody> </table> </div> <div class="modal-footer"> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/fd_fdConfirm.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">代理商返点确认</h3> </div> <div class="modal-body clearfix"> <form class="form-inline agform" ng-class="{submited:submited}" name="agForm" novalidate ng-submit="ok()" ng-init="$parent.agForm = agForm"> <div class="clearfix"> <div class="form-group"> <label for="" class="col-md-3">返点金额</label> <input type="text" class="form-control" ng-model="rewardsMoney"> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/fd_settings.html",'<div class="o-list ng-scope"> <div> <h2>返点设置</h2></div> <div class="o-search well well-sm"> <form class="form-inline"> <div class="form-group"> <label>最低达成率(%)</label>： <input type="text" class="form-control" ng-model="postData.LowRate"> </div> <div class="form-group"> <label>最高达成率(%)</label>： <input type="text" class="form-control" ng-model="postData.HeighRate"> </div> <div class="form-group"> <label>返点(%)</label>： <input type="text" class="form-control" ng-model="postData.RebatesRatio"> </div> <button class="btn btn-primary" ng-click="add()">增加设置</button> </form> </div> <div class="o-body"> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>最低达成率(≥)</th> <th>最高达成率(&lt;)</th> <th>返点</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="fd in fds"> <td>{{::fd.LowRate}}%</td> <td>{{::fd.HeighRate}}%</td> <td>{{::fd.RebatesRatio}}%</td> <td class="table-opt"> <a href="javascript:;" ng-click="delete(fd)">删除</a> </td> </tr> </tbody> </table> </div> </div>'),a.put("views/fd_tasksetting.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">代理商任务设置({{year}}年)</h3> </div> <div class="modal-body clearfix"> <form class="form-inline agform" ng-class="{submited:submited}" name="agForm" novalidate ng-submit="ok()" ng-init="$parent.agForm = agForm"> <div class="clearfix"> <div class="form-group" ng-repeat="task in tasks"> <label for="" class="col-md-3">{{task.Name}}</label> <input type="text" class="form-control" ng-model="task.TaskNumMonth"> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/finance.html",'<div class="m-finance"> <h2> 财务明细查询 </h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <label> 选择代理： </label> <select class="form-control" ng-model="selectedAgent" ng-options="agent.ChannelName for agent in agentModel "> </select> </div> <div class="form-group"> <label> 选择类型： </label> <select class="form-control" ng-model="selectedType" ng-options="type.name for type in typeModel "> </select> </div> <button type="button" class="btn btn-primary" ng-click="getFinanceDetail()">查询</button> </form> </div> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th>省</th> <th>市</th> <th>一级代理</th> <th>二级代理</th> <th ng-if="user.IsCenter==1 || user.Category==2 || selectedType.type !== 1 ">{{selectedType.type === 1 ? \'支出\' : \'充值金额\'}}</th> <th ng-if="user.IsCenter==1 || user.Category==2 || selectedType.type !== 1 ">余额</th> <th ng-if="user.IsCenter==1 || user.Category==2 || selectedType.type !== 1 ">备注</th> \x3c!-- <th ng-if="user.IsCenter==0 && user.Category !=2 && selectedType.type === 1 ">合同金额</th> --\x3e <th>操作时间</th> <th ng-if="selectedType.type === 1 ">操作</th> </tr> </thead> <tbody> <tr ng-repeat="finance in financeModel"> <td style="width:70px">{{::finance.ProvinceName}}</td> <td style="width:70px">{{::finance.CityName}}</td> <td>{{::finance.ChannelName1}}</td> <td>{{::finance.ChannelName2}}</td> <td ng-if="user.IsCenter==1 || user.Category==2||selectedType.type !== 1 " class="text-right">{{::finance.Amount}}</td> <td ng-if="user.IsCenter==1 || user.Category==2||selectedType.type !== 1 " class="text-right">{{::finance.Balance}}</td> <td style="width:400px" ng-if="user.IsCenter==1 || user.Category==2||selectedType.type !== 1 ">{{::finance.Description}}</td> <td ng-if="user.IsCenter==0 && user.Category !=2 && selectedType.type === 1 ">{{::finance.ContractAmount}}</td> <td style="min-width:150px">{{::finance.BillTime}}</td> \x3c!--  --\x3e <td style="min-width:50px" ng-if="selectedType.type === 1"> <a ng-show="finance.Category == 1 && finance.OrderCategory != 2 && finance.Status" href="#/main/addOrder2/{{::finance.OrderId}}/1">查看订单</a> <a ng-show="finance.Category == 1 && finance.OrderCategory == 2 && finance.Status" href="#/main/addOrder2/{{::finance.OrderId}}/1">查看订单</a> <a ng-show="finance.Category == 1 && !finance.Status" ng-click="msgAlert()">查看订单</a> <a ng-show="finance.Category != 1"></a> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/go_task_config.html",'<div class="recharge"> <h2 class="clearfix"> 外勤通办任务配置 </h2> <div class="well well-sm u-search clearfix"> <button class="btn btn-primary pull-right" ng-click="add(\'\',$event,\'新增通办任务\')" style="margin:12px 0">&nbsp;&nbsp;&nbsp;新增&nbsp;&nbsp;&nbsp;</button> </div> \x3c!--<div ng-repeat="item in tasks">--\x3e <div style="position:relative" ng-repeat="item in tasksArr"> <uib-accordion close-others="false"> <div uib-accordion-group class="panel-default" is-open="true"> <uib-accordion-heading> {{item.CommonTaskName}}&nbsp; <div style="position:absolute;top:0;right:20px"> <button class="btn btn-primary pull-right" ng-click="ifuse($event,item)" style="margin:5px 0;height:29px;line-height:16px">&nbsp;&nbsp;&nbsp;{{item.Status==1?"禁用":"启用"}}&nbsp;&nbsp;&nbsp;</button> <button class="btn btn-primary pull-right" ng-click="add(item,$event,\'编辑任务\')" style="margin:5px 20px 0;height:29px;line-height:16px">&nbsp;&nbsp;&nbsp;编辑&nbsp;&nbsp;&nbsp;</button> </div> </uib-accordion-heading> <label ng-repeat="_item in item.TaskList" style="margin-right:20px">{{$index+1}}.{{_item.TaskName}}</label> </div> </uib-accordion> </div> </div>'),a.put("views/go_task_config_view.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">{{::title}}</h3> </div> <div class="modal-body"> <form name="cusform" novalidate class="form-inline"> <div class="clearfix" style="width:80%"> <div class="form-group col-md-6" style="margin: 12px 0;float:left"> <label for="" class="required">通办任务名称</label> <input type="text" class="form-control" ng-model="task.CommonTaskName" maxlength="15" required> </div> <div class="form-group col-md-6" style="margin: 12px 0;float:left"> <label for="" class="required">排序权重</label> <input class="form-control" ng-model="task.Weight" min="1" max="99" maxlength="2" required style="width:80px" ng-change="task.Weight = Math.floor(Math.abs(task.Weight)) || \'\'"> </div> </div> </form> <div> <uib-accordion close-others="false"> \x3c!--<div uib-accordion-group class="panel-default" is-open="true">\n                <uib-accordion-heading>\n                    {{item.name}}\n                    <div style="position:absolute;top:0;right:20px;">\n                        <button class="btn btn-primary pull-right" ng-click="ifuse($event)" style="margin:5px 0;height:29px;line-height:16px">&nbsp;&nbsp;&nbsp;启用&nbsp;&nbsp;&nbsp;</button>\n                        <button class="btn btn-primary pull-right" ng-click="add(\'\',$event,\'编辑任务\')" style="margin:5px 20px 0;height:29px;line-height:16px;">&nbsp;&nbsp;&nbsp;编辑&nbsp;&nbsp;&nbsp;</button>\n                    </div>\n                </uib-accordion-heading>\n                <lable ng-repeat="_item in item.tasks"><input type="checkbox" name="" checked value="{{_item}}">{{$index+1}}.{{_item}}</lable>\n            </div>--\x3e <div uib-accordion-group class="panel-default" is-open="open1"> <uib-accordion-heading>税务任务 <i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': open1, \'glyphicon-chevron-right\': !open1}"></i></uib-accordion-heading> <label ng-repeat="item in Tasks|filter:{BusinessType:1}:true" style="font-size:14px; min-width:200px;line-height:24px;display: inline-block; font-weight:400"><input type="checkbox" ng-model="item.checked">{{item.TaskName}}</label> </div> \x3c!--ifChecked(item.Id) ifAdd && item.Status==1 ng-model="item.checked"--\x3e <div uib-accordion-group class="panel-default" is-open="open2"> <uib-accordion-heading>工商任务 <i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': open2, \'glyphicon-chevron-right\': !open2}"></i></uib-accordion-heading> <label ng-repeat="item in Tasks|filter:{BusinessType:2}:true" style="font-size:14px; min-width:200px;line-height:24px;display: inline-block;font-weight:400"><input type="checkbox" ng-model="item.checked">{{item.TaskName}}</label> </div> <div uib-accordion-group class="panel-default" is-open="open3"> <uib-accordion-heading>其他任务 <i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': open3, \'glyphicon-chevron-right\': !open3}"></i></uib-accordion-heading> <label ng-repeat="item in Tasks|filter:{BusinessType:3}:true" style="font-size:14px;min-width:200px;display: inline-block;line-height:24px;font-weight:400"><input type="checkbox" ng-model="item.checked">{{item.TaskName}}</label> </div> </uib-accordion> <table class="table table-striped table-hover table-bordered"> <thead> <tr> <th style="width:150px">序号</th> <th style="width:350px">子任务名称</th> <th style="width:150px">权重</th> <th></th> </tr> </thead> <tbody> <tr ng-repeat="item in Tasks|filter:{checked:true} as result track by item.Id"> <td>{{$index+1}}</td> <td>{{item.defaultValue || item.TaskName}}</td> <td><input type="number" ng-model="item._weight" ng-init="item._weight=item._weight||result.length" min="1" max="99" maxlength="2" ng-change="task.Weight = Math.floor(Math.abs(task.Weight)) || \'\'" min="1"></td> <td> <a ng-click="item.checked=false" style="cursor:pointer">删除</a> </td> </tr> </tbody> </table> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-disabled="cusform.$invalid" ng-click="ok()">确认</button> <button class="btn btn-warning" type="button" ng-click="cancel()">取消</button> </div>'),a.put("views/invoice.html",'<div class="m-invoice"> <h2>发票管理</h2> <div class="well well-sm u-account"> <strong>未开发票金额</strong><span style="color:red;margin:0 12px">{{balance}}元 <button ng-disabled="invalid" class="btn btn-sm btn-primary" style="margin:0 12px" type="button" ng-click="applyInvoice()">立即申请</button> \x3c!-- <button class="btn btn-sm btn-primary" style="margin:0 12px;" type="button" ng-click="applyInvoice()">立即申请</button> --\x3e <span style="position: absolute"><span style="vertical-align: top;margin-right: 0">提醒：</span> <ul style="display:inline-block;padding-left: 20px;margin-top: -5px"> <li>每月仅10-20日可申请发票，未开发票金额为本月之前的累计未开发票总额（其中抵消掉退单已开具的发票金额）。</li> <li>第二年3月份前可申请上年发票，3月份及以后则不可申请。</li> </ul> </span> </span></div> <uib-tabset active="active"> <uib-tab heading="发票申请查询" select="tabSelect(1)"> <div class="well well-sm u-serach"> <form class="form-inline"> <div class="form-group"> <label> 发票申请编号: </label> <input type="text" ng-model="applyParams.invoiceid" class="form-control"> </div> <div class="form-group"> <label> 代理商: </label> <input type="text" ng-model="applyParams.channelname" class="form-control"> </div> <div class="form-group"> <label> 税号: </label> <input type="text" ng-model="applyParams.invoicecode" class="form-control"> </div> <div class="form-group"> <label> 申请时间： </label> <div class="input-group"> <input type="text" class="form-control" ng-model="applyViews.start" uib-datepicker-popup="yyyy/MM/dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.startFlag" ng-click="showDatepicker(\'start\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'start\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> — <div class="input-group"> <input type="text" class="form-control" ng-model="applyViews.end" uib-datepicker-popup="yyyy/MM/dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.endFlag" ng-click="showDatepicker(\'end\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'end\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> </div> <div class="form-group"> <label> 审核状态： </label> <select class="form-control" ng-model="applyViews.selectedApplyType" ng-options="type.name for type in applyType"> </select> </div> <button type="button" class="btn btn-primary" ng-click="getList();">查询</button> </form> </div> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>编号</th> <th>一级代理商</th> <th>二级代理商</th> <th>发票抬头</th> <th>税号</th> <th>开票金额</th> <th>发票类型</th> <th>申请时间</th> <th>审批状态</th> <th>审批意见</th> <th>操作</th> </tr> </thead> <tbody> \x3c!-- <tr ng-repeat="apply in applyModel track by apply.InvoiceId"> --\x3e <tr ng-repeat="apply in applyModel"> <td>{{::apply.InvoiceId}}</td> <td>{{::apply.ChannelName1}}</td> <td>{{::apply.ChannelName2}}</td> <td>{{::apply.Title}}</td> <td>{{::apply.InvoiceNumber}}</td> <td>{{::apply.Amount}}</td> <td>{{::apply.Property | filterProp}}</td> <td>{{apply.ApplyDate | date: \'yyyy-MM-dd\' }}</td> <td>{{apply.Status | filter1Status}}</td> <td>{{::apply.AuditMsg}}</td> <td><button class="btn btn-link" ng-if="apply.Status==2 || apply.IsCurr !== 1" ng-click="scan(apply)" type="button">查看</button> <button class="btn btn-link" ng-if="apply.Status!=2 && apply.IsCurr == 1" ng-click="applyInvoice(apply)" type="button">修改</button> <button class="btn btn-link" ng-if="apply.Status!=2 && apply.IsCurr == 1" ng-click="delete(apply)" type="button">删除</button> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="applyPaginator.total" items-per-page="applyPaginator.perPage" boundary-links="true" ng-model="applyPaginator.currentPage" previous-text="{{::applyPaginator.previousText}}" next-text="{{::applyPaginator.nextText}}" first-text="{{::applyPaginator.firstText}}" last-text="{{::applyPaginator.lastText}}" force-ellipses="true" max-size="6" num-pages="applyPaginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{applyPaginator.currentPage}}</span> / <span>{{applyPaginator.numPages}}</span> </div> <form name="paginatorForm1" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="applyViews.currentPage" required min="1" max="{{applyPaginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm1.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </uib-tab> <uib-tab heading="发票开具查询" select="tabSelect(2)"> <div class="well well-sm u-serach"> <form class="form-inline"> <div class="form-group"> <label> 发票申请编号: </label> <input type="text" ng-model="issueParams.invoiceid" class="form-control"> </div> <div class="form-group"> <label> 代理商: </label> <input type="text" ng-model="issueParams.channelname" class="form-control"> </div> <div class="form-group"> <label> 税号: </label> <input type="text" ng-model="issueParams.invoicecode" class="form-control"> </div> <div class="form-group"> <label> 申请时间： </label> <div class="input-group"> <input type="text" class="form-control" ng-model="issueViews.start" uib-datepicker-popup="yyyy/MM/dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.startFlag" ng-click="showDatepicker(\'start\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'start\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> — <div class="input-group"> <input type="text" class="form-control" ng-model="issueViews.end" uib-datepicker-popup="yyyy/MM/dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.endFlag" ng-click="showDatepicker(\'end\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'end\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> </div> <button type="button" class="btn btn-primary" ng-click="getList()">查询</button> </form> </div> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>申请编号</th> <th>一级代理商</th> <th>二级代理商</th> <th>发票抬头</th> <th>税号</th> <th>发票金额</th> <th>发票类型</th> <th>申请时间</th> <th>审批时间</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="apply in issueModel track by apply.InvoiceId"> <td>{{::apply.InvoiceId}}</td> <td>{{::apply.ChannelName1}}</td> <td>{{::apply.ChannelName2}}</td> <td>{{::apply.Title}}</td> <td>{{::apply.InvoiceNumber}}</td> <td>{{::apply.Amount}}</td> <td>{{::apply.Property | filterProp}}</td> <td>{{apply.ApplyDate | date: \'yyyy-MM-dd\' }}</td> <td>{{apply.AuditDate | date: \'yyyy-MM-dd\' }}</td> <td><button class="btn btn-link" ng-click="scan(apply)">查看</button></td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="issuePaginator.total" items-per-page="issuePaginator.perPage" boundary-links="true" ng-model="issuePaginator.currentPage" previous-text="{{::issuePaginator.previousText}}" next-text="{{::issuePaginator.nextText}}" first-text="{{::issuePaginator.firstText}}" last-text="{{::issuePaginator.lastText}}" force-ellipses="true" max-size="6" num-pages="issuePaginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{issuePaginator.currentPage}}</span> / <span>{{issuePaginator.numPages}}</span> </div> <form name="paginatorForm2" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="issueViews.currentPage" required min="1" max="{{issuePaginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm2.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </uib-tab> </uib-tabset> </div>'),a.put("views/invoiceAccept.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">开具发票</h3> </div> <div class="modal-body"> <form class="form-inline clearfix invoice-form"> <div class="form-group col-sm-12"> <label class="col-sm-2 control-label">税号</label> <input type="text" class="form-control col-sm-10" ng-model="invoice.InvoiceNumber"> </div> <div class="form-group col-sm-12"> <label class="col-sm-2 control-label">开票人</label> <input type="text" class="form-control col-sm-10" ng-model="invoice.InvoiceBy"> </div> <div class="form-group col-sm-12"> <label class="col-sm-2 control-label">开票日期</label> <div class="input-group"> <input type="text" class="form-control" ng-model="kpdate" uib-datepicker-popup="yyyy-MM-dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="isOpen" ng-click="isOpen = !isOpen" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="isOpen = !isOpen"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> </div> <div class="form-group col-sm-12"> <label for="inputDesc" class="col-sm-2 control-label">审核意见</label> <input type="text" class="form-control col-sm-10" name="desc" maxlength="50" ng-model="invoice.AuditMsg"> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/invoiceApply.html",'<div class="m-applyInvoice"> <div class="panel panel-primary"> <div class="panel-heading">发票申请</div> <div class="panel-body"> <form class="form-horizontal" name="applyForm" ng-submit="apply()"> <div class="form-group"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>发票抬头</label> <div class="col-sm-7"> <input type="text" name="title" required ng-maxlength="40" class="form-control" ng-model="applyParams.Title"> </div> <div class="col-sm-3"> <div class="text-danger" ng-messages="applyForm.title.$error" ng-if="applyForm.title.$dirty"> <span ng-message="required"> 请输入发票台头 </span> <span ng-message="maxlength"> 最大长度为40 </span> </div> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>发票性质</label> <div class="col-sm-7"> <select class="form-control" ng-model="selectedProp" ng-options="prop.name for prop in propertyModel "> </select> </div> <div class="col-sm-3"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>发票类型</label> <div class="col-sm-7"> <select class="form-control" ng-model="selectedCate" ng-options="cate.name for cate in categoryModel "> </select> </div> <div class="col-sm-3"> </div> </div> <div class="form-group" ng-if="selectedCate.category == 1"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>开户银行</label> <div class="col-sm-7"> <input type="text" required name="BankNo" placeholder="请填写开户行分行支行" class="form-control" ng-model="applyParams.DepositBank"> </div> </div> <div class="form-group" ng-if="selectedCate.category == 1"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>对公账号</label> <div class="col-sm-7"> <input type="text" required name="BankNo" class="form-control" ng-model="applyParams.BankNo"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>发票项目</label> <div class="col-sm-7"> <select class="form-control" ng-model="selectedProject" ng-options="project.Value for project in projectModel "> </select> </div> <div class="col-sm-3"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>税号</label> <div class="col-sm-7"> <input type="text" required name="InvoiceNumber" maxlength="20" class="form-control" ng-model="applyParams.InvoiceNumber"> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>发票金额</label> <div class="col-sm-7"> <input type="text" name="amount" readonly class="form-control" ng-model="applyParams.Amount"> </div> <div class="col-sm-3"> <a href="javascript:;" class="btn btn-link" ng-click="selectOrder()" style="padding: 6px;margin-left: -12px">选择订单</a> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>收件地址</label> <div class="col-sm-7"> <select class="form-control" required ng-model="selectedAddress" ng-options="address.Address for address in addressModel "> </select> </div> <div class="col-sm-3"> <a href="javascript:;" class="btn btn-default" ng-click="addAddress()">+</a> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>申请类型</label> <div class="col-sm-7"> <select class="form-control" ng-model="selectedType" ng-options="type.Value for type in typeModel "> </select> </div> <div class="col-sm-3"> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-sm-10"> <button type="submit" class="btn btn-primary" ng-disabled="applyForm.$invalid">保存</button> <button type="button" class="btn btn-link" ng-click="dismiss();">取消</button> </div> </div> </form> </div> </div> </div>'),a.put("views/invoiceReject.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">{{::title}}</h3> </div> <div class="modal-body"> <form class="form-inline clearfix invoice-form"> <div class="form-group col-sm-12"> <label for="inputDesc" class="col-sm-2 control-label">原因</label> <textarea class="form-control col-sm-10" name="desc" cols="50" rows="5" maxlength="50" ng-model="invoice.AuditMsg">\r\n            </textarea> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),
a.put("views/invoiceReview.html",'<div class="m-order"> <div class="m-order-content"> <h2> 发票审核 </h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <label for="">发票申请时间</label> <div class="input-group"> <input type="text" class="form-control" ng-model="start" uib-datepicker-popup="yyyy-MM-dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.startFlag" ng-click="showDatepicker(\'start\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'start\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" ng-model="end" uib-datepicker-popup="yyyy-MM-dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.endFlag" ng-click="showDatepicker(\'end\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'end\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> </div> <div class="form-group" ng-show="user.IsCenter == 1"> <label for="agent">代理商</label>： <input type="text" ng-model="channel" typeahead-min-length="0" uib-typeahead="agent as agent.ChannelName for agent in agentModel | filter:$viewValue | limitTo:8" class="form-control"> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> </form> </div> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>发票申请编号</th> <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>发票性质</th> <th>发票类型</th> <th>发票抬头</th> <th>税号</th> <th>发票金额</th> <th>申请时间</th> <th>状态</th> <th>审核评价</th> <th>操作</th> </tr> </thead> <tbody> \x3c!-- <tr><td>{{invoices.length}}</td></tr> --\x3e <tr ng-repeat="invoice in invoices track by invoice.InvoiceId"> <td>{{::invoice.InvoiceId}}</td> <td>{{::invoice.ProvinceName}}</td> <td>{{::invoice.CityName}}</td> <td>{{::invoice.ChannelName1}}</td> <td>{{::invoice.ChannelName2}}</td> <td>{{::invoice.Property | filterInvoiceProperty}} </td> <td>{{::invoice.Category | filterInvoiceCategory}}</td> <td>{{::invoice.Title}}</td> <td>{{::invoice.InvoiceNumber}}</td> <td class="text-right">{{::invoice.Amount}}</td> <td class="text-right">{{::invoice.ApplyDate.substr(0,10)}}</td> <td>{{::invoice.Status|filterStatus}}</td> <td>{{::invoice.AuditMsg}}</td> <td> <a href="javascript:;" ng-click="scan(invoice)">查看</a>&nbsp; <a href="javascript:;" ng-click="accept(invoice)">开具发票</a> &nbsp; <a href="javascript:;" ng-if="invoice.Status!=3" ng-click="reject(invoice)">拒绝开票</a> </td> </tr> </tbody> </table> </div> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/invoiceScan.html",'<div class="m-applyInvoice"> <div class="panel panel-primary"> <div class="panel-heading">发票详情</div> <div class="panel-body"> <div> <div class="col-sm-12">发票抬头：{{invoiceInfo.Title}}</div> <div class="col-sm-6">发票性质：{{invoiceInfo.Property | filterProp}}</div> <div class="col-sm-6">发票类型：{{invoiceInfo.Category | filterCate}}</div> <div class="col-sm-6">发票项目：服务费</div> <div class="col-sm-6">税号：{{invoiceInfo.InvoiceNumber}}</div> <div class="col-sm-6">发票金额：{{invoiceInfo.Amount}}</div> <div class="col-sm-6">申请类型：{{invoiceInfo.projectMap}}</div> <div class="col-sm-12" ng-if="invoiceInfo.Category == 1">开户银行：{{invoiceInfo.DepositBank}}</div> <div class="col-sm-12" ng-if="invoiceInfo.Category == 1">对公账号：{{invoiceInfo.BankNo}}</div> <div class="col-sm-12">公司姓名：{{invoiceInfo.ReceiveAddress.Name}}</div> <div class="col-sm-12">收货地址：{{invoiceInfo.ReceiveAddress.Address}}</div> <div class="col-sm-12">联系电话：{{invoiceInfo.ReceiveAddress.Mobile}}</div> <div class="col-sm-12"> <span>审核意见</span> ：{{invoiceInfo.InvoiceAudit.AuditMsg ? invoiceInfo.InvoiceAudit.AuditMsg : \'无\'}} </div> </div> </div> <div class="panel-footer"> <button class="btn btn-default" type="button" ng-click="dismiss();">关闭</button> </div> </div> </div>'),a.put("views/invoiceSearch.html",'<div class="m-order"> <div class="m-order-content"> <h2> 发票查询 </h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <label for="agent">代理商</label>： <select class="form-control" id="agent" ng-model="selectedAgent" ng-options="agent.ChannelName for agent in agentModel "> </select> </div> <div class="form-group"> <label for="">开票时间</label> <div class="input-group"> <input type="text" class="form-control" ng-model="start" uib-datepicker-popup="yyyy-MM-dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.startFlag" ng-click="showDatepicker(\'start\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'start\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" ng-model="end" uib-datepicker-popup="yyyy-MM-dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.endFlag" ng-click="showDatepicker(\'end\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'end\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> </div> <div class="form-group"> <label for="agent">发票编号</label>： <input type="text" class="form-control" ng-model="invoiceCode"> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> </form> </div> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>发票编号</th> <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>发票性质</th> <th>发票类型</th> <th>发票抬头</th> <th>发票金额</th> <th>开票时间</th> <th>操作</th> </tr> </thead> <tbody> \x3c!-- <tr><td>{{invoices.length}}</td></tr> --\x3e <tr ng-repeat="invoice in invoices track by invoice.InvoiceId"> <td>{{::invoice.InvoiceNumber}}</td> <td>{{::invoice.ProvinceName}}</td> <td>{{::invoice.CityName}}</td> <td>{{::invoice.ChannelName1}}</td> <td>{{::invoice.ChannelName2}}</td> <td>{{::invoice.Property | filterInvoiceProperty}} </td> <td>{{::invoice.Category | filterInvoiceCategory}}</td> <td>{{::invoice.Title}}</td> <td class="text-right">{{::invoice.Amount}}</td> <td class="text-right">{{::invoice.InvoiceDate.substr(0,10)}}</td> <td class="text-center"><button class="btn btn-info btn-xs" ng-click="scan(invoice)" type="button">查看</button></td> </tr> </tbody> </table> </div> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/invoiceSelectOrder.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">选择未开发票订单</h3> </div> <div class="modal-body"> <form class="form-inline"> <div class="form-group"> <label> 订单时间： </label> <div class="input-group" style="width: 150px"> <input type="text" class="form-control" ng-model="searchParams.starttime" uib-datepicker-popup="yyyy-MM-dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.startFlag" ng-click="showDatepicker(\'start\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'start\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> — <div class="input-group" style="width: 150px"> <input type="text" class="form-control" ng-model="searchParams.endtime" uib-datepicker-popup="yyyy-MM-dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.endFlag" ng-click="showDatepicker(\'end\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'end\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> </div> <div class="form-group"> <label>公司名称/法人</label>： <input flex ng-model="searchParams.name" class="form-control"> </div> <button class="btn btn-primary" type="button" ng-disabled="cusform.$invalid" ng-click="search()">查询</button> </form> <div style="max-height:500px;overflow:auto"> <table class="table table-striped table-hover table-bordered" style="margin: 12px 0"> <thead> <tr class="info"> <th><input type="checkbox" ng-model="isCheckAll" ng-checked="isChecked()" ng-click="checkAll()"></th> <th>公司名称</th> <th>法人</th> <th>合同号</th> <th>提单金额</th> <th>可开金额</th> <th>订单审批状态</th> <th>订单日期</th> <th>是否开过发票</th> </tr> </thead> <tbody> <tr ng-repeat="customer in orders"> <td class="text-center"><input type="checkbox" ng-model="customer.selected"></td> <td>{{::customer.Name}}</td> <td>{{::customer.LegalPerson}}</td> <td>{{::customer.ContractNO}}</td> <td>{{::customer.ContractAmount}}</td> <td>{{::customer.BLAmount}}</td> <td>通过</td> <td>{{::customer.CreateDate.substr(0,10)}}</td> <td>否</td> </tr> </tbody> </table> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">确定</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/login.html",'<div class="l-back"></div> <div class="l-box"> <div class="l-logo pull-left"> </div> <div class="l-lbox pull-right"> <div class="text-center l-header"> <img src="images/LOGO.5419b2f9.png" alt=""> </div> <form class="form-inline"> <div class="form-group col-md-12"> <label for="exampleInputEmail1">用户名</label> <input type="text" class="form-control" placeholder="用户名" ng-model="userName"> </div> <div class="form-group col-md-12"> <label for="exampleInputPassword1">密码</label> <input type="password" class="form-control" placeholder="密码" ng-model="password"> </div> <div class="text-center"> <button type="submit" class="btn btn-primary" ng-click="login()">登录</button> </div> </form> </div> </div>'),a.put("views/main.html",'<md-toolbar class="md-whiteframe-glow-z1 site-content-toolbar" md-colors="::{background: \'default-primary-50\'}" style="height: 45px"> <div class="md-toolbar-tools" md-colors="::{background: \'default-primary-50\'}" style="padding-left:0"> <a class="headerlogo" ng-click="goMainHtml()"></a> <span style="margin: 0 0 0 232px;position:absolute;height:45px;z-index:1;top:0;line-height:50px;font-size:20px">渠道管理系统</span> <div class="warning" ng-if="showBalanceWarning" style="position: absolute;right: 350px">您的账户余额已不足1000元，为保证您的正常使用请尽快充值。</div> <div style="position: absolute; right: 12px;font-size: 16px; top:6px;line-height: 34px"> <span>欢迎您，{{user.RealName}}&nbsp;进入！</span> <span class="btn btn-link pull-right" ng-if="user.se" style="color: #fff; text-align: right" ng-click="logoutZY()"><i class="fa fa-sign-out" aria-hidden="true"></i>退出直营</span> <span class="btn btn-link pull-right line" ng-click="logout()"><i class="fa fa-sign-out" aria-hidden="true"></i>[退出]</span> <span class="btn btn-link pull-right line" ng-click="updatePswd()"><i class="fa fa-sign-out" aria-hidden="true"></i>[修改密码]</span> </div> </div> </md-toolbar> <div class="g-content"> <div class="m-main"> <div class="content-left"> <div class="u-nav-container"> <div class="nav-home"> <span ng-click="goMainHtml()">首页</span> </div> <treecontrol class="tree-light" tree-model="navTreeModel" options="navTreeOptions" on-selection="routerChange(node)" selected-node="selectedNavTree" expanded-nodes="expandedNodes"> <span>{{::node.name}}</span> </treecontrol> </div> </div> <div class="content-right" ui-view> <div class="home-content"> <div class="board dash-board" style="height: {{curHeight}}"> <div class="dash-board-bg"> <h4>仪表盘</h4> </div> </div> <div class="home-right"> <div class="board notice" style="height: {{rightcurHeight}}"> <h4> 最新公告 <span ng-if="noticelists.length" class="more" ng-click="goMoreNotice()">更多>></span> </h4> <div class="last-item-border"> <div ng-if="noticelists.length" class="list-item" ng-repeat="list in noticelists"> <div> <i ng-if="list.IsNew">新</i> <span ng-click="noticeDetail(list.id)">{{list.Title}}</span> </div> <p>{{list.CreateDate}}</p> </div> </div> <div ng-if="!noticelists.length" class="list-bg"></div> </div> <div class="board document" style="height: {{rightcurHeight}}"> <h4> 帮助文档 <span ng-if="doclists.length" class="more" ng-click="goMorefile()">更多>></span> </h4> <div ng-if="doclists.length" class="document-item" ng-repeat="list in doclists"> <i></i> <div ng-click="download(list.Id)">{{list.FileName}}</div> </div> <div ng-if="!doclists.length" class="list-bg list-bg-document"></div> </div> </div> </div> </div> </div> </div>'),a.put("views/makeAccount.html",'<div class="m-achieve"> <h2> 做账与报税数据统计 </h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <label>截止日期：</label> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE" style="width:120px"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> \x3c!-- <th rowspan="2">大区</th> --\x3e <th rowspan="2">省</th> <th rowspan="2">市</th> <th rowspan="2">一级代理商</th> <th rowspan="2">二级代理商</th> <th rowspan="2">当前账期</th> <th rowspan="2">零申报</th> <th rowspan="2">确认零票</th> <th rowspan="2">未传票 </th> <th colspan="3" class="text-center">账务确认</th> <th rowspan="2">已确认比率</th> <th colspan="2" class="text-center">报税</th> </tr> <tr class="info"> <th>待出账</th> <th>出账待确认</th> \x3c!-- <th>传票完成未出账</th> --\x3e <th>已确认</th> <th>申报</th> <th>未申报</th> </tr> <tr> <th colspan="4">合计</th> <th class="text-right">{{aCurrentBusinessDateCompanyCount}}</th> <th class="text-right">{{aTiDanZero}}</th> <th class="text-right">{{aConfirmZero}}</th> <th class="text-right">{{aUnMonition}}</th> <th class="text-right">{{aUnMakeAccount}}</th> <th class="text-right">{{aMakeAccountUnConfirm}}</th> \x3c!-- <th class="text-right">{{aReceiptCompleteUnMakeAccount}}</th> --\x3e <th class="text-right">{{aConfirm}}</th> <th class="text-right"></th> <th class="text-right">{{aTax}}</th> <th class="text-right">{{aUnTax}}</th> </tr> </thead> <tbody> <tr ng-repeat="item in tableData"> \x3c!-- <td style="text-align:center; width:90px">{{item.PartitionName}}</td> --\x3e <td style="text-align:center; width:200px">{{item.ProvinceName}}</td> <td style="text-align:center; width:120px">{{item.CityName}}</td> <td style="text-align:center; width:120px">{{item.ChannelName1}}</td> <td style="text-align:center; width:120px">{{item.ChannelName2}}</td> <td style="text-align:center; width:120px">{{item.CurrentBusinessDateCompanyCount}}</td> <td style="text-align:center; width:120px">{{item.TiDanZero}}</td> <td style="text-align:center; width:100px">{{item.ConfirmZero}}</td> <td style="text-align:center; width:120px">{{item.UnMonition}}</td> <td style="text-align:center; width:120px; text-decoration: underline; color: blue" ng-click="downloadColumn1(item)">{{item.UnMakeAccount}}</td> <td style="text-align:center; width:150px; text-decoration: underline; color: blue" ng-click="downloadColumn2(item)">{{item.MakeAccountUnConfirm}}</td> \x3c!-- <td style="text-align:center; width:150px">{{item.ReceiptCompleteUnMakeAccount}}</td> --\x3e <td style="text-align:center; width:120px">{{item.Confirm}}</td> <td style="text-align:center; width:120px">{{item.ConfirmRate | filterNum}}</td> <td style="text-align:center; width:150px">{{item.Tax}}</td> <td style="text-align:center; width:150px; text-decoration: underline; color: blue" ng-click="downloadColumn3(item)">{{item.UnTax}}</td> </tr> </tbody> </table> </div> </div> </div>'),a.put("views/messageModal.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">消息</h3> </div> <div class="modal-body clearfix message"> <span ng-bind="message"></span> </div> <div class="modal-footer"> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/newcus.html",'<div class="m-achieve"> <h2> 新增客户统计 </h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> </form> </div> <table class="table table-striped table-hover table-bordered" id="dataTable" style="width: 600px"> <thead> <tr class="info"> <th>渠道</th> <th class="text-right">新增客户数</th> <th class="text-right">新增客户合同金额</th> </tr> </thead> <tbody> <tr ng-repeat="row in rows track by row.ChannelId"> <td>{{row.ChannelName}}</td> <td class="text-right">{{row.CustomerNum}}</td> <td class="text-right">{{row.ContractAmount}}</td> </tr> <tr> <td>合计 </td><td class="text-right">{{totalNum}} </td><td class="text-right">{{totalAmount}} </td></tr> </tbody> </table> </div> </div>'),a.put("views/noticeDetail.html",'<div class="notice-detail notice-list"> <div class="vheader"> <h3 style="font-size: 20px; padding-left: 21px"> 公告详情 <span class="back-last" ng-click="goBackLast()">&lt&lt返回上一页</span> </h3> </div> <div class="content"> <h3>{{detailData.Title}}</h3> <div class="detail-nav"> <span>发布日期：{{detailData.CreateDate}}</span> </div> <div class="detail-con"> <pre style="padding: 0"><textarea class="detail-area" ng-model="detailData.Text" rows="16"></textarea></pre> </div> </div> </div>'),a.put("views/noticelists.html",'<div class="notice-list"> <div class="vheader"> <h2> 最新公告 <span class="back-last" ng-click="goBackHome()">&lt&lt返回首页</span> </h2> </div> <div class="other-style"> <div class="list-item-other" ng-repeat="list in noticelists"> <span class="data-sign" ng-if="list.IsNew">新</span> <span class="detail-item" ng-click="noticeDetail(list.id)">{{list.Title}}</span> <span class="date-float">{{list.CreateDate}}</span> </div> </div> <div class="u-paginator form-inline paga-size"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div>'),a.put("views/ob_add.html",'<div class="order"> <form class="form-horizontal" name="myForm" ng-submit="save()" novalidate ng-class="{readonly:isReadOnly,submited:submited}"> <p ng-if="hasBalance" class="u-balance">账户余额:<span style="color: red">{{::balance}}</span> </p> <p> <label>销售员：</label> <select ng-model="postData.SaleId"> <option value="{{::sale.UserId}}" ng-repeat="sale in sales" ng-bind="sale.RealName"></option> </select> </p> <div bu-group="业务信息"> <table class="table table-bordered"> <tbody> <tr> <td class="required" width="150">业务名称</td> <td> <input type="text" typeahead-min-length="0" ng-model="postData.BusinessName" uib-typeahead="item.BusinessName for item in bnames| filter:{BusinessName:$viewValue}" required> <span ng-bind="postData.BusinessName" ng-if="isReadOnly"></span> </td> <td class="required" width="150">价格</td> <td> <input type="text" ng-model="postData.Price" required> <span ng-bind="postData.Price" ng-if="isReadOnly"></span> </td> </tr> </tbody> </table> </div> <div bu-group="客户信息"> <table class="table table-bordered"> <tbody> <th colspan="4" style="text-align:left"> <span class="t_header">客户基本信息</span> </th> <tr> <td class="required" width="150">公司名称</td> <td> <input type="text" typeahead-min-length="3" ng-if="!isReadOnly" ng-model="postData.Name" uib-typeahead="item.Name for item in getCompanyName($viewValue)" required typeahead-on-select="companySelect($item, $model, $label, $event)"> <span ng-bind="postData.Name" ng-if="isReadOnly"></span> </td> \x3c!-- <td>公司别名</td>\r\n                    <td>\r\n                        <input type="text" ng-model="postData.ShortName" ng-readonly="isReadOnly" maxlength="50"/>\r\n                    </td> --\x3e <td class="required" width="150">所在城市</td> <td> <select ng-model="postData.CityCode" ng-disabled="isReadOnly" required> <option ng-repeat="city in cities" ng-selected="postData.CityCode == city.CityCode" value="{{city.CityCode}}">{{::city.CityName}}</option> </select> </td> </tr> <tr> <td class="required">公司地址</td> <td> <input type="text" ng-model="postData.Address" ng-if="!isReadOnly" maxlength="100" required> <span ng-bind="postData.Address" ng-if="isReadOnly"></span> </td> <td class="required">所属行业</td> <td> <select ng-model="postData.Industry" ng-disabled="isReadOnly" required> <option ng-repeat="item in industries" value="{{item.IndustryId}}" ng-bind="item.IndustryName"></option> </select> </td> </tr> <tr> <td class="required">公司性质</td> <td> <select ng-model="postData.AddedValue" ng-disabled="isReadOnly" required> <option value="1">小规模</option> <option value="2">一般纳税人</option> </select> </td> \x3c!-- <td>公司规模</td>\r\n                    <td>\r\n                        <input type="text" ng-model="postData.Scale" ng-readonly="isReadOnly" maxlength="20"/>\r\n                    </td> --\x3e <td class="required">联系人</td> <td> <input type="text" ng-model="postData.Contacts" ng-if="!isReadOnly" maxlength="10" required> <span ng-bind="postData.Contacts" ng-if="isReadOnly"></span> </td> </tr> <tr> <td class="required">手机</td> <td> <input type="text" ng-model="postData.Mobile" ng-if="!isReadOnly" maxlength="11" required> <span ng-bind="postData.Mobile" ng-if="isReadOnly"></span> </td> <td></td> <td></td> </tr> </tbody> </table> </div> <div class="text-center container-fluid"> <button ng-show="!isReadOnly" type="submit" class="btn btn-primary save">保存</button> <a ng-if="showClose" class="btn btn-primary" ng-click="close();">关闭</a> </div> </form> </div>'),a.put("views/ob_list.html",'<div class="o-list ng-scope"> <div> <h2>其他业务</h2></div> <div class="o-search well well-sm"> <form class="form-inline"> <div class="form-group"> <label for="cusname">业务类型</label>： <select class="form-control" ng-model="bsName"> <option value="">请选择业务类型</option> <option ng-repeat="bname in bnames">{{::bname.BusinessName}}</option> </select> </div> <div class="form-group"> <label for="cusname">公司名称</label>： <input type="text" class="form-control" ng-model="companyName"> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> </form> </div> <div class="o-body"> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>业务名称</th> <th>公司名称</th> <th>销售</th> <th>价格</th> <th>时间</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="customer in customers"> <td>{{::customer.BusinessName}}</td> <td>{{::customer.Name}}</td> <td>{{::customer.RealName}}</td> <td>{{::customer.Price}}</td> <td>{{::customer.CreateDate.replace(\'T\',\' \')}}</td> <td class="table-opt"><a href="#/main/addOb/{{::customer.Id}}">修改</a> <a href="javascript:;" ng-click="delete(customer.Id)">删除</a> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/operateAccount.html",'<div class="m-achieve"> <h2> 运营会计数据总览 </h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <label>截止日期：</label> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE" style="width:120px"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> <th rowspan="2">省</th> <th rowspan="2">市</th> <th rowspan="2">一级代理商</th> <th rowspan="2">二级代理商</th> <th rowspan="2">代理商入驻日期</th> <th rowspan="2">全部客户数 </th> <th rowspan="2">Agent系统客户数</th> <th rowspan="2">零申报</th> <th rowspan="2">未建账</th> <th colspan="3" class="text-center">建账完成</th> <th rowspan="2">挂起</th> </tr> <tr class="info"> <th>当前账期</th> <th>历史账期-需补账</th> <th>未开始做账</th> </tr> <tr> <th colspan="5">合计</th> <th class="text-right">{{aAllCusNum}}</th> <th class="text-right">{{aTotalNum}}</th> <th class="text-right">{{aTiDanZero}}</th> <th class="text-right">{{aNoSetUpNum}}</th> <th class="text-right">{{aRingNum}}</th> <th class="text-right">{{aLateNum}}</th> <th class="text-right">{{aUnstartNum}}</th> <th class="text-right">{{aHungNum}}</th> </tr> </thead> <tbody> <tr ng-repeat="item in tableData"> \x3c!-- <td style="text-align:center; width:90px">{{item.PartitionName}}</td> --\x3e <td style="text-align:center; width:200px">{{item.ProvinceName}}</td> <td style="text-align:center; width:120px">{{item.CityName}}</td> <td style="text-align:center; width:120px">{{item.ChannelName1}}</td> <td style="text-align:center; width:120px">{{item.ChannelName2}}</td> <td style="text-align:center; width:120px">{{item.CreateDate | tDate}}</td> <td style="text-align:center; width:120px">{{item.AllCusNum}}</td> <td style="text-align:center; width:120px; text-decoration: underline; color: blue" ng-click="downloadColumn1(item)">{{item.TotalNum}}</td> <td style="text-align:center; width:120px">{{item.TiDanZero}}</td> <td style="text-align:center; width:100px">{{item.NoSetUpNum}}</td> <td style="text-align:center; width:120px">{{item.RingNum}}</td> <td style="text-align:center; width:120px; text-decoration: underline; color: blue" ng-click="downloadColumn2(item)">{{item.LateNum}}</td> <td style="text-align:center; width:150px">{{item.UnstartNum}}</td> <td style="text-align:center; width:150px; text-decoration: underline; color: blue" ng-click="downloadColumn3(item)">{{item.HungNum}}</td> </tr> </tbody> </table> </div> </div> </div>'),
a.put("views/orderList.html",'<div class="o-list"> <div> <h2>{{::title||"我提交的订单查询"}}</h2></div> <div class="o-search well well-sm"> <form ng-show="!title" class="form-inline" style="padding-right: 300px"> <div> <div class="form-group"> <label> 公司名称：</label> <input type="text" ng-model="cusname" class="form-control" style="width:200px"> </div> <div class="form-group"> <label> 法人：</label> <input type="text" ng-model="LegalPerson" class="form-control" style="width:200px"> </div> </div> <div> <div class="form-group" style="padding-top: 10px"> <label>开始日期：</label> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="sdateIsOpened" datepicker-options="sdateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="sdateIsOpened = !sdateIsOpened" ng-change="setMinDate()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="sdateIsOpened = !sdateIsOpened"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="form-group" style="padding-top: 10px"> <label>结束日期：</label> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="enddate" is-open="edateIsOpened" datepicker-options="edateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="edateIsOpened = !edateIsOpened"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="edateIsOpened = !edateIsOpened"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="form-group" style="padding-top: 10px"> <label>状态</label>： <select ng-model="status" class="form-control"> <option ng-value="0" ng-selected="+status==0">全部</option> <option ng-value="1">未审核</option> <option ng-value="2">通过</option> <option ng-value="3">拒审</option> </select> </div> </div> <button class="btn btn-primary" ng-click="searchFn()" style="position: absolute;left: 600px;top: 63px">搜索</button> \x3c!-- <button class="btn btn-default" ng-click="reset()">重置</button> --\x3e </form> <form ng-show="title" class="form-inline"> <div ng-show="title"> <div class="form-group"> <label> 公司名称：</label> <input type="text" ng-model="cusname" class="form-control" style="width:150px"> </div> <div class="form-group"> <label> 法人：</label> <input type="text" ng-model="LegalPerson" class="form-control" style="width:150px"> </div> <div class="form-group"> <label>开始日期：</label> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="sdateIsOpened" datepicker-options="sdateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="sdateIsOpened = !sdateIsOpened" ng-change="setMinDate()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="sdateIsOpened = !sdateIsOpened"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="form-group"> <label>结束日期：</label> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="enddate" is-open="edateIsOpened" datepicker-options="edateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="edateIsOpened = !edateIsOpened"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="edateIsOpened = !edateIsOpened"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="form-group"> <label>状态</label>： <select ng-model="status" class="form-control"> <option ng-value="0" ng-selected="+status==0">全部</option> <option ng-value="1">未审核</option> <option ng-value="2">通过</option> <option ng-value="3">拒审</option> </select> </div> <button class="btn btn-primary" ng-click="searchFn()">搜索</button> </div> </form> <div ng-if="!title" style="position: absolute;top: 70px;right: 20px;font-size: 14px;color: #333;font-weight: bold"> <input type="checkbox" ng-model="IsExpireRenew" :checked="isChecked" ng-click="consoleValue(IsExpireRenew)"> 仅显示需要续费的订单 </div> </div> <div class="o-body"> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th>序号</th> <th ng-repeat="head in headers" ng-bind="head"></th> <th>法人</th> <th ng-if="!isZB">礼包</th> <th ng-if="!isZB">活动</th> <th ng-if="!isZB">到期时间</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="row in data"> <td ng-bind="$index+1"></td> <td ng-repeat="col in row.cols  track by $index" ng-class="{\'text-right\': rightAlign && rightAlign.indexOf($index)>-1}" ng-bind-html="col"></td> <td>{{::row.LegalPerson}}</td> <td ng-if="!isZB"> <span ng-if="row.GiftTypeId">{{::(row.GiftTypeName + \'(￥\' + row.GiftPrice + \')\') }}</span></td> <td ng-if="!isZB">{{::row.PromotionName}}</td> <td ng-if="!isZB && row.IsExpireRenew == 0">{{::row.ServiceEnd | tDate}}</td> <td ng-if="!isZB && row.IsExpireRenew == 1" style="color: red">{{::row.ServiceEnd | tDate}}</td> <td> <div class="operate" ng-if="(row.Status == 1 || row.Status == 3) && row.Category<3"> <a href="javascript:;" ng-click="modify(row)">修改</a> <a href="javascript:;" ng-click="delete(row.OrderId)">删除</a> </div> <div class="operate" ng-if="row.Status == 2 && row.Category !=2" style="display:inline-block"> <a href="javascript:;" ng-click="modify(row)">查看</a> </div> <div class="operate" ng-if="(row.Status == 2 && row.Category ==2) || (row.Status !=2 && row.Category ==3)" style="display:inline-block"> <a href="javascript:;" ng-click="modify(row)">记账准备</a> </div> <div class="operate" ng-if="row.Status == 2 && row.IsExpireRenew == 1" style="display:inline-block"> <a href="javascript:;" ng-click="add(row.Name,row.ServiceEnd.substr(0,10))">续费</a> </div> </td> </tr> </tbody> </table> <div class="u-paginator form-inline"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/orderSearch.html",'<div class="m-order"> <div class="m-order-content"> <h2> 订单查询 </h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <div class="form-group"> <label for="cusname">公司名称</label>： <input type="text" class="form-control" id="cusname" ng-model="searchParams.cusname"> </div> <div class="form-group"> <label> 法人：</label> <input type="text" ng-model="LegalPerson" class="form-control"> </div> <div class="input-group"> <input type="text" class="form-control" ng-model="start" uib-datepicker-popup="yyyy-MM-dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.startFlag" ng-click="showDatepicker(\'start\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'start\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" ng-model="end" uib-datepicker-popup="yyyy-MM-dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.endFlag" ng-click="showDatepicker(\'end\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'end\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> </div> <div class="form-group"> <label for="province">审核状态</label>： <select class="form-control" id="province" ng-model="selectedStatus" ng-options="status.name for status in statusModel "> </select> </div> <div class="form-group"> <label>订单类型</label>： <select class="form-control" ng-model="category"> <option value="0">全部</option> <option value="1">正常</option> <option value="2">预提单初审</option> <option value="3">预提单复审</option> </select> </div> <div class="form-group" ng-show="user.IsCenter == 1"> <label for="agent">代理商</label>： <input type="text" ng-model="channel" typeahead-min-length="0" uib-typeahead="agent as agent.ChannelName for agent in agentModel | filter:$viewValue | limitTo:8" class="form-control"> </div> <button type="button" class="btn btn-primary" ng-click="pageChanged()">查询</button> </form> </div> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> \x3c!-- <th>订单编号</th> --\x3e <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>公司名称</th> <th>类型</th> <th>合同金额</th> <th>礼包</th> <th>活动</th> <th>法人</th> <th>状态</th> <th>订单日期</th> <th ng-if="user.Category !==7">操作</th> </tr> </thead> <tbody> <tr ng-repeat="order in orderModel"> \x3c!-- <td>{{::order.OrderId}}</td> --\x3e <td>{{::order.ProvinceName}}</td> <td>{{::order.CityName}}</td> <td>{{::order.ChannelName1}}</td> <td>{{::order.ChannelName2}}</td> <td>{{::order.Name}}</td> <td>{{::order.Category|cusCategory}}</td> <td class="text-right">{{::order.ContractAmount}}</td> <td> <span ng-if="order.GiftTypeId">{{::(order.GiftTypeName + \'(￥\' + order.GiftPrice + \')\') }}</span></td> <td>{{::order.PromotionName}}</td> <td>{{order.LegalPerson}}</td> <td>{{order.Status | filterStatus}}</td> <td>{{::order.CreateDate}}</td> <td ng-if="user.Category !==7"><a href="javascript:;" ng-click="view(order.OrderId)">查看</a> <a href="javascript:;" ng-click="modify(order)" ng-if="order.Status == 1 || order.Status == 3 || user.IsCenter">修改</a> <a href="javascript:;" ng-click="delete(order.OrderId)" ng-if="order.Status == 1 || order.Status == 3">删除</a> <a href="javascript:;" ng-click="reback(order.OrderId)" ng-if="order.Status == 2 && user.IsCenter">审核回退</a> <a href="javascript:;" ng-click="guaqi(order)" ng-if="order.Status == 2 && user.IsCenter">挂起</a> </td> </tr> </tbody> </table> </div> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div>'),a.put("views/order_outworker.html",'<div class="recharge"> <h2 class="clearfix"> 外勤任务 </h2> <div class="well well-sm u-search"> <form class="form-inline" style="position:relative;padding-right:150px"> <div class="form-group" style="margin: 5px 10px 5px 10px"> <label>序列ID</label>： <input type="text" ng-model="search.Id" class="form-control"> </div> <div class="form-group" style="margin: 5px 10px 5px 10px"> <label>公司名称</label>： <input type="text" ng-model="search.companyname" class="form-control"> </div> <div class="form-group" style="margin: 5px 10px 5px 10px"> <label>公司联系人</label>： <input type="text" ng-model="search.connector" class="form-control"> </div> <div class="form-group" style="margin: 5px 10px 5px 10px"> <label>任务名称</label>： <select ng-model="search.taskname" class="form-control"> <option value="" ng-selected="true">请选择</option> <option ng-repeat="task in Tasks" ng-value="task.CommonTaskId">{{task.CommonTaskName}}</option> <option ng-value="0">其他</option> \x3c!--需要改数据--\x3e </select> </div> <div class="form-group" style="margin: 5px 10px 5px 10px"> <label>当前子任务</label>： <select ng-model="search.childtaskname" class="form-control"> <option value="" ng-selected="true">请选择</option> <option ng-repeat="outT in outTasks" ng-value="outT.Id">{{outT.TaskName}}</option> </select> </div> <div class="form-group" style="margin: 5px 10px 5px 10px"> <label>当前外勤人员</label>： <select ng-model="search.currOutworker" class="form-control"> <option value="" ng-selected="true">请选择</option> <option ng-repeat="ot in outworkers" ng-value="{{::ot.UserId}}">{{::ot.RealName}}</option> \x3c!--需要改数据--\x3e </select> </div> \x3c!--日期--\x3e <div class="form-group" style="margin: 5px 10px 5px 10px;min-width:300px"> <lable style="margin-bottom: 5px;font-weight: bold;float:left;line-height:34px;height:34px">任务提交日期：</lable> <div class="row" style="float:left"> <div class="col-md-6"> <p class="input-group" style="margin:0"> <input type="text" class="form-control" uib-datepicker-popup="{{format}}" ng-model="dt1" is-open="popup1.opened" datepicker-options="dateOptions" close-text="Close" alt-input-formats="altInputFormats" ng-change="changeDate()" id="date1" style="padding:6px"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="open1()"><i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </div> <div class="col-md-6"> <p class="input-group" style="margin:0"> <input type="text" class="form-control" uib-datepicker-popup ng-model="dt2" is-open="popup2.opened" datepicker-options="dateOptions" close-text="Close" ng-change="changeDate()" id="date2" style="padding:6px"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="open2()"><i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </div> </div> </div> <div class="form-group" style="margin: 5px 10px 5px 10px"> <label>所属区（县）</label>： <select ng-model="search.areacode" class="form-control"> <option value="" ng-selected="true">请选择</option> <option ng-repeat="area in areas" ng-value="area.AreaCode">{{area.AreaName}}</option> \x3c!--需要改数据--\x3e </select> </div> <div class="form-group" style="margin: 5px 10px 5px 10px"> <label>销售人员</label>： <select ng-model="search.salesId" class="form-control"> <option value="0" ng-selected="true">请选择</option> <option ng-repeat="u in users" ng-value="u.UserId">{{u.RealName}}</option> \x3c!--需要改--\x3e </select> </div> <div class="form-group" style="margin: 5px 10px 5px 10px"> <label>子任务状态</label>： <select ng-model="search.taskstatus" class="form-control"> <option value="" ng-selected="true">请选择</option> <option ng-repeat="(key,value) in taskStatus" ng-value="key">{{value}}</option> \x3c!--需要改--\x3e </select> </div> \x3c!--<div class="form-group">\n                <a href="">导出Excel表格</a>\n            </div>--\x3e <button type="button" class="btn btn-primary" ng-click="searchFn()" style="position:absolute;right:20px;top:5px;width:110px">搜索</button> <button class="btn btn-primary pull-right" ng-click="open()" style="position:absolute;right:20px;top:50px" ng-if="user.Category ==2 || user.Category==8">新增外勤任务</button> </form> </div> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>序列ID</th> <th>任务名称</th> <th>公司名称</th> <th>所属区域</th> <th>公司联系人</th> <th>销售人员</th> \x3c!--<th>联系人电话</th>--\x3e <th>当前子任务</th> <th>当前外勤人员</th> <th>提交任务时间</th> <th>子任务状态</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="customer in customers"> <td style="text-align:center">{{customer.Id}}</td> <td style="text-align:center">{{customer.MainTaskName}}</td> <td style="text-align:center">{{customer.CompanyName}}</td> <td style="text-align:center">{{customer.AreaName}}</td> <td style="text-align:center">{{customer.Contacts}}</td> <td style="text-align:center">{{customer.SalesName}}</td> <td style="text-align:center">{{customer.childTaskName}}</td> <td style="text-align:center">{{customer.OutWorkerName}}</td> <td style="text-align:center">{{customer.SubmitTaskTime.replace("T"," ")}}</td> <td style="text-align:center">{{customer.Status|otStatus}}</td> <td class="table-opt" style="text-align:center"><button class="btn btn-link" href="javascript:;" ng-click="detail(customer)">查看详情</button> <button class="btn btn-link" href="javascript:;" ng-show="user.Category ==2 || user.Category==8" ng-disabled="customer.Status>3" ng-click="delete(customer)">取消</button></td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> &nbsp; <span>合计:{{paginator.total}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" ng class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div>'),a.put("views/order_outworker_add.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">添加外勤任务</h3> </div> <div class="modal-body"> <form name="cusform" novalidate> <div class="well well-sm" style="min-height: 200px"> <uib-accordion close-others="true"> <div uib-accordion-group class="panel-default" close-others="true" is-open="open1" is-disabled="tbIsDisable()"> <uib-accordion-heading> 通办任务 <i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': accordion.open1, \'glyphicon-chevron-right\': !accordion.open1}"></i> </uib-accordion-heading> <div ng-repeat="task in tasksArr" style="width:100%;min-height:50px;margin:2px;background:#eee;max-height:280px"> <p> <lable style="width:100%;font-size:16px"><input type="checkbox" name="commonTask" ng-model="task.checked" ng-change="checkTB(task)" ng-value="true">&nbsp;&nbsp;&nbsp;{{task.CommonTaskName}}</lable> </p> <ul style="padding-left:20px;min-height:40px;display: inline-block"> <li style="float:left;margin-right:12px;height:18px;list-style:none" ng-repeat="item in task.TaskList"> {{$index+1}}.{{item.TaskName}} </li> </ul> </div> </div> <div uib-accordion-group class="panel-default" close-others="true" is-open="open2" is-disabled="otherIsDisable()"> <uib-accordion-heading> 其他 <i class="pull-right glyphicon" ng-class="{\'glyphicon-chevron-down\': accordion.open2, \'glyphicon-chevron-right\': !accordion.open2}"></i> </uib-accordion-heading> <uib-accordion close-others="false"> <div uib-accordion-group ng-repeat="tg in tasks" class="panel-default" is-open="true"> <uib-accordion-heading> {{::tg.Name}}任务 </uib-accordion-heading> <label style="margin:6px 30px 6px 0;font-size:16px;display:inline-block" ng-repeat="task in tg.list"><input type="checkbox" ng-model="task.selected">{{::task.TaskName}}</label> </div> </uib-accordion> </div> </uib-accordion> </div> <div class="well well-sm u-search form-inline clearfix"> <div class="form-group col-md-12"> <label class="required">选择公司</label>： <input flex ng-value="postData.Customer.Name || postData.Customer.Contacts" required ng-disabled="cus_selected" aria-label="CompanyName" ng-click="selectCustomer()" readonly class="form-control"> </div> <div class="form-group col-md-12" style="margin-top:20px"> <label class="required">选择区域</label>： <select ng-model="areaSele" class="form-control" required value="0" ng-change="change()" required> <option value="" ng-selected="true">请选择</option> <option ng-repeat="area in areaArr" ng-value="area.AreaCode">{{area.AreaName}}</option> </select> </div> <div class="form-group col-md-12" style="margin: 12px 0"> <label>备注</label>： <textarea name="" flex ng-model="postData.Remark" maxlength="400" style="width: 100%;height: 100px"></textarea> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-disabled="cusform.$invalid" ng-click="ok($event)">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>  '),a.put("views/order_outworker_detail.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">任务详情</h3> </div> <div class="modal-body"> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> \x3c!--<th style="width: 40px;" ng-show="batIsOpen"></th>--\x3e <th ng-show="user.Category ==2 || user.Category==8">选择</th> <th>序列ID</th> <th>子任务名称</th> <th>当前外勤人员</th> <th>开始时间</th> <th>完成时间</th> <th style="width:70px">状态</th> <th style="width:180px">操作</th> </tr> </thead> <tbody> <tr ng-repeat="customer in customers track by customer.TaskId"> <td ng-show="user.Category ==2 || user.Category==8"><input type="checkbox" ng-model="customer.selected" ng-disabled="customer.Status>3" style="vertical-align: top; width:16px;height:16px"></td> <td>{{customer.Id}}</td> <td>{{customer.TaskName}}</td> <td>{{customer.OutWorkerName}}</td> <td>{{customer.StartTime|tDateTime}}</td> <td>{{customer.EndTime|tDateTime}}</td> <td>{{customer.Status|outWorkStatus}}</td> <td><button class="btn btn-link" ng-click="editCompany(customer)" ng-if="user.Category ==2 || user.Category==8 || customer.OutWorkerId == user.UserId" ng-disabled="(user.Category ==2 || user.Category==8)? false :customer.Status != 3">编辑</button> <button class="btn btn-link" ng-click="statusChange(customer,3,\'确认资料\')" ng-if="user.Category ==2 || user.Category==8 || customer.OutWorkerId == user.UserId" ng-disabled="customer.Status!==2">确认资料</button> <button class="btn btn-link" ng-click="statusChange(customer,5,\'完成\')" ng-if="user.Category ==2 || user.Category==8 || customer.OutWorkerId == user.UserId" ng-disabled="customer.Status!==3">完成</button> <button class="btn btn-link" ng-click="forward(customer)" ng-if="user.Category ==2 || user.Category==8" ng-disabled="customer.Status>3">转接任务</button> <button class="btn btn-link" ng-click="statusChange(customer,4,\'取消任务\')" ng-if="user.Category ==2 || user.Category==8" ng-disabled="customer.Status>3">取消</button></td> </tr> </tbody> </table> <lable ng-if="user.Category ==2 || user.Category==8"><input type="checkbox" style="vertical-align: top; width:16px;height:16px" ng-model="forwards.isSelectAll" ng-change="selectAll()">全选</lable> <select ng-change="forwardAll()" ng-model="forwards.forwardUserId" ng-if="user.Category ==2 || user.Category==8"> <option selected value="0">任务批量分配</option> <option ng-repeat="ot in outworkers" value="{{::ot.UserId}}">{{::ot.RealName}}</option> </select> </div> <div class="modal-footer"> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/outwork_dict.html",'<div class="recharge"> <h2 class="clearfix"> 外勤任务字典 </h2> <div class="well well-sm u-search clearfix"> <div class="pull-left" style="margin: 12px 0"> <label for="subtask_search">子任务名称 ：</label> <input type="text" ng-model="search.TaskName" id="subtask_search"> </div> <div class="pull-left" style="margin: 12px 10px 0"> <label for="">分类名称：</label> <select ng-model="search.BusinessType" style="height:26px;width:80px"> <option value="" selected>请选择</option> <option value="1" ng-selected="searchData.BusinessType ==\'1\'">税务任务</option> <option value="2" ng-selected="searchData.BusinessType ==\'2\'">工商任务</option> <option value="3" ng-selected="searchData.BusinessType ==\'3\'">其他任务</option> </select> </div> <div class="pull-left" style="margin: 12px 10px 0"> <label for="">状态：</label> <select ng-model="search.Status" style="height:26px;width:80px"> <option value="0" selected>请选择</option> <option value="1">启用</option> <option value="2">停用</option> </select> </div> <button class="btn btn-primary pull-right" ng-click="open()" style="margin:12px 20px 0">&nbsp;&nbsp;&nbsp;新增&nbsp;&nbsp;&nbsp;</button> <button class="btn btn-primary pull-right" ng-click="searchFn()" style="margin:12px 0">&nbsp;&nbsp;&nbsp;搜索&nbsp;&nbsp;&nbsp;</button> </div> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>序列ID</th> <th>子任务名称</th> <th>分类名称</th> <th>操作时间</th> <th>服务费用</th> <th>状态</th> <th>最后操作</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="outworker in outworkers"> <td style="text-align:center">{{outworker.Id}}</td> <td style="text-align:center">{{outworker.TaskName}}</td> <td style="text-align:center">{{outworker.BusinessType|fOtType}}</td> <td style="text-align:center">{{outworker.ModifyDate.replace("T"," ")}}</td> <td style="text-align:center">￥：{{outworker.Price.toFixed(2)}}</td> <td style="text-align:center">{{outworker.Status==1?"启用":"停用"}}</td> <td style="text-align:center">{{outworker.RealName}}</td> <td class="table-opt" style="text-align:center"> &nbsp;<a href="javascript:;" ng-click="open(outworker)">编辑</a>&nbsp;&nbsp;&nbsp; <a href="javascript:;" ng-click="stopOrnot(outworker.Status,outworker.Id)">{{outworker.Status==2?"启用":"停用"}}</a> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div>'),a.put("views/outwork_dict_view.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">{{::title}}</h3> </div> <div class="modal-body"> <form name="cusform" novalidate class="form-inline"> <div class="clearfix" style="width:80%"> <div class="form-group col-md-12" style="margin: 12px 0"> <label for="" class="required">任务名称</label> <input type="text" class="form-control" ng-model="postData.TaskName" required style="width:300px" maxlength="15"> </div> <div class="form-group col-md-12" style="margin: 12px 0"> <label for="" class="required">分类名称</label> <select ng-model="postData.BusinessType" class="form-control" required style="width:200px"> <option value="">请选择</option> <option ng-value="1" ng-selected="postData.BusinessType ==1">税务任务</option> <option ng-value="2" ng-selected="postData.BusinessType ==2">工商任务</option> <option ng-value="3" ng-selected="postData.BusinessType ==3">其他任务</option> </select> </div> <div class="form-group col-md-12" style="margin: 12px 0"> <label for="" class="required">服务费用</label> <input type="number" class="form-control" ng-model="postData.Price" required placeholder="0" min="0" ng-input="checkPrice()"> </div> <div class="form-group col-md-12" style="margin: 12px 0"> 是否启用：<lable style="margin:0 30px;display:inline-block"><input type="radio" name="ifuse" value="1" ng-model="postData.ifuse.use">启用</lable> <lable style="margin:0 30px;display:inline-block"><input type="radio" name="ifuse" value="2" ng-model="postData.ifuse.use">停用</lable> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-disabled="cusform.$invalid" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/outwork_weight_setting.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">{{::title}}</h3> </div> <div class="modal-body"> <table class="table table-striped table-hover table-bordered"> <thead> <tr> <th style="width:150px">序号</th> <th style="width:350px">子任务名称</th> <th style="width:150px">权重</th> <th></th> </tr> </thead> <tbody> <tr ng-repeat="item in Tasks|filter:{selected:true} as result track by item.TaskId"> <td>{{$index+1}}</td> <td>{{item.TaskName}}</td> <td><input type="number" ng-model="item._weight" ng-init="item._weight=$index+1" min="1" max="99" maxlength="2" ng-model-options="{allowInvalid:true}" ng-change="item._weight = toInt(item._weight)" min="1"></td> <td> <a ng-click="delete(item)" style="cursor:pointer">删除</a> </td> </tr> </tbody> </table> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-disabled="cusform.$invalid" ng-click="ok()">确认</button> <button class="btn btn-warning" type="button" ng-click="cancel()">取消</button> </div>'),a.put("views/payDetail.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">支付明细</h3> </div> <div class="modal-body"> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th>序号</th> <th ng-repeat="head in headers" ng-bind="head"></th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="row in data"> <td ng-bind="$index+1"></td> <td ng-repeat="col in row.cols  track by $index" ng-class="{\'text-right\': rightAlign && rightAlign.indexOf($index)>-1}" ng-bind-html="col"></td> <td><a href="javascript:;" ng-click="view(row.OrderId)">查看</a></td> </tr> </tbody> </table> <div class="u-paginator form-inline"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> <div class="modal-footer"> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),
a.put("views/receipt.html",'<div class="m-achieve"> <h2> 传票数据统计 </h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <label>截止日期：</label> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE" style="width:120px"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> \x3c!-- <th rowspan="2">大区</th> --\x3e <th rowspan="2">省</th> <th rowspan="2">市</th> <th rowspan="2">一级代理商</th> <th rowspan="2">二级代理商</th> <th rowspan="2">当前账期</th> <th rowspan="2">零申报</th> <th colspan="2" class="text-center">催票</th> <th rowspan="2">确认零票</th> <th colspan="3" class="text-center">传票</th> <th rowspan="2">传票完成率</th> <th rowspan="2">驳票客户数</th> </tr> <tr class="info"> <th>未催</th> <th>已催</th> <th>待传票</th> <th>传票未完成</th> <th>传票完成（有票）</th> </tr> <tr> <th colspan="4">合计</th> <th class="text-right">{{aCurrentBusinessDateCompanyCount}}</th> <th class="text-right">{{aTiDanZero}}</th> <th class="text-right">{{aUnUrgeCount}}</th> <th class="text-right">{{aUrgeCount}}</th> <th class="text-right">{{aConfirmZero}}</th> <th class="text-right">{{aUnMonitionCount}}</th> <th class="text-right">{{aMonitionCount}}</th> <th class="text-right">{{aMonitionCompleteCount}}</th> <th class="text-right"></th> <th class="text-right">{{aRejectCount}}</th> </tr> </thead> <tbody> <tr ng-repeat="item in tableData"> \x3c!-- <td style="text-align:center; width:90px">{{item.PartitionName}}</td> --\x3e <td style="text-align:center; width:200px">{{item.ProvinceName}}</td> <td style="text-align:center; width:120px">{{item.CityName}}</td> <td style="text-align:center; width:120px">{{item.ChannelName1}}</td> <td style="text-align:center; width:120px">{{item.ChannelName2}}</td> <td style="text-align:center; width:120px; text-decoration: underline; color: blue" ng-click="downloadColumn1(item)">{{item.CurrentBusinessDateCompanyCount}}</td> <td style="text-align:center; width:120px">{{item.TiDanZero}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn2(item)">{{item.UnUrgeCount}}</td> <td style="text-align:center; width:120px; text-decoration: underline; color: blue" ng-click="downloadColumn3(item)">{{item.UrgeCount}}</td> <td style="text-align:center; width:120px">{{item.ConfirmZero}}</td> <td style="text-align:center; width:150px; text-decoration: underline; color: blue" ng-click="downloadColumn4(item)">{{item.UnMonitionCount}}</td> <td style="text-align:center; width:150px">{{item.MonitionCount}}</td> <td style="text-align:center; width:150px">{{item.MonitionCompleteCount}}</td> <td style="text-align:center; width:150px">{{item.CompleteRate | filterNum}}</td> <td style="text-align:center; width:150px; text-decoration: underline; color: blue" ng-click="downloadColumn5(item)">{{item.RejectCount}}</td> </tr> </tbody> </table> </div> </div> </div>'),a.put("views/recharge.html",'<div class="recharge"> <h2> 财务信息 </h2> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th>序号</th> <th ng-repeat="head in headers" ng-bind="head"></th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="row in data"> <td ng-bind="$index+1"></td> <td ng-repeat="col in row.cols  track by $index" ng-class="{\'text-right\': rightAlign && rightAlign.indexOf($index)>-1}" ng-bind-html="col"></td> <td> <div class="operate"> <a href="javascript:;" ng-click="addMoney(row)">充值</a> &nbsp; <a href="javascript:;" ng-click="addMoneyDetail(row.ChannelId)">充值明细</a>&nbsp; <a href="javascript:;" ng-click="payDetail(row.ChannelId)">支付明细</a>\x3c!-- &nbsp;\n                        <a href="javascript:;" ng-click="setDiscount(row.ChannelId)">折扣设定</a> --\x3e </div> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> \x3c!--  <uib-pagination total-items="totalItems" ng-model="currentPage" max-size="5" items-per-page="pageSize" \n            previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;"\n             ng-change="pageChanged()" rotate="true" style="margin: -10px auto"></uib-pagination> --\x3e </div>'),a.put("views/recharge_apply.html",'<div class="m-balance"> <div class="balance-content"> <h2> 充值申请 </h2> <div class="panel panel-default"> <div class="panel-body"> <div class="u-account"> <div class="account-detail"> <p> 账户余额<strong style="margin: 0 20px;color: red">{{::balance}}元</strong> <button type="button" class="btn btn-primary" ng-click="apply()" style="vertical-align: top">充值申请</button> </p> </div> </div> </div> </div> <div> \x3c!-- <div class="panel-heading">收支明细</div> --\x3e <div> <div>充值申请查询</div> <div class="well well-sm u-search"> <div class="clearfix search-item form-inline" style="margin-bottom: 0"> <div class="form-group"> <span class="navbar-text navbar-left">代理商：</span> <input type="text" class="form-control" ng-model="searchParams.channelName"> </div> <div class="form-group"> <span class="navbar-text navbar-left">申请时间</span> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" ng-model="searchParams.startTime" uib-datepicker-popup="yyyy/MM/dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.startFlag" ng-click="showDatepicker(\'start\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'start\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" ng-model="searchParams.endTime" uib-datepicker-popup="yyyy/MM/dd" ng-required date-options="datepickerConfig.options" close-text="{{::datepickerConfig.closeText}}" clear-text="{{::datepickerConfig.clearText}}" current-text="{{::datepickerConfig.currentText}}" is-open="datepickerConfig.endFlag" ng-click="showDatepicker(\'end\')" readonly> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="showDatepicker(\'end\')"> <i class="glyphicon glyphicon-calendar"></i> </button> </span> </div> </div> </div> <div class="form-group"> <span class="navbar-text navbar-left">审核状态：</span> <select class="form-control" ng-model="searchParams.status"> <option value="0">全部</option> <option value="1">未审核</option> <option value="2">通过</option> <option value="3">拒审</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> </div> </div> <div class="table-container"> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>序号</th> <th ng-repeat="head in headers" ng-bind="head"></th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="row in data"> <td ng-bind="$index+1"></td> <td ng-repeat="col in row.cols  track by $index" ng-class="{\'text-right\': rightAlign && rightAlign.indexOf($index)>-1}" ng-bind-html="col"></td> <td> <button class="btn btn-link" ng-if="row.Status ==2 || row.IsCurr !== 1" ng-click="view(row)">查看</button> <button class="btn btn-link" ng-if="row.Status !=2 && row.IsCurr == 1" ng-click="apply(row)">修改</button> <button class="btn btn-link" ng-if="row.Status !=2 && row.IsCurr == 1" ng-click="delete(row)">删除</button> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div> </div> </div> </div> </div>'),a.put("views/recharge_apply_modal.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">充值申请</h3> </div> <div class="modal-body form-inline recharge-modal"> <div class="row"> <span class="required">充值金额</span> <div class="form-group"> <button class="btn btn-amount" ng-class="{\'btn-selected\':rAmount==5000}" ng-click="rAmount=5000">5000</button> <button class="btn btn-amount" ng-class="{\'btn-selected\':rAmount==10000}" ng-click="rAmount=10000">10000</button> <button class="btn btn-amount" ng-class="{\'btn-selected\':rAmount!=5000&& rAmount!=10000}" ng-click="rAmount=0">更多</button> <input ng-show="rAmount!= 5000 && rAmount!=10000" ng-model="rAmount" type="text" ng-change="rAmount = Math.round(rAmount*100)/100 || \'\'" ng-model-options="{updateOn: \'blur\',debounce: { \'default\': 1000, \'blur\': 0 }}" class="form-control"> </div> </div> <div class="row"> <span class="required">付款明细</span> <div class="form-group"> <table class="table table-hover"> <thead> <tr class="info"> <th style="border: 1px solid #ddd">*付款账户</th> <th style="border: 1px solid #ddd">*付款时间</th> <th style="border: 1px solid #ddd">*付款金额（元）</th> </tr> </thead> <tbody> <tr ng-repeat="rg in rlist"> <td><input type="text" class="form-control" ng-model="rg.AccountOfPayment" placeholder="付款账户不要填写空格"></td> <td> <p class="input-group" style="margin:0"> <input type="text" class="form-control" ng-click="rg.opened= true" ng-model="rg.PayTime" uib-datepicker-popup="yyyy-MM-dd" ng-model="dt" is-open="rg.opened" datepicker-options="dateOptions" close-text="关闭" alt-input-formats="altInputFormats"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="rg.opened= true"><i class="glyphicon glyphicon-calendar"></i></button> </span> </p> </td> <td> <input type="text" class="form-control" style="text-align: right" ng-model="rg.Amount" ng-change="rg.Amount = Math.round(rg.Amount*100)/100 || \'\'" ng-model-options="{updateOn: \'blur\',debounce: { \'default\': 1000, \'blur\': 0 }}"> </td> <td class="opt"> <i class="glyphicon glyphicon-minus" aria-hidden="true" ng-if="$index>0 || rlist.length>1" ng-click="delete($index)"></i> <i class="glyphicon glyphicon-plus" aria-hidden="true" ng-if="$index+1 == rlist.length" ng-click="rlist.push({})"></i> </td> </tr> <tr> <td colspan="2" style="border: 1px solid #ddd; height:20px;line-height: 34px;font-weight: 600" class="text-center">付款金额合计</td> <td style="border: 1px solid #ddd; height:34px;line-height: 20px; padding: 6px 12px" class="text-right">{{reduce(rlist)}}</td> </tr> </tbody> </table> </div> </div> <div class="row"> <span class="required">付款凭证</span> <div class="form-group" style="max-width: 600px"> <span class="btn btn-default" style="position: relative"> 上传文件 <input type="file" nv-file-select="" uploader="uploader1" title="上传文件" multiple style="position: absolute;top: 0;left: 0;bottom: 0;right: 0;opacity: 0;width: 100%"> </span> <div class="img-container clearfix"> <img ng-repeat="img in imgs" ng-src="{{img}}" additional="?x-oss-process=image/resize,m_lfit,h_75,w_100" alt="" pic-view pic-delete="imgs.splice({{$index}},1)"> </div> </div> </div> <div class="row"> <span style="width: 90px;padding-left:30px">备注</span> <div class="form-group"></div> <textarea cols="100" rows="3" ng-model="Remark"></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="save()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/recharge_apply_ro_modal.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">充值申请</h3> </div> <div class="modal-body form-inline recharge-modal"> <div class="row"> <span class="required">充值金额</span> <div class="form-group" style="padding: 6px 12px;display: inline-block"> <span style="vertical-align: middle">{{rAmount}}元</span> </div> </div> <div class="row"> <span class="required">付款明细</span> <div class="form-group"> <table class="table table-hover table-bordered" style="width:500px"> <thead> <tr class="info"> <th>*付款账户</th> <th>*付款时间</th> <th>*付款金额（元）</th> </tr> </thead> <tbody> <tr ng-repeat="rg in rlist"> <td style="height:34px;line-height: 20px; padding: 6px 12px">{{rg.AccountOfPayment}}</td> <td style="height:34px;line-height: 20px; padding: 6px 12px">{{rg.PayTime|date:\'yyyy-MM-dd\'}}</td> <td class="text-right" style="height:34px;line-height: 20px; padding: 6px 12px">{{rg.Amount}}</td> </tr> <tr> <td colspan="2" style="height:20px;line-height: 34px;font-weight: 600" class="text-center">付款金额合计</td> <td style="height:34px;line-height: 20px; padding: 6px 12px" class="text-right">{{reduce(rlist)}}</td> </tr> </tbody> </table> </div> </div> <div class="row"> <span class="required">付款凭证</span> <div class="form-group" style="max-width: 600px"> <div class="img-container clearfix"> <img ng-repeat="img in imgs" ng-src="{{img}}" additional="?x-oss-process=image/resize,m_lfit,h_75,w_100" alt="" pic-view> </div> </div> </div> <div class="row"> <span style="width: 90px;padding-left:30px">备注</span> <div class="form-group"></div> <textarea cols="100" rows="3" ng-model="Remark" readonly></textarea> </div> </div> <div class="modal-footer"> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/rejectModal.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">驳回</h3> </div> <div class="modal-body clearfix"> <div>驳回原因</div> <textarea ng-model="item.reason" cols="60" rows="10"></textarea> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/review.html",'<div class="o-list"> <h2> {{::title||"订单审核"}} </h2> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <label>代理商</label>： <input type="text" ng-model="channel" typeahead-min-length="0" uib-typeahead="agent as agent.ChannelName for agent in agents | filter:$viewValue | limitTo:8" class="form-control"> \x3c!-- <select ng-model="channelId" class="form-control">\n                    <option value="" ng-selected="true">全部</option>\n                    <option ng-repeat="item in agents" ng-value="item.ChannelId" ng-selected="false" ng-bind="item.ChannelName"></option>\n                </select> --\x3e </div> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="sdateIsOpened" datepicker-options="sdateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="sdateIsOpened = !sdateIsOpened" ng-change="setMinDate()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="sdateIsOpened = !sdateIsOpened"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="enddate" is-open="edateIsOpened" datepicker-options="edateOptions" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="edateIsOpened = !edateIsOpened"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="edateIsOpened = !edateIsOpened"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <button type="button" class="btn btn-primary" ng-click="searchFn()">查询</button> <button class="btn btn-default" ng-click="reset()">重置</button> </form> </div> <div class="o-body"> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th>序号</th> <th ng-repeat="head in headers" ng-bind="head"></th> <th>礼包</th> <th>活动</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="row in data"> <td ng-bind="$index+1"></td> <td ng-repeat="col in row.cols  track by $index" ng-bind-html="col"></td> <td> <span ng-if="row.GiftTypeId">{{::(row.GiftTypeName + \'(￥\' + row.GiftPrice + \')\') }}</span></td> <td>{{::row.PromotionName}}</td> <td> <div class="operate" ng-if="row.Status == 1"> <a href="javascript:;" ng-click="view(row.OrderId,false)">查看</a> <a href="javascript:;" ng-click="view(row.FreChangeOrderId,true)" ng-if="row.FreChangeOrderId">查看原订单</a> <a href="javascript:;" ng-click="audit(row)">通过</a> <a href="javascript:;" ng-click="back(row.OrderId)">驳回</a> </div> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> \x3c!-- <uib-pagination total-items="totalItems" ng-model="currentPage" max-size="5" items-per-page="pageSize" previous-text="&lsaquo;" next-text="&rsaquo;" first-text="&laquo;" last-text="&raquo;" ng-change="pageChanged()" rotate="true" style="margin: -10px auto"></uib-pagination>\n --\x3e </div> </div>'),a.put("views/setDiscount.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">设置折扣</h3> </div> <div class="modal-body clearfix"> <input type="text" class="form-control" ng-model="discount"> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/setFetation.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">设置是否可以添加代理</h3> </div> <div class="modal-body clearfix"> <label> <input type="radio" ng-model="isFetation" ng-value="1"> 是 </label><br> <label> <input type="radio" ng-model="isFetation" ng-value="0"> 否 </label> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/setGift.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">设置礼包</h3> </div> <div class="modal-body clearfix"> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th>礼包类型</th> <th>客户类型</th> <th>价格</th> <th>数量</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="row in data"> <td>{{::row.GiftTypeName}}</td> <td>{{::row.AddedValue|filterAddValue}}</td> <td class="text-right">{{::row.Price}}</td> <td>{{::row.Num}}</td> <td><a href="javascript:;" ng-click="delete(row)">删除</a></td> </tr> </tbody> </table> <div class="form-inline addGift"> <select ng-model="gift.GiftTypeId" class="form-control"> <option value="{{::option.Id}}" ng-repeat="option in giftTypes track by option.Id">{{::option.GiftTypeName}}</option> </select> <select ng-model="gift.AddedValue" class="form-control"> <option value="1">小规模</option> <option value="2">一般纳税人</option> </select> <input type="text" class="form-control" ng-model="gift.Price" placeholder="价格"> <input type="text" class="form-control" ng-model="gift.Num" placeholder="数量"> <button class="btn btn-primary" ng-click="save()">增加</button> </div> </div> <div class="modal-footer"> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/setProm.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">设置活动</h3> </div> <div class="modal-body clearfix"> <table class="table table-striped table-bordered table-hover"> <thead> <tr class="info"> <th>活动名称</th> <th>数量</th> <th>开始日期</th> <th>结束日期</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="row in data"> <td>{{::row.PromotionName}}</td> <td class="text-right">{{::row.Num}}</td> <td>{{::row.StartDate|tDate}}</td> <td>{{::row.EndDate|tDate}}</td> <td><a href="javascript:;" ng-click="delete(row)">删除</a></td> </tr> </tbody> </table> <div class="form-inline addGift"> <select ng-model="prom.PromotionId" class="form-control"> <option value="{{::option.Id}}" ng-repeat="option in promTypes track by option.Id">{{::option.Name}}</option> </select> <input type="text" class="form-control" ng-model="prom.Num" placeholder="数量"> <span class="date_sel"> <input type="text" uib-datepicker-popup ng-model="prom.StartDate" is-open="dateIsOpened1" datepicker-options="dateOptions" close-text="关闭" current-text="今天" clear-text="清空" ng-click="dateIsOpened1 = !dateIsOpened1"> <button type="button" ng-click="dateIsOpened1 = !dateIsOpened1"><i class="glyphicon glyphicon-calendar"></i></button> </span> <span class="date_sel"> <input type="text" uib-datepicker-popup ng-model="prom.EndDate" is-open="dateIsOpened2" datepicker-options="dateOptions" close-text="关闭" current-text="今天" clear-text="清空" ng-click="dateIsOpened2 = !dateIsOpened2"> <button type="button" ng-click="dateIsOpened2 = !dateIsOpened2"><i class="glyphicon glyphicon-calendar"></i></button> </span> <button class="btn btn-primary" ng-click="save()">增加</button> </div> </div> <div class="modal-footer"> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/statisAchieve.html",'<div class="statis-achieve o-list"> <h2>业绩统计</h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="form-group"> <span>代理商状态</span> <select class="form-control" ng-model="params.status"> <option value="">全部</option> <option value="1">正常</option> <option value="0">解约</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> <th rowspan="2">省</th> <th rowspan="2">市</th> <th rowspan="2">一级代理商</th> <th rowspan="2">二级代理商</th> <th rowspan="2">代理商状态</th> <th colspan="4" class="text-center">订单数量</th> <th colspan="4" class="text-center">应收</th> <th colspan="4" class="text-center">实收</th> </tr> <tr class="info"> <th>零申报</th> <th>小规模</th> <th>一般纳税人</th> <th>小计</th> <th>零申报</th> <th>小规模</th> <th>一般纳税人</th> <th>小计</th> <th>零申报</th> <th>小规模</th> <th>一般纳税人</th> <th>小计</th> </tr> <tr> <th colspan="5">合计</th> <th class="text-right">{{aOrderNumZero}}</th> <th class="text-right">{{aOrderNumSmall}}</th> <th class="text-right">{{aOrderNumGeneral}}</th> <th class="text-right">{{aOrderNumHJ}}</th> <th class="text-right">{{aYSZero}}</th> <th class="text-right">{{aYSSmall}}</th> <th class="text-right">{{aYSGeneral}}</th> <th class="text-right">{{aYSHJ}}</th> <th class="text-right">{{aSSZero}}</th> <th class="text-right">{{aSSSmall}}</th> <th class="text-right">{{aSSGeneral}}</th> <th class="text-right">{{aSSHJ}}</th> </tr> </thead> <tbody> <tr ng-repeat="item in tableData"> <td style="text-align:center; width:200px">{{item.ProvinceName}}</td> <td style="text-align:center; width:120px">{{item.CityName}}</td> <td style="text-align:center; width:120px">{{item.ChannelName1}}</td> <td style="text-align:center; width:120px">{{item.ChannelName2}}</td> <td style="text-align:center; width:120px">{{item.Status | filterStatus}}</td> <td style="text-align:center; width:200px">{{item.OrderNumZero}}</td> <td style="text-align:center; width:120px">{{item.OrderNumSmall}}</td> <td style="text-align:center; width:120px">{{item.OrderNumGeneral}}</td> <td style="text-align:center; width:120px">{{item.OrderNumHJ}}</td> <td style="text-align:center; width:120px">{{item.YSZero}}</td> <td style="text-align:center; width:120px">{{item.YSSmall}}</td> <td style="text-align:center; width:120px">{{item.YSGeneral}}</td> <td style="text-align:center; width:120px">{{item.YSHJ}}</td> <td style="text-align:center; width:120px">{{item.SSZero}}</td> <td style="text-align:center; width:200px">{{item.SSSmall}}</td> <td style="text-align:center; width:120px">{{item.SSGeneral}}</td> <td style="text-align:center; width:120px">{{item.SSHJ}}</td> </tr> </tbody> </table> </div> </div> </div>'),a.put("views/statisCompanyType.html",'<div class="o-list"> <h2>小规模转为一般纳税人统计</h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="form-group"> <span>代理商状态</span> <select class="form-control" ng-model="params.status"> <option value="">全部</option> <option value="1">正常</option> <option value="0">解约</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>代理商状态</th> <th>小规模数量</th> <th>转为一般纳税人数量</th> </tr> <tr> <th colspan="5">合计</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn1()">{{alittlenum}}</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn2()">{{aformalnum}}</th> </tr> </thead> <tbody> <tr ng-repeat="item in tableData"> <td style="text-align:center; width:100px">{{item.ProvinceName}}</td> <td style="text-align:center; width:100px">{{item.CityName}}</td> <td style="text-align:center; width:200px">{{item.ChannelName1}}</td> <td style="text-align:center; width:200px">{{item.ChannelName2}}</td> <td style="text-align:center; width:120px">{{item.Status | filterStatus}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn1(item)">{{item.littlenum}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn2(item)">{{item.formalnum}}</td> </tr> </tbody> </table> </div> </div> </div>'),
a.put("views/statisNewCustomers.html",'<div class="statis-customers o-list"> <h2>新增客户统计</h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="form-group"> <span>代理商状态</span> <select class="form-control" ng-model="params.status"> <option value="">全部</option> <option value="1">正常</option> <option value="0">解约</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> <th rowspan="2">省</th> <th rowspan="2">市</th> <th rowspan="2">一级代理商</th> <th rowspan="2">二级代理商</th> <th rowspan="2">代理商状态</th> <th colspan="4" class="text-center">新增客户数</th> <th rowspan="2" class="text-center">新增客户金额</th> <th rowspan="2" class="text-center">新增零申报金额</th> </tr> <tr class="info"> <th>零申报</th> <th>小规模</th> <th>一般纳税人</th> <th>小计</th> </tr> <tr> <th colspan="5">合计</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn1()">{{aZeroNum}}</th> <th class="text-right">{{aSmallNum}}</th> <th class="text-right">{{aNormalNum}}</th> <th class="text-right">{{aCustomerNum}}</th> <th class="text-right">{{aContractAmount}}</th> <th class="text-right">{{aZeroAmount}}</th> </tr> </thead> <tbody> <tr ng-repeat="item in tableData"> <td style="text-align:center; width:200px">{{item.ProvinceName}}</td> <td style="text-align:center; width:120px">{{item.CityName}}</td> <td style="text-align:center; width:120px">{{item.ChannelName1}}</td> <td style="text-align:center; width:120px">{{item.ChannelName2}}</td> <td style="text-align:center; width:120px">{{item.Status | filterStatus}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn1(item)">{{item.ZeroNum}}</td> <td style="text-align:center; width:120px">{{item.SmallNum}}</td> <td style="text-align:center; width:120px">{{item.NormalNum}}</td> <td style="text-align:center; width:120px">{{item.CustomerNum}}</td> <td style="text-align:center; width:200px">{{item.ContractAmount}}</td> <td style="text-align:center; width:120px">{{item.ZeroAmount}}</td> </tr> </tbody> </table> </div> </div> </div>'),a.put("views/statisOrders.html",'<div class="statis-orders o-list"> <h2>订单统计</h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="form-group"> <span>代理商状态</span> <select class="form-control" ng-model="params.status"> <option value="">全部</option> <option value="1">正常</option> <option value="0">解约</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> <th rowspan="2">省</th> <th rowspan="2">市</th> <th rowspan="2">一级代理商</th> <th rowspan="2">二级代理商</th> <th rowspan="2">代理商状态</th> <th colspan="4" class="text-center">套餐类型</th> <th colspan="2" class="text-center">订单类型</th> <th colspan="2" class="text-center">订单性质</th> <th colspan="4" class="text-center">客户类型</th> </tr> <tr class="info"> <th>零税半年版</th> <th>季度版</th> <th>半年版</th> <th>一年版</th> <th>预提单</th> <th>正式订单</th> <th>新签订单数</th> <th>续费订单数</th> <th>零申报</th> <th>小规模</th> <th>一般纳税人</th> <th>小计</th> </tr> <tr> <th colspan="5">合计</th> <th class="text-right">{{aZeroYearNum}}</th> <th class="text-right">{{aQuarterNum}}</th> <th class="text-right">{{aHalfYearNum}}</th> <th class="text-right">{{aYearNum}}</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn1()">{{aReserveNum}}</th> <th class="text-right">{{aFormalNum}}</th> <th class="text-right">{{aNewNum}}</th> <th class="text-right">{{aReNum}}</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn2()">{{aZeroNum}}</th> <th class="text-right">{{aSmallNum}}</th> <th class="text-right">{{aNormalNum}}</th> <th class="text-right">{{aTotalNum}}</th> </tr> </thead> <tbody> <tr ng-repeat="item in tableData"> <td style="text-align:center; width:200px">{{item.ProvinceName}}</td> <td style="text-align:center; width:120px">{{item.CityName}}</td> <td style="text-align:center; width:120px">{{item.ChannelName1}}</td> <td style="text-align:center; width:120px">{{item.ChannelName2}}</td> <td style="text-align:center; width:120px">{{item.Status | filterStatus}}</td> <td style="text-align:center; width:200px">{{item.ZeroYearNum}}</td> <td style="text-align:center; width:120px">{{item.QuarterNum}}</td> <td style="text-align:center; width:120px">{{item.HalfYearNum}}</td> <td style="text-align:center; width:120px">{{item.YearNum}}</td> <td style="text-align:center; width:120px; text-decoration: underline; color: blue" ng-click="downloadColumn1(item)">{{item.ReserveNum}}</td> <td style="text-align:center; width:200px">{{item.FormalNum}}</td> <td style="text-align:center; width:120px">{{item.NewNum}}</td> <td style="text-align:center; width:120px">{{item.ReNum}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn2(item)">{{item.ZeroNum}}</td> <td style="text-align:center; width:120px">{{item.SmallNum}}</td> <td style="text-align:center; width:120px">{{item.NormalNum}}</td> <td style="text-align:center; width:120px">{{item.TotalNum}}</td> </tr> </tbody> </table> </div> </div> </div>'),a.put("views/statisOutwork.html",'<div class="statis-orders o-list"> <h2>外勤情况统计</h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="form-group"> <span>代理商状态</span> <select class="form-control" ng-model="params.status"> <option value="">全部</option> <option value="1">正常</option> <option value="0">解约</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>代理商状态</th> <th>预提单数</th> <th>外勤总任务数量</th> <th>总任务待分配</th> <th>总任务待处理</th> <th>总任务进行中</th> <th>总任务已完成</th> <th>总任务已取消</th> <th>子任务总数量</th> <th>子任务待分配</th> <th>子任务待处理</th> <th>子任务进行中</th> <th>子任务已完成</th> <th>子任务已取消</th> </tr> <tr> <th colspan="5">合计</th> <th class="text-right">{{aordernum}}</th> <th class="text-right">{{aallmainnum}}</th> <th class="text-right">{{amainnum1}}</th> <th class="text-right">{{amainnum2}}</th> <th class="text-right">{{amainnum3}}</th> <th class="text-right">{{amainnum4}}</th> <th class="text-right">{{amainnum5}}</th> <th class="text-right">{{aallchildnum}}</th> <th class="text-right">{{achildnum1}}</th> <th class="text-right">{{achildnum2}}</th> <th class="text-right">{{achildnum3}}</th> <th class="text-right">{{achildnum4}}</th> <th class="text-right">{{achildnum5}}</th> </tr> </thead> <tbody> <tr ng-repeat="item in tableData"> <td style="text-align:center; width:200px">{{item.ProvinceName}}</td> <td style="text-align:center; width:120px">{{item.CityName}}</td> <td style="text-align:center; width:120px">{{item.ChannelName1}}</td> <td style="text-align:center; width:120px">{{item.ChannelName2}}</td> <td style="text-align:center; width:120px">{{item.Status | filterStatus}}</td> <td style="text-align:center; width:200px">{{item.ordernum}}</td> <td style="text-align:center; width:120px; text-decoration: underline; color: blue" ng-click="downloadColumn1(item)">{{item.allmainnum}}</td> <td style="text-align:center; width:120px">{{item.mainnum1}}</td> <td style="text-align:center; width:120px">{{item.mainnum2}}</td> <td style="text-align:center; width:120px">{{item.mainnum3}}</td> <td style="text-align:center; width:200px">{{item.mainnum4}}</td> <td style="text-align:center; width:120px">{{item.mainnum5}}</td> <td style="text-align:center; width:120px; text-decoration: underline; color: blue" ng-click="downloadColumn2(item)">{{item.allchildnum}}</td> <td style="text-align:center; width:100px">{{item.childnum1}}</td> <td style="text-align:center; width:120px">{{item.childnum2}}</td> <td style="text-align:center; width:120px">{{item.childnum3}}</td> <td style="text-align:center; width:120px">{{item.childnum4}}</td> <td style="text-align:center; width:120px">{{item.childnum5}}</td> </tr> </tbody> </table> </div> </div> </div>'),a.put("views/statisRenew.html",'<div class="statis-renew o-list"> <h2>续费情况统计</h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <label>年份</label> <select class="form-control" ng-model="params.year"> <option value="2018">2018</option> <option value="2017">2017</option> <option value="2016">2016</option> </select> </div> <div class="btn-group" uib-dropdown> <label style="line-height: 34px">结束账期</label> <select class="form-control" ng-model="params.months"> <option ng-repeat="month in months" value="{{month.value}}" ng-selected="month.value == params.months">{{month.label}}</option> </select> </div> <div class="form-group"> <span>代理商状态</span> <select class="form-control" ng-model="params.status"> <option value="">全部</option> <option value="1">正常</option> <option value="0">解约</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>代理商状态</th> <th>到期客户数</th> <th>未续费客户数</th> <th>已续费客户数</th> </tr> <tr> <th colspan="5">合计</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn1()">{{aExpireNum}}</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn2()">{{aNoReNum}}</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn3()">{{aReNum}}</th> </tr> </thead> <tbody> <tr ng-repeat="item in tableData"> <td style="text-align:center; width:100px">{{item.ProvinceName}}</td> <td style="text-align:center; width:100px">{{item.CityName}}</td> <td style="text-align:center; width:200px">{{item.ChannelName1}}</td> <td style="text-align:center; width:200px">{{item.ChannelName2}}</td> <td style="text-align:center; width:120px">{{item.Status | filterStatus}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn1(item)">{{item.ExpireNum}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn2(item)">{{item.NoReNum}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn3(item)">{{item.ReNum}}</td> </tr> </tbody> </table> </div> </div> </div>'),a.put("views/statisYtOdersTozsOders.html",'<div class="statis-ytorders o-list"> <h2>预提单转正式订单统计</h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="form-group"> <span>代理商状态</span> <select class="form-control" ng-model="params.status"> <option value="">全部</option> <option value="1">正常</option> <option value="0">解约</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>代理商状态</th> <th>预提单数量</th> <th>转为正式订单数量</th> </tr> <tr> <th colspan="5">合计</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn1()">{{aytdcount}}</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn2()">{{azzscount}}</th> </tr> </thead> <tbody> <tr ng-repeat="item in tableData"> <td style="text-align:center; width:100px">{{item.ProvinceName}}</td> <td style="text-align:center; width:100px">{{item.CityName}}</td> <td style="text-align:center; width:200px">{{item.ChannelName1}}</td> <td style="text-align:center; width:200px">{{item.ChannelName2}}</td> <td style="text-align:center; width:120px">{{item.Status | filterStatus}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn1(item)">{{item.ytdcount}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn2(item)">{{item.zzscount}}</td> </tr> </tbody> </table> </div> </div> </div>'),a.put("views/statisZeroTonoZero.html",'<div class="o-list"> <h2>零申报转非零申报统计</h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <div class="form-group"> <span>代理商状态</span> <select class="form-control" ng-model="params.status"> <option value="">全部</option> <option value="1">正常</option> <option value="0">解约</option> </select> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>代理商状态</th> <th>零申报数量</th> <th>转小规模数量</th> <th>转一般纳税人数量</th> </tr> <tr> <th colspan="5">合计</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn1()">{{azeronum}}</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn2()">{{alittlenum}}</th> <th style="text-align:center; text-decoration: underline; color: blue" ng-click="downloadColumn3()">{{aformalnum}}</th> </tr> </thead> <tbody> <tr ng-repeat="item in tableData"> <td style="text-align:center; width:100px">{{item.ProvinceName}}</td> <td style="text-align:center; width:100px">{{item.CityName}}</td> <td style="text-align:center; width:200px">{{item.ChannelName1}}</td> <td style="text-align:center; width:200px">{{item.ChannelName2}}</td> <td style="text-align:center; width:120px">{{item.Status | filterStatus}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn1(item)">{{item.zeronum}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn2(item)">{{item.littlenum}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn3(item)">{{item.formalnum}}</td> </tr> </tbody> </table> </div> </div> </div>'),a.put("views/statis_paytype.html",'<div class="m-achieve"> <h2> 签单类型统计 </h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <div class="input-group"> <input type="text" class="form-control" uib-datepicker-popup ng-model="startdate" is-open="dateIsOpenedS" datepicker-options="dateOptions1" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedS = !dateIsOpenedS" ng-change="startChange()"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedS = !dateIsOpenedS"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> — </div> <div class="form-group"> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> </form> </div> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead> <tr class="info"> <th>城市</th> <th>一级渠道</th> <th>二级渠道</th> <th ng-repeat="pn in priceNames">{{pn}}</th> </tr> </thead> <tbody> <tr ng-repeat="(key,row) in rows"> <td>{{row.CityName}}</td> <td>{{row.ChannelName1}}</td> <td>{{row.ChannelName2}}</td> <td ng-repeat="pn in priceNames" class="text-right">{{row[pn]}}</td> </tr> <tr> <td colspan="3">合计 </td><td ng-repeat="pn in priceNames" class="text-right">{{total[pn]||0}}</td> </tr> </tbody> </table> </div> </div>'),a.put("views/statis_proportion_c.html",'<div class="recharge"> <h2 class="clearfix ng-binding">订单占比分析</h2> <uib-tabset active="active" style="margin-top: 6px"> <uib-tab index="1" heading="预提单与正式订单占比"> <div style="padding: 6px 12px"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <select class="form-control" ng-model="search2.year"> <option value="2017">2017</option> <option value="2016">2016</option> </select> <label>年</label> </div> <div class="btn-group" uib-dropdown> <button id="single-button" type="button" class="btn form-control multiselect-button" uib-dropdown-toggle ng-disabled="disabled"> <span ng-bind="params2.selectedText" style="min-width: 60px;display: inline-block"></span> <span class="caret"></span> </button> <ul class="dropdown-menu dropdown-menu-multiselect" uib-dropdown-menu role="menu" aria-labelledby="single-button" ng-click=" $event.stopPropagation();"> <li role="menuitem" ng-repeat="month in months2"> <label ng-click="params2.setSelectedText()"> <input type="checkbox" ng-model="month.selected" ng-value="true">{{::month.label}}</label> </li> </ul> <label style="line-height: 34px">月</label> </div> <button type="button" class="btn btn-primary" ng-click="tab2Search()" style="margin-left:20px">查询</button> <button type="button" class="btn btn-primary" ng-click="dataExport2()" style="margin-left:20px">导出</button> </form> </div> <div> <line-chart config="chart2.config" data="chart2.data"></line-chart> </div> <table class="table table-striped table-hover table-bordered" id="table2"> <thead> <tr class="info"> <th>月</th> <th>大区</th> <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>预提单数量</th> <th>预提单占比</th> <th>正式订单数量</th> <th>正式订单数占比</th> </tr> </thead> <tbody> <tr ng-repeat="item in data2"> <td>{{::item.currMonth}}月</td> <td>{{::item.PartitionName}}</td> <td>{{::item.ProvinceName}}</td> <td>{{::item.CityName}}</td> <td>{{::item.ChannelName1}}</td> <td>{{::item.ChannelName2}}</td> <td>{{::item.preOrderNum}}</td> <td>{{::item.preOrderRate}}</td> <td>{{::item.zsNum}}</td> <td>{{::item.zsRate}}</td> </tr> </tbody> <tfoot> <tr ng-if="data2.length != 0"> <td colspan="6">合计</td> <td>{{total2.SumPreNum}}</td> <td>{{total2.SumPreRate}}</td> <td>{{total2.SumZsNum}}</td> <td>{{total2.SumZsRate}}</td> </tr> <tr align="center" ng-if="data2.length === 0"> <td colspan="10">暂无数据</td> </tr> </tfoot> </table> </div> </uib-tab> <uib-tab index="0" heading="续费订单占比"> <div style="padding: 6px 12px"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <label>年</label> <select class="form-control" ng-model="search1.year"> <option value="2017">2017</option> <option value="2016">2016</option> </select> </div> <div class="form-group"> <label>到期月份</label> <select class="form-control" ng-model="search1.months"> <option value="">请选择</option> <option ng-repeat="item in months" value="{{item.value}}">{{::item.label}}月</option> </select> </div> \x3c!-- <div class="btn-group" uib-dropdown> --\x3e \x3c!-- <button id="single-button" type="button" class="btn form-control multiselect-button" uib-dropdown-toggle ng-disabled="disabled">\r\n                <span ng-bind="params.selectedText" style="min-width: 60px;display: inline-block;"></span> <span class="caret"></span>\r\n              </button> --\x3e \x3c!-- <ul class="dropdown-menu dropdown-menu-multiselect" uib-dropdown-menu role="menu" aria-labelledby="single-button" ng-click=" $event.stopPropagation();">\r\n                <li role="menuitem" ng-repeat="month in months">\r\n                  <label ng-click="params.setSelectedText()">\r\n                    <input type="checkbox" ng-model="month.selected" class="form-control" ng-value="true">{{::month.label}}</label>\r\n                </li>\r\n              </ul> --\x3e \x3c!-- <label style="line-height: 34px;">月</label>\r\n            </div> --\x3e <button type="button" class="btn btn-primary" ng-click="tab1Search()" style="margin-left:20px">查询</button> <button type="button" class="btn btn-primary" ng-click="dataExport1()" style="margin-left:20px">导出</button> <button type="button" class="btn btn-primary" ng-click="export()" style="margin-left:20px">续费明细下载</button> </form> </div> \x3c!-- <div style="width:800px;height: 400px;">\r\n          <line-chart config="chart1.config" data="chart1.data" style="width:800px;height: 400px;"></line-chart>\r\n        </div> --\x3e <table class="table table-striped table-hover table-bordered" id="table1"> <thead> <tr class="info"> <th>月</th> <th>大区</th> <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>续费订单数</th> <th>到期订单数</th> <th>续费占比</th> </tr> </thead> <tbody> <tr ng-repeat="item in data1"> <td>{{::item.Months}}月</td> <td>{{::item.PartitionName}}</td> <td>{{::item.ProvinceName}}</td> <td>{{::item.CityName}}</td> <td>{{::item.ChannelName1}}</td> <td>{{::item.ChannelName2}}</td> <td>{{::item.ReNum}}</td> <td>{{::item.OrderNum||0}}</td> <td>{{::item.reNumRate}}</td> </tr> </tbody> <tfoot> <tr ng-if="data1.length != 0 && data1"> <td colspan="6">合计</td> <td>{{total1.SumReNum}}</td> <td>{{total1.SumOrderNum||0}}</td> <td>{{total1.allreRate}}</td> </tr> <tr align="center" ng-if="data1.length === 0 || !data1"> <td colspan="9">暂无数据</td> </tr> </tfoot> </table> </div> </uib-tab> </uib-tabset> </div>'),a.put("views/summit_modal.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h4 class="modal-title">提示</h4> </div> <div class="modal-body form-inline addorder2-modal"> <div class="row"> <span class="href-style">{{alertMsg}}</span> </div> </div> <div class="modal-footer" ng-show="!sign"> <button class="btn btn-warning" type="button" ng-disabled="applyForm.$invalid" ng-click="submit()">确定提交</button> <button class="btn btn-primary" type="button" ng-click="cancel()">返回修改</button> </div> <div class="modal-footer" ng-show="sign"> <button class="btn btn-warning" type="button" ng-click="cancel()">确定</button> </div>'),a.put("views/updateOrganize.html",'<div class="m-organize"> <div class="panel panel-info"> <div class="panel-heading">修改机构</div> <div class="panel-body"> <form class="form-horizontal" name="updateForm" ng-submit="updateOragnize()"> <div class="form-group"> <label for="inputName" class="col-sm-2 control-label"><span class="text-danger">*</span>机构名称</label> <div class="col-sm-7"> <input type="text" class="form-control" required name="name" ng-maxlength="20" id="inputName" ng-model="updateParams.DepartmentName"> </div> <div class="col-sm-3"> <div class="text-danger" ng-messages="updateForm.name.$error" ng-if="interacted(updateForm.name)"> <span ng-message="required"> 请输入用户名 </span> <span ng-message="maxlength"> 最大长度为20 </span> </div> </div> </div> <div class="form-group"> <label for="inputDesc" class="col-sm-2 control-label">机构描述</label> <div class="col-sm-7"> <textarea class="form-control" id="inputDesc" ng-maxlength="50" name="desc" ng-model="updateParams.Description"></textarea> </div> <div class="col-sm-3"> <div class="text-danger" ng-messages="updateForm.desc.$error" ng-if="interacted(updateForm.desc)"> <span ng-message="maxlength"> 最大长度为50 </span> </div> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-sm-10"> <button type="submit" class="btn btn-primary" ng-disabled="updateForm.$invalid">修改</button> <button type="button" class="btn btn-link" ng-click="dismiss();">取消</button> </div> </div> </form> </div> </div> </div>'),a.put("views/updatePswd.html",'<div class="m-password"> <div class="panel panel-primary"> <div class="panel-heading">修改密码</div> <div class="panel-body"> <form class="form-horizontal" name="updateForm" ng-submit="update()"> <div class="form-group"> <label for="oldPswd" class="col-sm-3 control-label"><span class="text-danger">*</span>旧密码</label> <div class="col-sm-5"> <input type="password" class="form-control" name="old" id="oldPswd" ng-minlength="6" required ng-model="pswdParams.Old"> </div> <div class="col-sm-4"> <div class="text-danger" ng-messages="updateForm.old.$error" ng-if="interacted(updateForm.old)"> <span ng-message="required"> 请输入密码 </span> <span ng-message="minlength"> 密码最小长度为6位 </span> </div> </div> </div> <div class="form-group"> <label for="newPswd" class="col-sm-3 control-label"><span class="text-danger">*</span>新密码</label> <div class="col-sm-5"> <input type="password" class="form-control" name="new" id="newPswd" ng-minlength="6" required ng-model="pswdParams.New"> </div> <div class="col-sm-4"> <div class="text-danger" ng-messages="updateForm.new.$error" ng-if="interacted(updateForm.new)"> <span ng-message="required"> 请输入密码 </span> <span ng-message="minlength"> 密码最小长度为6位 </span> </div> </div> </div> <div class="form-group"> <label for="confirmPswd" class="col-sm-3 control-label"><span class="text-danger">*</span>确认新密码</label> <div class="col-sm-5"> <input type="password" class="form-control" name="confirm" id="confirmPswd" compare-to="pswdParams.New" ng-minlength="6" required ng-model="pswdParams.Confirm"> </div> <div class="col-sm-4"> <div class="text-danger" ng-messages="updateForm.confirm.$error" ng-if="interacted(updateForm.confirm)"> <span ng-message="required"> 请输入密码 </span> <span ng-message="compareTo"> 与新密码不一致 </span> </div> </div> </div> <div class="form-group"> <div class="col-sm-offset-2 col-sm-10"> <button type="submit" class="btn btn-primary" ng-disabled="updateForm.$invalid">修改</button> <button type="button" class="btn btn-link" ng-click="dismiss();">取消</button> </div> </div> </form> </div> </div> </div>'),
a.put("views/updateUser.html",'<div class="m-addUser"> <h2> 修改信息 </h2> <form class="form-horizontal" name="updateForm" ng-submit="updateUser()" novalidate> <div class="form-group"> <label for="inputUserName" class="col-sm-2 control-label"><span class="text-danger">*</span>用户名</label> <div class="col-sm-2"> <input type="text" class="form-control" disabled name="userName" ng-maxlength="20" ng-model="updateParams.UserName" required id="inputUserName"> </div> <div class="col-sm-2"> <div class="text-danger" ng-messages="updateForm.userName.$error" ng-if="interacted(updateForm.userName)"> <span ng-message="required"> 请输入用户名 </span> <span ng-message="maxlength"> 最大长度为20 </span> </div> </div> <label for="inputRealName" class="col-sm-2 control-label"><span class="text-danger">*</span>真实姓名</label> <div class="col-sm-2"> <input type="text" class="form-control" name="realName" ng-model="updateParams.RealName" required id="inputRealName"> </div> <div class="col-sm-2"> <div class="text-danger" ng-messages="updateForm.realName.$error" ng-if="interacted(updateForm.realName)"> <span ng-message="required"> 请输入真实姓名 </span> </div> </div> </div> <div class="form-group"> <label for="inputEmail" class="col-sm-2 control-label"><span class="text-danger">*</span>邮箱</label> <div class="col-sm-2"> <input type="text" class="form-control" name="email" ng-model="updateParams.Email" ng-pattern="/^[^\\s@]+@[^\\s@]+\\.[^\\s@]{2,}$/" required id="inputEmail"> </div> <div class="col-sm-2"> <div class="text-danger" ng-messages="updateForm.email.$error" ng-if="interacted(updateForm.email)"> <span ng-message="required"> 请输入邮箱 </span> <span ng-message="pattern"> 邮箱格式错误 </span> </div> </div> <label for="inputPswd" class="col-sm-2 control-label">密码</label> <div class="col-sm-2"> <input type="text" class="form-control" ng-model="updateParams.Password" name="password" ng-minlength="6" id="inputPswd"> </div> <div class="col-sm-2"> <div class="text-danger" ng-messages="updateForm.password.$error" ng-if="interacted(updateForm.password)"> <span ng-message="minlength"> 密码最小长度为6位 </span> </div> </div> </div> <div class="form-group"> <label for="inputTel" class="col-sm-2 control-label"><span class="text-danger">*</span>电话</label> <div class="col-sm-2"> <input type="text" class="form-control" name="mobile" ng-model="updateParams.Mobile" ng-pattern="/(^(13\\d|14[57]|15[^4,\\D]|17[135678]|18\\d)\\d{8}|170[^346,\\D]\\d{7})$/" required id="inputTel"> </div> <div class="col-sm-2"> <div class="text-danger" ng-messages="updateForm.mobile.$error" ng-if="interacted(updateForm.mobile)"> <span ng-message="required"> 请输入手机号 </span> <span ng-message="pattern"> 手机格式不正确 </span> </div> </div> <label for="inputRole" class="col-sm-2 control-label"><span class="text-danger">*</span>角色</label> <div class="col-sm-2"> <select class="form-control" id="inputRole" ng-change="setUpdateParams(\'role\')" ng-model="selectedRole" ng-options="role.RoleName for role in rolesModel "> </select> </div> <div class="col-sm-2"> </div> </div> <div class="form-group" ng-if="selectedRole.RoleName === \'渠道经理\'"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>负责大区</label> <div class="col-sm-2"> <select class="form-control" ng-model="updateParams.ChannelPartitionId"> <option ng-repeat="fq in fqs" value="{{fq.Id}}" ng-bind="fq.PartitionName"></option> </select> </div> </div> <div class="form-group"> <label class="col-sm-2 control-label"><span class="text-danger">*</span>选择模块</label> <div class="col-sm-4"> <div class="tree-container"> <treecontrol class="tree-light" tree-model="functionModel" options="functionTreeOptions" on-selection="setSelectedTree(node)" selected-nodes="selectedFunction"> <span ng-class="{\'selectd\': node.selectd}">{{::node.name}}</span> </treecontrol> </div> </div> <label class="col-sm-2 control-label"><span class="text-danger">*</span>选择组织</label> <div class="col-sm-4"> <div class="tree-container"> <treecontrol class="tree-light" tree-model="organizeModel" options="organizeTreeOptions" on-selection="setOrganize(node)" selected-node="selectedOrganize"> <span ng-class="{\'selectd\': selectedOrganize.DepartmentId === node.DepartmentId}">{{::node.DepartmentName}}</span> </treecontrol> </div> </div> </div> \x3c!--<div class="form-group">\n\n            <label for="inputCenter" class="col-sm-2 control-label">是否中心</label>\n            <div class="col-sm-2">\n                <select class="form-control" id="inputCenter" ng-change="setUpdateParams(\'center\')" ng-model="selectedCenter" ng-options="center.name for center in centerModel ">\n                </select>\n            </div>\n            <div class="col-sm-2">\n\n            </div>\n\n            <label for="inputDep" class="col-sm-2 control-label">部门</label>\n            <div class="col-sm-2">\n                <input type="text" class="form-control" ng-model="updateParams.DepartmentId"  id="inputDep" disabled>\n            </div>\n            <div class="col-sm-2">\n\n            </div>\n        </div>--\x3e <div class="form-group text-center"> <button type="submit" class="btn btn-primary" ng-disabled="updateForm.$invalid">修改</button> <button type="reset" class="btn btn-default">重置</button> <a class="btn btn-default" ui-sref="main.users.usersList">返回</a> </div> </form> </div>'),a.put("views/userPassword.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">添加/修改代理商</h3> </div> <div class="modal-body clearfix"> <div ng-class="padding"> <form class="form-inline agform" ng-class="{submited:submited}" name="agForm" novalidate ng-submit="ok()" ng-init="$parent.agForm = agForm"> <div class="form-group col-md-12"> <label for="" class="required">中心用户名</label> <input type="text" name="userName" ng-pattern="/^[@a-zA-Z0-9_\\u4e00-\\u9fa5]+$/" ng-model="item.UserName" required> <span class="text-danger" ng-messages="agForm.userName.$error"> <i ng-message="pattern"> 请输入汉字数字字母或者下划线的任意组合 </i> </span> </div> <div class="form-group col-md-12"> <label for="" class="required">密码</label> <input type="text" ng-model="item.PassWrod" required> </div> </form> </div> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">通过</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/user_outworker.html",'<div class="recharge"> <h2 class="clearfix"> 外勤人员管理 </h2> <div class="well well-sm u-search clearfix"> <button class="btn btn-primary pull-right" ng-click="open()">新增外勤</button> </div> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>姓名</th> <th>联系电话</th> <th>是否主管</th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="outworker in outworkers"> <td>{{outworker.Name}}</td> <td>{{outworker.Phone}}</td> <td>{{outworker.IsCharge|YesOrNo}}</td> <td class="table-opt"> <a href="javascript:;" ng-click="open(outworker)">查看</a> <a href="javascript:;" ng-click="delete(outworker)">删除</a> </td> </tr> </tbody> </table> </div>'),a.put("views/user_outworker_view.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">{{::title}}</h3> </div> <div class="modal-body"> <form name="cusform" novalidate class="form-inline"> <div class="clearfix" style="width:80%"> <div class="form-group col-md-6" style="margin: 12px 0"> <label for="" class="required">姓名</label> <input type="text" class="form-control" ng-model="postData.Name" required> </div> <div class="form-group col-md-6" style="margin: 12px 0"> <label for="" class="required">联系电话</label> <input type="text" class="form-control" ng-model="postData.Phone" required> </div> <div class="form-group col-md-6" style="margin: 12px 0"> <label>是否主管</label> <select ng-model="postData.IsCharge" class="form-control"> <option ng-value="0" ng-selected="postData.IsCharge != 1">否</option> <option ng-value="1" ng-selected="postData.IsCharge == 1">是</option> </select> </div> </div> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-disabled="cusform.$invalid" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/users.html",'<div class="m-users clearfix"> <div class="m-group"> <h2> 组织结构 </h2> <div class="u-group-btns"> <button class="btn btn-sm btn-primary" type="button" ng-click="addOragnize();">新增</button> \x3c!--<div class="dropdown">\n                <button class="btn btn-sm btn-primary" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">\n                    新增\n                    <span class="caret"></span>\n                </button>\n                <ul class="dropdown-menu" aria-labelledby="dLabel">\n                    <li>\n                        <a href="javascript:void(0)" ng-click="addOragnize();">节点</a>\n                        <a href="javascript:void(0)" ng-click="addOragnize(\'root\');">根节点</a>\n                    </li>\n                </ul>\n            </div>--\x3e <button class="btn btn-sm btn-info" type="button" ng-click="updateOragnize();">修改</button> <button class="btn btn-sm btn-danger" type="button" ng-click="delOragnize()">删除</button> </div> <div class="u-group-container"> <treecontrol class="tree-light" tree-model="organizeTreeModel" options="organizeTreeOptions" on-selection="selectedNodeChange(node)" expanded-nodes="expandNodes" selected-node="selectedOrganizeTree"> <span>{{node.DepartmentName}}</span> </treecontrol> </div> </div> <div class="m-users-content" ui-view onload="refreshUserList()"> </div> </div>'),a.put("views/usersList.html",'<div class="u_list"> <h2> 员工列表 </h2> <div class="u-serach well well-sm"> <form class="form-inline"> <div class="form-group"> <label> 用户名 </label> <input type="text" class="form-control" ng-model="paginator.userName"> </div> <div class="form-group"> <button type="button" class="btn btn-default" ng-click="pageChanged();">查询</button> <a class="btn btn-default" ng-click="addUser()">添加用户</a> </div> </form> </div> <table class="table table-striped table-bordered table-hover table-condensed"> <thead> <tr class="info"> <th ng-repeat="head in headers" ng-bind="head"></th> <th>操作</th> </tr> </thead> <tbody> <tr ng-repeat="userItem in userItmes"> \x3c!-- <tr ng-repeat="userItem in userItmes track by userItem.UserId"> --\x3e <td> {{::userItem.UserName}} </td> <td> {{::userItem.RealName}} </td> <td> {{::userItem.Mobile}} </td> <td> {{::userItem.Email}} </td> <td> {{::userItem.RoleName}} </td> <td> {{::userItem.DepartmentName}} </td> <td><a href="javascript:;" ng-click="update(userItem)">查看/修改</a> <a href="javascript:;" ng-click="delUser(userItem.UserId)">删除</a> </td> </tr> </tbody> </table> <div class="u-paginator"> <uib-pagination total-items="paginator.total" items-per-page="paginator.perPage" boundary-links="true" ng-model="paginator.currentPage" previous-text="{{::paginator.previousText}}" next-text="{{::paginator.nextText}}" first-text="{{::paginator.firstText}}" last-text="{{::paginator.lastText}}" force-ellipses="true" max-size="6" num-pages="paginator.numPages" ng-change="pageChanged()"> </uib-pagination> <div class="u-pages"> <span>{{paginator.currentPage}}</span> / <span>{{paginator.numPages}}</span> </div> <form name="paginatorForm" novalidate> <div class="input-group"> <input type="number" name="paginatorInput" ng-model="currentPage" required min="1" max="{{paginator.numPages}}" class="form-control"> <span class="input-group-btn"> <button class="btn btn-default" type="button" ng-disabled="!paginatorForm.$valid" ng-click="setCurrentPage()">Go!</button> </span> </div> </form> </div> </div>'),a.put("views/users_addQD.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">增加渠道</h3> </div> <div class="modal-body" style="max-height: 300px; overflow: auto"> <table class="table table-striped table-hover table-bordered"> <thead> <tr class="info"> <th>选择</th> <th>渠道名称(一级)</th> <th>渠道名称(二级)</th> </tr> </thead> <tbody> <tr ng-repeat="qd in data" ng-hide="qd.hide"> <td><input type="checkbox" ng-model="qd.selected"></td> <td>{{::qd.ChannelName1}}</td> <td>{{::qd.ChannelName2}}</td> </tr> </tbody> </table> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">保存</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/users_addfq.html",'<div class="modal-header"> <span class="close" ng-click="cancel()">&times;</span> <h3 class="modal-title">增加分区</h3> </div> <div class="modal-body clearfix"> <form class="agform"> <span for="">分区名称</span> <input type="text" ng-model="name"> </form> </div> <div class="modal-footer"> <button class="btn btn-primary" type="button" ng-click="ok()">添加</button> <button class="btn btn-warning" type="button" ng-click="cancel()">关闭</button> </div>'),a.put("views/users_fq.html",'<div class="pull-left" style="width: 250px; height: 100%"> <div class="well well-sm" style="height: 100%; margin: 0"> <button class="btn btn-primary" ng-click="addFQ()">添加分区</button> <ul class="list-group" style="margin: 20px 0"> <li class="list-group-item" ng-class="{active:fq.active}" ng-click="activeFQ(fq)" ng-repeat="fq in fqs" style="cursor: pointer">{{::fq.PartitionName}} <span class="close pull-right" ng-click="deleteFQ(fq.Id);$event.stopPropagation();">&times;</span></li> </ul> </div> </div> <div style="margin:0 0 0 250px; padding: 9px"> <div class="text-right"><button class="btn btn-primary" ng-click="addQD()">添加渠道</button></div> <table class="table table-striped table-hover table-bordered" style="margin: 20px 0"> <thead> <tr class="info"> <th>渠道名称</th> \x3c!-- <th style="width: 150px;">操作</th> --\x3e </tr> </thead> <tbody> <tr ng-repeat="qd in qds"> <td>{{::qd.ChannelName}}</td> \x3c!-- <td class="table-opt"><a href="#/main/addOb/{{::customer.Id}}">修改</a>\r\n                    <a href="javascript:;" ng-click="delete(customer.Id)">删除</a>\r\n                </td> --\x3e </tr> </tbody> </table> </div>'),a.put("views/waitSetAccount.html",'<div class="m-achieve"> <h2> 待建账数据统计 </h2> <div class="table-container"> <div class="well well-sm u-search"> <form class="form-inline"> <div class="form-group"> <label>截止日期：</label> <div class="input-group"> <input class="form-control" type="text" uib-datepicker-popup ng-model="enddate" is-open="dateIsOpenedE" datepicker-options="dateOptions2" ng-required="true" close-text="关闭" current-text="今天" clear-text="清空" readonly ng-click="dateIsOpenedE = !dateIsOpenedE" style="width:120px"> <span class="input-group-btn"> <button type="button" class="btn btn-default" ng-click="dateIsOpenedE = !dateIsOpenedE"><i class="glyphicon glyphicon-calendar"></i></button> </span> </div> </div> <button type="button" class="btn btn-primary" ng-click="search()">查询</button> <button type="button" class="btn btn-primary" ng-click="toExcel()">导出</button> </form> </div> <div style="overflow: auto" js-height> <table class="table table-striped table-hover table-bordered" id="dataTable"> <thead fix-head> <tr class="info"> \x3c!-- <th>大区</th> --\x3e <th>省</th> <th>市</th> <th>一级代理商</th> <th>二级代理商</th> <th>Agent系统客户数</th> <th>未建账客户数</th> <th>未建账比率</th> <th>10天以内未建账</th> <th>10天以上未建账</th> <th>未开始账期未建账客户数</th> </tr> <tr> <th colspan="4">合计</th> <th class="text-right">{{aTotalNum}}</th> <th class="text-right">{{aUnMakeAccount}}</th> <th class="text-right"></th> <th class="text-right">{{aUnMakeAccountLess10Day}}</th> <th class="text-right">{{aUnMakeAccountMore10Day}}</th> <th class="text-right">{{aUnBusinessDate}}</th> </tr> </thead> <tbody> <tr ng-repeat="item in tableData"> \x3c!-- <td style="text-align:center; width:90px">{{item.PartitionName}}</td> --\x3e <td style="text-align:center; width:200px">{{item.ProvinceName}}</td> <td style="text-align:center; width:120px">{{item.CityName}}</td> <td style="text-align:center; width:120px">{{item.ChannelName1}}</td> <td style="text-align:center; width:120px">{{item.ChannelName2}}</td> <td style="text-align:center; width:120px">{{item.TotalNum}}</td> <td style="text-align:center; width:120px; text-decoration: underline; color: blue" ng-click="downloadColumn1(item)">{{item.UnMakeAccount}}</td> <td style="text-align:center; width:120px">{{item.UnMakeAccountRate | filterNum}}</td> <td style="text-align:center; width:120px">{{item.UnMakeAccountLess10Day}}</td> <td style="text-align:center; width:100px; text-decoration: underline; color: blue" ng-click="downloadColumn2(item)">{{item.UnMakeAccountMore10Day}}</td> <td style="text-align:center; width:120px">{{item.UnBusinessDate}}</td> </tr> </tbody> </table> </div> </div> </div>')}]);